<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>21702</Id>
  <Title>System.InvalidCastException as soon as NetOffice Excel Addin loads</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[I have an Excel Addin using Excel-DNA. I recently update my code to switch from Interop to NetOffice.

My code all compiles fine, but when I start the add-in, I get this exception on the first line of code that executes (doesn't seem to matter which line of code it is):
<blockquote>System.InvalidCastException: Unable to cast COM object of type 'System.__ComObject' to class type 'NetOffice.ExcelApi.Application'. Instances of types that represent COM components cannot be cast to types that do not represent COM components; however
 they can be cast to interfaces as long as the underlying COM component supports QueryInterface calls for the IID of the interface.
</blockquote>
Does anyone have an idea of why this is happening and how I can fix it?]]></DescriptionHtml>
  <Status>Proposed</Status>
  <Type>Unassigned</Type>
  <Impact>Unassigned</Impact>
  <Comments>
    <CodeplexComment>
      <Author>tttmack</Author>
      <BodyHtml xml:space="preserve"><![CDATA[I found and fixed the problem. It was because I was trying to cast an Excel DNA application to a Net Office Application


<code>//useinternal static Excel.Application ExcelApp = new Excel.Application(null, ExcelDnaUtil.Application);


//instead of//internal static Excel.Application ExcelApp = (Excel.Application) ExcelDnaUtil.Application;</code>]]></BodyHtml>
      <CreatedAt>2015-02-01T19:42:35.0000000+01:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>tttmack</ReportedBy>
  <ReportedAt>2015-02-01T05:00:05.0000000+00:00</ReportedAt>
</CodeplexIssue>