<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>22284</Id>
  <Title>Problem with property OLEDBConnection.ADOConnection</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[Decided to start a new thread as it is specific to Excel but I think it's the same macanisim as another thread called "Class not exists: NetOffice.OfficeApi.Document"

My issue is related to WorkbookConnection class

I got a valid WorkbookConnection objet using:
<pre><code>                powerPivotConnection = book.Connections
                    .OfType<WorkbookConnection>()
                    .Where(n => n.Name == "PowerPivot Data" || n.Name == "ThisWorkbookDataModel")
                    .FirstOrDefault();
</code></pre>
then I use this to reconnect:
powerPivotConnection.OLEDBConnection.Reconnect();

everything is fine until I try to get this property:
powerPivotConnection.OLEDBConnection.ADOConnection

It raises an Exception (stack here):

à NetOffice.Core.CreateObjectFromComProxy(IFactoryInfo factoryInfo, COMObject caller, Object comProxy, Type comProxyType, String className, String fullClassName)
à NetOffice.Core.CreateObjectFromComProxy(COMObject caller, Object comProxy)
à NetOffice.ExcelApi.OLEDBConnection.get_ADOConnection()
à Powerpivot_Refresh.ExcelUtilities.TryRefreshPowerPivot(Workbook book) dans c:\Users\pasielskyf\Documents\Dev\PSO_tools\Powerpivot_Refresh\ExcelUtilities.cs:ligne 143
à PSO_tools.Addin.Btn_importDiver_Click(IRibbonControl Ctrl) dans c:\Users\pasielskyf\Documents\Dev\PSO_tools\PSO_tools\Addin.cs:ligne 301

I managed this using reflection as discussed in "Class not exists: NetOffice.OfficeApi.Document" topic, but I'm sure there is better to do.

If you need additionnal information, let me know]]></DescriptionHtml>
  <Status>Proposed</Status>
  <Type>Unassigned</Type>
  <Impact>Unassigned</Impact>
  <Comments>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[Please include/reference all MS Access Assemblies. 

what do you awaiting in result of ADOConnection?which type is that ??? 

(NetOffice 1.7.3 has a known issue with external assemblies here) 

Sebastian]]></BodyHtml>
      <CreatedAt>2016-06-13T07:24:08.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>pasielsky</Author>
      <BodyHtml xml:space="preserve"><![CDATA[I'm afraid this doesn't seem to be related to Access at all. 

here is the target class 

public OLEDBConnection NetOffice.ExcelApi.WorkbookConnection.OLEDBConnection { get; }Summary: SupportByVersion Excel 12, 14, 15 Get MSDN Online Documentation:
<a href="http://msdn.microsoft.com/en-us/en-us/library/office/ff838417.aspx" rel="nofollow">
http://msdn.microsoft.com/en-us/en-us/library/office/ff838417.aspx</a> 

This class contains a Property that is ADOConnection (type is object) 

If it does help you, I'm trying to port to NetOffice a project that allow users to refresh a powerpivot excel file automatically :
<a href="https://excelrefresher.codeplex.com/" rel="nofollow">https://excelrefresher.codeplex.com/</a> (that uses VSTO instead of NetOffice)This project will be a helper to mine. I decided that NetOffice is the best way to develop on Office using C#, I really
 want it to work :-)]]></BodyHtml>
      <CreatedAt>2016-06-20T17:26:00.0000000+02:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>pasielsky</ReportedBy>
  <ReportedAt>2016-06-01T07:46:26.0000000+00:00</ReportedAt>
</CodeplexIssue>