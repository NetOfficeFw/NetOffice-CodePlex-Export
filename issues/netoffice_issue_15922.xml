<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>15922</Id>
  <Title>System.AccessViolationException when writing Excel Cells</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[Hi,
 
the following piece of code throws an System.AccessViolationException
 
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Excel = NetOffice.ExcelApi;
using System.Diagnostics;
 
namespace ConsoleApplication1
{
<pre><code>class Program
{
    static void Main(string[] args)
    {
        // Initialize Api COMObject Support
        LateBindingApi.Core.Factory.Initialize();</code></pre>
 
<pre><code>        Excel.Application excelApplication = new Excel.Application();
        Excel.Workbook workbook = excelApplication.Workbooks.Add(); //._Open(@"D:\Visual Studio 2008\Projects\QIMSIECAInterface\QIMSIECAInterface\Templates\General.xls");</code></pre>
 
<pre><code>        excelApplication.Visible = true;</code></pre>
 
<pre><code>        Excel.Worksheet sheet = (Excel.Worksheet)workbook.Worksheets[1];</code></pre>
 
<pre><code>        for (int i = 12; i < 100; i++)
        {
            Excel.Range r = sheet.Cells[i, 1];
            Debug.WriteLine(i);
            i++;
        }</code></pre>
 
<pre><code>        excelApplication.Quit();
        excelApplication.Dispose();
    }
}</code></pre>
}
 
Exception details are the following: 
System.AccessViolationException was unhandled
Message="Attempted to read or write protected memory. This is often an indication that other memory is corrupt."
Source="mscorlib"
StackTrace:
<pre><code>   at System.AppDomain._nExecuteAssembly(Assembly assembly, String[] args)
   at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.ThreadHelper.ThreadStart()</code></pre>
InnerException: 
 
Hope you can help.
 
Thanks in advance.]]></DescriptionHtml>
  <Status>Resolved</Status>
  <Type>Issue</Type>
  <Impact>Low</Impact>
  <Comments>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[can you tell me more about your environment and anything else whats interestend?

operation system 32 or 64 bit 
office version 32 or 64 bit 
.net version 

i test your code with same environment and see whats the problem (hopely )]]></BodyHtml>
      <CreatedAt>2011-05-30T16:14:22.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[some google research: <a href="http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/6adca20b-649f-41a4-8fa1-09534882d76c" rel="nofollow">
http://social.msdn.microsoft.com/Forums/en-US/csharpgeneral/thread/6adca20b-649f-41a4-8fa1-09534882d76c</a>


people with the same problem says this help: 

Tools->Options 
Debugging->General 
uncheck option "Suppress JIT optimization on module load"]]></BodyHtml>
      <CreatedAt>2011-05-30T16:52:20.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>ppratscher</Author>
      <BodyHtml xml:space="preserve"><![CDATA[Hi, 

thanks for your help! 

OS: Windows XP SP3 
Visual Studio 2008 Express Edition 
.NET v. 3.5 SP1 
Office 2003 

Furthermore, this problem does not occur when using the pervious LateBindingApi. 

I can provide more details tomorrow if required. 

Best Regards, 
Peter]]></BodyHtml>
      <CreatedAt>2011-05-30T18:25:23.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[I can reproduce the problem. its not generic but sometimes. 
the underlying problem occurs in the function LateBindingApi.Factory.GetParentLibraryGuid.

i do some tests and hope i can fix this problem tonight. 

i'm sorry for the problem.]]></BodyHtml>
      <CreatedAt>2011-05-30T22:32:24.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[update: problem fixed! issue closed. 
thanks for using issue tracker and not discussion board :)]]></BodyHtml>
      <CreatedAt>2011-05-31T01:14:44.0000000+02:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>ppratscher</ReportedBy>
  <ReportedAt>2011-05-27T08:21:25.0000000+00:00</ReportedAt>
</CodeplexIssue>