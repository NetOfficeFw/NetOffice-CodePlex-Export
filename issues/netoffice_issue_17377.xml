<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>17377</Id>
  <Title>Error loading Excel Add-In</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[I am not able to create and load the Excel Add-In. Here is what I did:
 
<ol>
<li>Downloaded NetOffice 1.3.2
  </li><li>From the rar archive I have extracted folders:
Net4.0\Assemblies
Net4.0\Examples\Excel\C#\COMAddinRibbonExample
  </li><li>I have loaded the *.csproj file in Visual Studio 2010 Express (running it as Administrator)
  </li><li>I have added references to the assemblies and compiled the project. The compile works OK and the registry keys were created (HKEY_CURRENT_USER\Software\Microsoft\Office\Excel\Addins\ExcelRibbonAddinCSharp.Addin)
  </li><li>When I start Excel, nothing happens. The Ribbon is not modified. When I check File -> Options -> Add-ins, then select COM add-ins at the bottom of the screen, I get the list of all COM add-ins where I can see the add-in just created (C#ExcelRibbonAddIn)
 and when I select it, I can see the following error message: Not Loaded. A runtime error occurred during the loading of the COM Add-in
 
I am using Windows 7 Professional, 64 bit. I am running MS Office 2010 64 bit.
 
Please advise. Many thanks. </li></ol>]]></DescriptionHtml>
  <Status>Closed</Status>
  <Type>Issue</Type>
  <Impact>Low</Impact>
  <Comments>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[hello there, 

what i think the problem is, you have to set the assembly to x64. 
do you know the 32/64Bit compatibility guide? 
<a href="http://netoffice.codeplex.com/wikipage?title=Tec_Documentation_English_32Bit_64Bit" rel="nofollow">http://netoffice.codeplex.com/wikipage?title=Tec_Documentation_English_32Bit_64Bit</a>


*sebastian]]></BodyHtml>
      <CreatedAt>2012-02-08T13:57:23.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>Elwetana</Author>
      <BodyHtml xml:space="preserve"><![CDATA[Yes, this was a great hint. What has to be done is to do the following:
<ol>
<li>Uncheck "Register for COM interop" in the Properties -> Build page
</li><li>Set the target CPU as per this StackOverflow question:
</li></ol>
<a href="http://stackoverflow.com/questions/4104228/change-target-cpu-settings-in-visual-studio-2010-express" rel="nofollow">http://stackoverflow.com/questions/4104228/change-target-cpu-settings-in-visual-studio-2010-express</a>
<ol>
<li>Add the following post-build step to Properties -> Build Events:
</li></ol>
"%Windir%\Microsoft.NET\Framework64\v4.0.30319\regasm" "$(TargetPath)"


(Based on this MS KB article: <a href="http://support.microsoft.com/kb/956933" rel="nofollow">
http://support.microsoft.com/kb/956933</a>) 

Now everything works, thanks again.]]></BodyHtml>
      <CreatedAt>2012-02-08T14:23:23.0000000+01:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>Elwetana</ReportedBy>
  <ReportedAt>2012-02-08T10:44:22.0000000+00:00</ReportedAt>
  <ClosedAt>2012-02-17T09:33:41.0000000+01:00</ClosedAt>
</CodeplexIssue>