<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>21664</Id>
  <Title>Retrieving the COM class factory failed</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[On one machine with win 8.1, office 2013 got an exception (others with the same components are ok)
What could be causing this?
<pre><code>Retrieving the COM class factory for component with CLSID {00024500-0000-0000-C000-000000000046} failed due to the following error: 80080005.

Ex.Source: mscorlib
Ex.TargetSite: AllocateUninitializedObject

Stack trace: 
   at System.Runtime.Remoting.RemotingServices.AllocateUninitializedObject(RuntimeType objectType)
   at System.Runtime.Remoting.RemotingServices.AllocateUninitializedObject(Type objectType)
   at System.Runtime.Remoting.Activation.ActivationServices.CreateInstance(Type serverType)
   at System.Runtime.Remoting.Activation.ActivationServices.IsCurrentContextOK(Type serverType, Object[] props, Boolean bNewObj)
   at System.RuntimeTypeHandle.CreateInstance(RuntimeType type, Boolean publicOnly, Boolean noCheck, Boolean& canBeCached, RuntimeMethodHandle& ctor, Boolean& bNeedSecurityCheck)
   at System.RuntimeType.CreateInstanceSlow(Boolean publicOnly, Boolean fillCache)
   at System.RuntimeType.CreateInstanceImpl(Boolean publicOnly, Boolean skipVisibilityChecks, Boolean fillCache)
   at System.Activator.CreateInstance(Type type, Boolean nonPublic)
   at NetOffice.COMObject.CreateFromProgId(String progId)
   at NetOffice.COMObject..ctor(String progId)
   at NetOffice.ExcelApi.Application..ctor()
   at BclAccounting.MainForm.ExportViewToExcel(GridView View)
   at BclAccounting.MainForm.ExportToExcelToolStripButton_Click(Object sender, EventArgs e)</code></pre>]]></DescriptionHtml>
  <Status>Proposed</Status>
  <Type>Unassigned</Type>
  <Impact>Unassigned</Impact>
  <Comments>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[The stack trace indicates its a security issue. Limitless reasons possible so far...Make sure the application doesnt start from a network location or usb-stick, whatever in a normal deskop session. Check UAC settings, so Excel want started without a break.
 Make sure your application and excel was in the same privileges level. 

(Troubleshooting tip: Disable all excel (COM)addins temporaily to make sure the problem is not a third party addin)


*Sebastian]]></BodyHtml>
      <CreatedAt>2015-01-18T05:43:00.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>Niemand</Author>
      <BodyHtml xml:space="preserve"><![CDATA[<blockquote>Make sure the application doesnt start from a network location or usb-stick
</blockquote>
Normal desktop.
<blockquote>Disable all excel (COM)addins temporaily to make sure the problem is not a third party addin
</blockquote>
Not using any.
<blockquote>Check UAC settings, so Excel want started without a break. Make sure your application and excel was in the same privileges level.
</blockquote>
How exactly?]]></BodyHtml>
      <CreatedAt>2015-01-19T10:54:09.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>long1000</Author>
      <BodyHtml xml:space="preserve"><![CDATA[Any update to this problem?
I'm having the same issue running Office 2013 on Win2012.
Thanks.]]></BodyHtml>
      <CreatedAt>2016-11-15T08:28:44.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[I need to see some caller code.
What you try to do? I need to know this to reproduce the scenario.

The id :{00024500-0000-0000-C000-000000000046} is the point of interest here.
NetOffice failed to find a wrapper class for a COM type with this interface id.
I need to know what is this (awaiting) type to clearify the situation.

*Sebastian]]></BodyHtml>
      <CreatedAt>2016-11-16T10:43:16.0000000+01:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>Niemand</ReportedBy>
  <ReportedAt>2015-01-15T11:51:58.0000000+00:00</ReportedAt>
</CodeplexIssue>