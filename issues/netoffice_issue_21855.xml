<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>21855</Id>
  <Title>NetOffice.NefOfficeException when Outlook addin is loading</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[Hi,

I created a test outlook adding project using NO Developer Toolbox.
Project contains:
<ul>
<li>.NET framework 4.5 </li><li>VS 2013 Express </li><li>plugin loaded on startup </li><li>RibbonUI customization </li><li>Custom TaskPane </li><li>Toggle button (irrelevant here)
</li></ul>
After builing and lunching an Outlook I get this exception:
<pre><code>NetOfficeException;System.String[] AddAssembly(System.String, System.Reflection.Assembly);Unexpected OfficeApi factory info. Assembly OfficeApi
NetOffice.NetOfficeException: Unexpected OfficeApi factory info. Assembly OfficeApi
   at NetOffice.Core.AddAssembly(String name, Assembly itemAssembly) in c:\Users\Sebastian\Desktop\Kopie von Source\NetOffice\Core.cs:line 1046
   at NetOffice.Core.AddNetOfficeAssemblies() in c:\Users\Sebastian\Desktop\Kopie von Source\NetOffice\Core.cs:line 350
   at NetOffice.Core.Initialize(CacheOptions cacheOptions) in c:\Users\Sebastian\Desktop\Kopie von Source\NetOffice\Core.cs:line 317
   at NetOffice.Core.CreateObjectFromComProxy(COMObject caller, Object comProxy) in c:\Users\Sebastian\Desktop\Kopie von Source\NetOffice\Core.cs:line 660
   at NetOffice.OfficeApi.ICTPFactory.CreateCTP(String cTPAxID, String cTPTitle) in c:\Users\Sebastian\Desktop\Kopie von Source\Office\DispatchInterfaces\ICTPFactory.cs:line 125
   at NetOffice.OutlookApi.Tools.COMAddin.CTPFactoryAvailable(Object CTPFactoryInst) in c:\Users\Sebastian\Desktop\Kopie von Source\Outlook\Tools\COMAddin.cs:line 432</code></pre>
Exception is not visible when Custom TaskPane is not in use.

Any suggestions why this exception is raised?

Thanks]]></DescriptionHtml>
  <Status>Proposed</Status>
  <Type>Unassigned</Type>
  <Impact>Unassigned</Impact>
  <Comments>
    <CodeplexComment>
      <Author>cool_szczur</Author>
      <BodyHtml xml:space="preserve"><![CDATA[After upgrading NO to 1.7.4:<code>COMException;;Unable to create NetOfficeTools.ExtendedOutlookCS4.SamplePane(NetOffice Tools - Sample Pane(CS4)).System.Runtime.InteropServices.COMException (0x80004005): Unable to create NetOfficeTools.ExtendedOutlookCS4.SamplePane(NetOffice
 Tools - Sample Pane(CS4)). ---> NetOffice.NetOfficeException: Unexpected OutlookApi factory info. Assembly OutlookApi at NetOffice.Core.AddAssembly(String name, Assembly itemAssembly) in C:\NetOfficeX7\Source\NetOffice\Core.cs:line 1143 at NetOffice.Core.AddNetOfficeAssemblies()
 in C:\NetOfficeX7\Source\NetOffice\Core.cs:line 408 at NetOffice.Core.Initialize(CacheOptions cacheOptions) in C:\NetOfficeX7\Source\NetOffice\Core.cs:line 375 at NetOffice.Core.CreateObjectFromComProxy(COMObject caller, Object comProxy) in C:\NetOfficeX7\Source\NetOffice\Core.cs:line
 724 at NetOffice.OfficeApi.ICTPFactory.CreateCTP(String cTPAxID, String cTPTitle) in C:\NetOfficeX7\Source\Office\DispatchInterfaces\ICTPFactory.cs:line 125 at NetOffice.OutlookApi.Tools.COMAddin.CreateCTP(String fullName, String title) in C:\NetOfficeX7\Source\Outlook\Tools\COMAddin.cs:line
 544 

NetOfficeException;System.String[] AddAssembly(System.String, System.Reflection.Assembly);Unexpected OutlookApi factory info. Assembly OutlookApiNetOffice.NetOfficeException: Unexpected OutlookApi factory info. Assembly OutlookApi at NetOffice.Core.AddAssembly(String
 name, Assembly itemAssembly) in C:\NetOfficeX7\Source\NetOffice\Core.cs:line 1143 at NetOffice.Core.AddNetOfficeAssemblies() in C:\NetOfficeX7\Source\NetOffice\Core.cs:line 408 at NetOffice.Core.Initialize(CacheOptions cacheOptions) in C:\NetOfficeX7\Source\NetOffice\Core.cs:line
 375 at NetOffice.Core.CreateObjectFromComProxy(COMObject caller, Object comProxy) in C:\NetOfficeX7\Source\NetOffice\Core.cs:line 724 at NetOffice.OfficeApi.ICTPFactory.CreateCTP(String cTPAxID, String cTPTitle) in C:\NetOfficeX7\Source\Office\DispatchInterfaces\ICTPFactory.cs:line
 125 at NetOffice.OutlookApi.Tools.COMAddin.CreateCTP(String fullName, String title) in C:\NetOfficeX7\Source\Outlook\Tools\COMAddin.cs:line 544</code>]]></BodyHtml>
      <CreatedAt>2015-05-13T15:22:51.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[hello, 

this is nearly impossible :o did you use previous NetOffice versions simulanously or mixed? (may another netoffice-based addin is running) the exception means the core has created a project info instance from the outlook assembly but its failed to cast the
 instance(which is not null) to IProjectInfo. the only possible reason what i know is an ambiguity version conflict for the IProjectInfo interface.


is any custom running before CreateCTP is called(may ctor or OnConnection) ? 

*Sebastian]]></BodyHtml>
      <CreatedAt>2015-05-14T13:34:06.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>cool_szczur</Author>
      <BodyHtml xml:space="preserve"><![CDATA[Hi Sebastian 

I checked registry and I found one netoffice-based addin (one of the examples).After removing it from registry exceptions are not visible and CustomPane addin works.


Thanks for pointing me solution.]]></BodyHtml>
      <CreatedAt>2015-05-14T14:28:00.0000000+02:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>cool_szczur</ReportedBy>
  <ReportedAt>2015-05-13T10:18:41.0000000+00:00</ReportedAt>
</CodeplexIssue>