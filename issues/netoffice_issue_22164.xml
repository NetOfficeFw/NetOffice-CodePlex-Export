<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>22164</Id>
  <Title>Excel: Names.Add Method</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[Hi Sebastian,

while I was trying to add names automatically i discovered the following:

If I add a name in VBA i always have to use the english formula (in the RefersTo parameter; as described under
<a href="https://msdn.microsoft.com/de-de/library/office/ff835300.aspx" rel="nofollow">
https://msdn.microsoft.com/de-de/library/office/ff835300.aspx</a> the formula needs to be in english).

Example: I want to add a formula in german "=BEREICH.VERSCHIEBEN(A1;0;0;10;1)". To add this formula automatically via VBA i would write something like
<pre><code>Sub example()
    ActiveWorkbook.Names.Add Name:="name", RefersTo:="=Offset($A$1,0,0,10,1)"
End Sub</code></pre>
a new name "=BEREICH.VERSCHIEBEN(Tabelle1!$A$1;0;0;10;1)" is created in my Workbook (I have a german installation).

However, this doesn't work with NetOffice. I tried 2 versions.
<ol>
<li>This one simply crashes with an error that says that this is not a correct formula
</li></ol>
<pre><code>ActiveSheet.Names.Add("name", "=Offset($A$1,0,0,10,1)");</code></pre>
<ol>
<li>Replaced "," with ";" </li></ol>
<pre><code>ActiveSheet.Names.Add("name", "=Offset($A$1;0;0;10;1)");</code></pre>
This results in a new name with the formula "=Offset($A$1;0;0;10;1)" but of course my german version does not know "offset".

So i guess that there is some sort of translation from the english formula version to your local language which is currently nut supported by NetOffice. Couly you please have a look? Happy to provide additional details if needed.

regards,

coheedld]]></DescriptionHtml>
  <Status>Proposed</Status>
  <Type>Unassigned</Type>
  <Impact>Unassigned</Impact>
  <Comments>
    <CodeplexComment>
      <Author>coheedld</Author>
      <BodyHtml xml:space="preserve"><![CDATA[Error message of option 1 as described above.]]></BodyHtml>
      <CreatedAt>2016-02-06T22:44:39.0000000+01:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>coheedld</ReportedBy>
  <ReportedAt>2016-02-06T20:36:29.0000000+00:00</ReportedAt>
</CodeplexIssue>