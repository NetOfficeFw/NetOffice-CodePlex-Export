<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>21558</Id>
  <Title>Memory Leak when not cleanly used</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[As the COMObject base class and the Factory class both contain a List<COMObject> of "currently used" Proxies, the GC can never release those. (as they are always referenced as long as the application lives)

In our old code base (which is sadly not clean at all), we can't use "DisposeChildInstances" as this does also invalidate proxies we are still keeping a reference to.

The cleanest solution for me (as a "managed C# developer") is to replace the List<COMObject> in the mentioned classes by "WeakCollection<COMObject>" (e.g. using the "Weakly" Nuget package).
Then you also have to fix two "compiler errors" in Factory and COMObject:
<ul>
<li>Factory.DisposeAllCOMProxies() should call Dispose on "First()" (import Linq namespace) instead of [0] and
</li><li>the ListChildObjects property on COMObject should return a ICollection<> instead of a List<>.
</li></ul>
Cheers,
Bibo]]></DescriptionHtml>
  <Status>Active</Status>
  <Type>Issue</Type>
  <Impact>High</Impact>
  <Comments>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[hi, 

big thx for the audit ! 

hmmm... i hope i understand you correctly 

About "compiler errors" (quality issues) 

I agree the with your IEnumerable ListChildObjects suggestion to avoid the ToArray() callbut i can't use Linq because NetOffice want support .Net 2 as long as possible. (EDIT: may its possible to use an #if condition..i want see) but what makes the linq extension
 better(except for the coolness) ? 

Dispose means to release the proxy inside and you mean the dead proxy is keeping alive in memory as long as the application domain lives?


(if you want keep child references alive you have to remove the child from its parent.)


*Sebastian 

BTW: I dont use Nuget]]></BodyHtml>
      <CreatedAt>2014-11-15T12:36:13.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[update: 

i want change 

COMObject[] ListChildObjects { get ;} 

to: 

IEnumurable ChildObjects {get;} // or just "Childs" 

*Sebastian]]></BodyHtml>
      <CreatedAt>2014-11-15T12:50:37.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[update: 

List ListChildObjects has been changed to IEnumerable ChildObjects in lastest source and release.]]></BodyHtml>
      <CreatedAt>2014-11-15T20:30:00.0000000+01:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>bibolorean</ReportedBy>
  <ReportedAt>2014-11-14T07:05:21.0000000+00:00</ReportedAt>
</CodeplexIssue>