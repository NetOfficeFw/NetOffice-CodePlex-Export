<?xml version="1.0" encoding="utf-8"?>
<CodeplexIssue xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Id>17551</Id>
  <Title>InvalidCastException in Word Dialog.Show</Title>
  <DescriptionHtml xml:space="preserve"><![CDATA[I get an InvalidCastException when using the Dialog.Show method in a Word add-in.
It may be caused by a cast of 'object' to 'int' the NetOffice code , while the return object is in fact 'Int16']]></DescriptionHtml>
  <Status>Resolved</Status>
  <Type>Issue</Type>
  <Impact>High</Impact>
  <Comments>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[thanks for the info, thats strange, i do a test now. 

as hotfix please use: 
object returnValue = LateBindingApi.Core.Invoker.MethodReturn(this, "Show", new object[]{10});

// 10 is the sample enum index]]></BodyHtml>
      <CreatedAt>2012-03-08T10:44:06.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[update: the definition for the return value for Show in the COM type library is VT_I4. this means an a 4-byte(=32Bit) signed integer. at runtime the method returns a short(16Bit Integer) and an InvalidCastException is the result. what i have to do now
 is, change the implementation for all methods, properties with numeric result as follows:


// old 
object returnItem = Invoker.MethodReturn(this, "Show", paramsArray); 
return (Int32)returnItem; 

// new 
object returnItem = Invoker.MethodReturn(this, "Show", paramsArray); 
return Convert.ToInt32(returnItem); 

needs a day! 
*sorry for the trouble]]></BodyHtml>
      <CreatedAt>2012-03-08T14:20:58.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>Piet123</Author>
      <BodyHtml xml:space="preserve"><![CDATA[Thanks! I'm temporary using the quick fix for now. 
Another Office quirk I guess ;)]]></BodyHtml>
      <CreatedAt>2012-03-09T11:03:35.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[its done. i have heavy svn trouble at the moment and can't commit anything. i dont know why.

its the following error: <a href="http://codeplex.codeplex.com/workitem/25805" rel="nofollow">
http://codeplex.codeplex.com/workitem/25805</a> 
hope this problem is resolved for me tomorrow.]]></BodyHtml>
      <CreatedAt>2012-03-10T03:37:28.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[NetOffice 1.4 is available with fixed issue. 

*have a nice day]]></BodyHtml>
      <CreatedAt>2012-03-12T01:27:43.0000000+01:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>Piet123</Author>
      <BodyHtml xml:space="preserve"><![CDATA[Unfortunately, it does not seem to be fixed (completely) yet (1.5.1 rc). 
There still is a direct cast to Int32:
<pre><code>[CustomMethodAttribute]
    [SupportByVersionAttribute("Word", 9,10,11,12,14)]
    public Int32 Show()
    {
        object[] paramsArray = null;
        object returnItem = Invoker.MethodReturn(this, "Show", paramsArray);
        return (Int32)returnItem;
    }</code></pre>]]></BodyHtml>
      <CreatedAt>2012-05-04T08:34:50.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[holy sh... i cant believe that but its true. i have changed this in prev. versions,
<em>damn SVN</em> i change them again today. 

thank you very much for your hint!]]></BodyHtml>
      <CreatedAt>2012-05-04T08:57:56.0000000+02:00</CreatedAt>
    </CodeplexComment>
    <CodeplexComment>
      <Author>SebastianDotNet</Author>
      <BodyHtml xml:space="preserve"><![CDATA[an updated 1.5.1 RC is available with fixed conversion 

*have a nice day]]></BodyHtml>
      <CreatedAt>2012-05-04T19:14:50.0000000+02:00</CreatedAt>
    </CodeplexComment>
  </Comments>
  <ReportedBy>Piet123</ReportedBy>
  <ReportedAt>2012-03-08T07:56:52.0000000+00:00</ReportedAt>
</CodeplexIssue>