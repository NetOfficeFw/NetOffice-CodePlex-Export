[
  {
    "Id": "1419778",
    "ThreadId": "634576",
    "Html": "Hello, everyone!\r<br />\n<br />\nI'm trying to make an Addin for  word. And now I almost have done the things. But there still one problem here.\r<br />\n<br />\nI try to make an Addin with compability with classicalUI and RibbonUI, so in the CreateUserInterface function, I added these codes:<br />\n<pre><code>Private Sub CreateUserInterface()\n    If Not (Utils.ApplicationIs2007OrHigher) Then\n\n        On Error Resume Next\n        mCommandBar = Application.CommandBars(&quot;EquationToolsNET&quot;)\n        If mCommandBar Is Nothing Then\n\n            mCommandBar = Application.CommandBars.Add(&quot;EquationToolsNET&quot;)\n            If mCommandBar IsNot Nothing Then\n                mCommandBar.Visible = True\n\n                Dim commandBarBtn As Office.CommandBarButton = mCommandBar.Controls.Add(MsoControlType.msoControlButton)\n                Dim clickHandler As NetOffice.OfficeApi.CommandBarButton_ClickEventHandler = AddressOf Me.commandBarBtn_ClickEvent\n                With commandBarBtn\n                    .Caption = &quot;NewEquation&quot;\n                    .FaceId = 26\n                    .Visible = True\n                    AddHandler .ClickEvent, clickHandler\n                End With\n\n                commandBarBtn = mCommandBar.Controls.Add(MsoControlType.msoControlButton)\n                With commandBarBtn\n                    .Caption = &quot;CrossREF&quot;\n                    .FaceId = 37\n                    .Visible = True\n                    AddHandler .ClickEvent, clickHandler\n                End With\n\n                commandBarBtn = mCommandBar.Controls.Add(MsoControlType.msoControlButton)\n                With commandBarBtn\n                    .Caption = &quot;ToolBox&quot;\n                    .FaceId = 176\n                    .Visible = True\n                    AddHandler .ClickEvent, clickHandler\n                End With\n            End If\n        End If\n    End If\nEnd Sub\n</code></pre>\n\nSo when I debug this project in Word 2003 for the first time, the commandbar is added, the buttons can work correctly. But after the debug, I open the word 2003 again, the commandbar still exist, but the click actions don't work.\r<br />\n<br />\nI think the problem is, the command button is not linked to the action sub functions, since the commandbar and buttons are added only at the first time, actions can work only in that case. \r<br />\n<br />\nI know, I can add the commandbar again at the beginning time when the Word application starts,  and delete it at the ending time when the  Word application ends. But this is not what I want. I want the commandbar are added at the first time, at can work for the next time.\r<br />\n<br />\nIn the RibbonUI, the Group is added, and can work correctly for every time the Word starts. \r<br />\n<br />\nCan anyone help me to solve this problem?\r<br />\n<br />\nThanks!!!<br />\n",
    "PostedDate": "2015-04-27T20:02:57.3-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1420814",
    "ThreadId": "634576",
    "Html": "Hello everyone!\r<br />\n<br />\nAbout this problem, finally I solved it.\r<br />\nIn order to keep the compatible with Word 2003, I have to add a commandbar. I searched on the internet and the tutorials, noticed the commandbar will be added while word starts, and it will be delete while shuts down. This is not I want, since the commandbar will be recreate for each time, its position and status information will be lost. \r<br />\n<br />\nWhat I do, is to create and delete the commandbar's buttons for each time, not all the commandbar, just buttons. So the buttons' action operation will be re-linked to the sub function, and work correctly.\r<br />\n<br />\nThanks, anyway. I hope this will give others have the same problem some clue. <br />\n",
    "PostedDate": "2015-04-28T19:56:32.387-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]