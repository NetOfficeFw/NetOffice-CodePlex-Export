[
  {
    "Id": "1029492",
    "ThreadId": "440051",
    "Html": "First: Great tool, i love NetOffice !!!\r<br />\n<br />\nMy problem: I am creating emails with attachments with netoffice and all works fine in the microsoft world. But on other email-apps like Thunderbird the attachment always appears as winmail.dat. \r<br />\nI know: there are thousands of articles on this issue. I have regarded this articles, set all to html on message type and converting attachments to html. Now if i create a mail in Outlook manually with a pdf as attachment all works fine: i can see the pdf in Thunderbird and the pdf is not ancapsulated as application/ms-tnef.\r<br />\nBut if i create the message with NetOffice, the same pdf is transferred as winmail.dat. It seemes that the outlook-switch &quot;convert attachments to html-format&quot; is not regarded.\r<br />\n<br />\nMy code:\r<br />\nOutlook.MailItem MI = OutlookApplication.CreateItem(OlItemType.olMailItem) as Outlook.MailItem;\r<br />\n.BodyFormat = OlBodyFormat.olFormatHTML;\r<br />\nMI.Recipients.Add(MD.To);\r<br />\nMI.Subject = MD.Subject;\r<br />\nMI.Body = MD.Text;\r<br />\nforeach (String AttachmentPath in MD.Attachments)\r<br />\n   MI.Attachments.Add(AttachmentPath);\r<br />\nMI.UserProperties.Add(MD.AktePath, OlUserPropertyType.olText);\r<br />\nMI.Display();\r<br />\n<br />\nThe addition of the Userproperty is needed for piping an information for mme, i don't believe this has an affect to the problem.\r<br />\nAs you can see, i first disply the mail before sending. The user must send it manually after adding some text.\r<br />\n<br />\nIs there a switch for avoiding the encapsulation in ms-tnef format ?\r<br />\nI am wondering that sendiing of the same pdf without netoffice is no problem.\r<br />\n<br />\nThanx you for your answers !!!  Jochen Herz from germany<br />\n",
    "PostedDate": "2013-04-12T04:11:14.037-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1029724",
    "ThreadId": "440051",
    "Html": "sorry ich bin aufn freitag abend nich mehr in stimmung für englisch....\r<br />\n<br />\nIch hab leider keinen Schimmer was application/ms-tnef ist.\r<br />\nWenn ich dich richtig verstehe geht  das PDF Attachment verloren?\r<br />\nIst der Code innerhalb eines Addins? Und welches Outlook verwendest du?\r<br />\nIch würds mal nachstellen. Hast du Plain/Interop oder VSTO verwendet als das ganze funktioniert hat?\r<br />\n<br />\nSebastian<br />\n",
    "PostedDate": "2013-04-12T10:09:22.333-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1030447",
    "ThreadId": "440051",
    "Html": "Hallo Sebastian,\r<br />\n<br />\nMeine Randdaten: Outlook 2010, anprogrammiert mit .Net 2.0\r<br />\n<br />\nDas Problem (in Deutsch, ist mir auch lieber):\r<br />\n<br />\nOutlook Mails sind sehr oft im propriätären RTF Format kodiert. Verschickt man solche Mails per Mail, so werden diese Daten in einem Attachment mit dem Namen Winmail.dat samt Formatierung verschickt und beim Empfänger wieder interpretiert. Hat man auf der Empfängerseite auch Outlook sieht man den RTF Text wieder mit allen Formatierungen und das Attachment ist nicht mehr sichtbar.\r<br />\nEmpfängt man aber mit einem anderen Mail wie z.B. Thunderbird, so sieht man zwar den Plain Text der Mail aber auch das Attachment WinMail.Dat, dessen Info natürlich nicht interpretiert werden. Dies ist ein bekanntes Verfahren und es wird überall empfohlen daher in Plain Text oder HTML zu verfassen damit Winmail.dat nicht verschickt wird. Geht auch mit NetOffice auf diese Art problemlos aber nicht mehr mit Attachments:\r<br />\n<br />\nAber wenn ich eine Mail mit NetOffice erfasse und ein oder mehrere Attachment, egal welchen Typs, verfasse, so werden diese Attachments auch in einer WinMail-Dat gepackt und so verschickt. Ein Thunderbird-User sieht dann nur noch das Attachment winmail.dat und nicht mehr die eigentlichen Anhänge. Der Mimetype des Attachments ist dann das erwähnte Format application/ms-tnef\r<br />\n<br />\nVerschicke ich eine Mail von Hand mit den gleichen Attachments so werden diese korrekt abgeschickt.\r<br />\nEs gibt in den Outlook Optionen einen Schalter, mit dem man angeben kann dass Attachment zuerst in HTML codiert werden sollen aber der Schalter zeigt keine Änderung.\r<br />\n<br />\nDa ich bisher keine großen Probleme mit NetOffice gehabt habe, habe ich auch keine entsprechende VSTO-Implementierung im Vorfeld gehabt sondern mich an den NetOffice Demo-Code zum Verschicken einer Mail gehalten.\r<br />\n<br />\nAlso Mails mit Attachment zwischen Outlook Benutzern kein Problem, aber Outlook-Mails mit Anhang an z.B. Thunderbird-Benutzer zumindest bei mir scheinbar nicht möglich. \r<br />\nIch kann das hier gerne zeigen und dich auf den Testrechner lassen oder sonstigen Testcode von dir hier ausführen.\r<br />\n<br />\nWäre klasse wenn es hier eine Lösung gibt, den eigentlich dürfte das Problem ja alle Outlooker treffen die hiermit Mails verschicken.\r<br />\n<br />\nVielen Dank, Jochen Herz (Durchwahl: 06241 / 935012)<br />\n",
    "PostedDate": "2013-04-15T01:25:28.653-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1030449",
    "ThreadId": "440051",
    "Html": "\r\n<div>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Hallo Sebastian,</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Meine Randdaten: Outlook 2010, anprogrammiert mit .Net 2.0</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Das Problem (in Deutsch </span><span style=\"font-size:11.0pt; font-family:Wingdings; color:#1F497D\">J</span><span style=\"font-size:11.0pt; font-family:\">, ist mir auch lieber):</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Outlook Mails sind sehr oft im propriätären RTF Format kodiert. Verschickt man solche Mails per Mail, so werden diese Daten in einem Attachment mit dem Namen Winmail.dat samt Formatierung verschickt und beim Empfänger\r\n wieder interpretiert. Hat man auf der Empfängerseite auch Outlook sieht man den RTF Text wieder mit allen Formatierungen und das Attachment ist nicht mehr sichtbar.</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Empfängt man aber mit einem anderen Mail wie z.B. Thunderbird, so sieht man zwar den Plain Text der Mail aber auch das Attachment WinMail.Dat, dessen Info natürlich nicht interpretiert werden. Dies ist ein bekanntes\r\n Verfahren und es wird überall empfohlen daher in Plain Text oder HTML zu verfassen damit Winmail.dat nicht verschickt wird. Geht auch mit NetOffice auf diese Art problemlos aber nicht mehr mit Attachments:</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Aber wenn ich eine Mail mit NetOffice erfasse und ein oder mehrere Attachment, egal welchen Typs, verfasse, so werden diese Attachments auch in einer WinMail-Dat gepackt und so verschickt. Ein Thunderbird-User\r\n sieht dann nur noch das Attachment winmail.dat und nicht mehr die eigentlichen Anhänge. Der Mimetype des Attachments ist dann das erwähnte Format\r\n</span><span style=\"font-size:9.0pt; font-family:\">application/ms-tnef</span><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Verschicke ich eine Mail von Hand mit den gleichen Attachments so werden diese korrekt abgeschickt.</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Es gibt in den Outlook Optionen einen Schalter, mit dem man angeben kann dass Attachment zuerst in HTML codiert werden sollen aber der Schalter zeigt keine Änderung.</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Da ich bisher keine großen Probleme mit NetOffice gehabt habe, habe ich auch keine entsprechende VSTO-Implementierung im Vorfeld gehabt sondern mich an den NetOffice Demo-Code zum Verschicken einer Mail gehalten.</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Also Mails mit Attachment zwischen Outlook Benutzern kein Problem, aber Outlook-Mails mit Anhang an z.B. Thunderbird-Benutzer zumindest bei mir scheinbar nicht möglich.\r\n</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Ich kann das hier gerne zeigen und dich auf den Testrechner lassen oder sonstigen Testcode von dir hier ausführen.</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Wäre klasse wenn es hier eine Lösung gibt, den eigentlich dürfte das Problem ja alle Outlooker treffen die hiermit Mails verschicken.</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\">Vielen Dank, Jochen Herz (Durchwahl: 06241 / 935012)</span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<p><span style=\"font-size:11.0pt; font-family:\"></span></p>\r\n<div>\r\n<div style=\"border:none; border-top:solid #B5C4DF 1.0pt; padding:3.0pt 0cm 0cm 0cm\">\r\n<p><b><span style=\"font-size:10.0pt; font-family:\">Von:</span></b><span style=\"font-size:10.0pt; font-family:\"> SebastianDotNet [email removed]\r\n<br>\r\n<b>Gesendet:</b> Freitag, 12. April 2013 19:09<br>\r\n<b>An:</b> [email removed]<br>\r\n<b>Betreff:</b> Re: Winmail.dat attachments outside Outlook [netoffice:440051]</span></p>\r\n</div>\r\n</div>\r\n<p></p>\r\n<p><span style=\"font-size:9.0pt; font-family:\">From: SebastianDotNet</span></p>\r\n<div id=\"ThreadNotificationPostBody\" style=\"margin-bottom:24.0pt\">\r\n<p><span style=\"font-size:9.0pt; font-family:\">sorry ich bin aufn freitag abend nich mehr in stimmung für englisch....\r\n<br>\r\n<br>\r\nIch hab leider keinen Schimmer was application/ms-tnef ist. <br>\r\nWenn ich dich richtig verstehe geht das PDF Attachment verloren? <br>\r\nIst der Code innerhalb eines Addins? Und welches Outlook verwendest du? <br>\r\nIch würds mal nachstellen. Hast du Plain/Interop oder VSTO verwendet als das ganze funktioniert hat?\r\n<br>\r\n<br>\r\nSebastian</span></p>\r\n</div>\r\n</div>\r\n",
    "PostedDate": "2013-04-15T01:25:54.797-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1030599",
    "ThreadId": "440051",
    "Html": "Ich habe leider keinen alternativen Mail-Client, private nutze ich OutlookXP. Ich habe jetzt mal folgenden Testcode 5x in verschiedenen Varianten an meine Web.de Adresse geschickt und das Ergebniss war immer okay &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Outlook.MailItem mailItem =\r<br />\n outlookApplication.CreateItem(OlItemType.olMailItem) as Outlook.MailItem; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailItem.BodyFormat = OlBodyFormat.olFormatHTML;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailItem.Recipients.Add(textBoxReciever.Text); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailItem.Subject = textBoxSubject.Text; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r<br />\n //mailItem.Body = &quot;test&quot;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailItem.HTMLBody = &quot;<br />\n&lt;p&gt;&amp;quot; &amp;#43; &amp;quot;Just a test&amp;quot; &amp;#43; &amp;quot;&lt;/p&gt;\r\n&quot;; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailItem.Attachments.Add(&quot;c:\\test.xml&quot;); &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailItem.Send(); Kannst du das Problem auf einem web.de Account replizieren? &nbsp; ________________________________<br />\n",
    "PostedDate": "2013-04-15T06:21:44.837-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1031203",
    "ThreadId": "440051",
    "Html": "Hello Sebastian,\r<br />\n<br />\ni found the problem and want to post a workarround here for all who have this problem.\r<br />\n<br />\nYour code was fine. But the difference was the line:<br />\n<pre><code>mailItem.UserProperties.Add(&quot;123/13&quot;, OlUserPropertyType.olText);\n</code></pre>\n\nI am forced to give some data on the way so i can work with the mail in the event Item_send.\r<br />\nAnd: As soon i add a userproperty to a mail, Outlook 2010 creates a winmail.dat-file. \r<br />\nUnfortunately not only to transfer the property but it pushes all attachments also into the winmail.dat so non-outlook users can not use them.\r<br />\n<br />\nFirst i tried to delete all UserProperties in the event before sending but this had no effect if i only delete them with:<br />\n<pre><code>while (MI.UserProperties.Count &gt; 0)\n    MI.UserProperties.Remove(1);\n</code></pre>\n\nWe must switch off the usage of the mimetype ms-tnef (which ist the content of the Winmail.dat). I found switches for this for mailmapi but i don't know how to use this with NetOffice without loosing the version-compatibility.\r<br />\n<br />\nBut if i set the following registry key, the transfer was fine also with userproperties:\r<br />\n\t\t\t\r<br />\nOutlook 2010:\r<br />\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Outlook\\Preferences]\r<br />\n&quot;DisableTNEF&quot;=dword:00000001\r<br />\n<br />\nPlease have a look at the version numbering in the path and use the version number of your outlook-version.\r<br />\n<br />\nOn my machine this works fine, tomorrow i will test it at the customer. If i have troubles there with this solution i will post ist here.\r<br />\n<br />\nThanx you for your help and your fantastic NetOffice!<br />\n",
    "PostedDate": "2013-04-16T08:16:17-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]