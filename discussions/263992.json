[
  {
    "Id": "637712",
    "ThreadId": "263992",
    "Html": "<p>Has anyone attempted this using NetOffice?&nbsp; I am using ClosedXML to do all of the manipulation of a .xlsx file, and giving the user an option to save the file in 2003 (.xls).&nbsp; I am able to save this file to a folder, by trying to open it, and \"SaveAs\" using  the Interop assemblies just hangs the application (ASP.Net).&nbsp; I have tried every example I can find to close the file, and close the instance of Excel, but it will not be killed.&nbsp;</p>\n<p>The .xlsx file I'm saving already exists- is there an example of how you open an exisitng file?</p>\n<p>Also, if NetOffice is used, does Excel or Office have to be installed on the  server?</p>\n<p>&nbsp;</p>\n<p>Thanks!</p>",
    "PostedDate": "2011-07-05T12:47:14.68-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638019",
    "ThreadId": "263992",
    "Html": "<p>Hello there,</p>\r\n<p>First: NetOffice is an version independent access&nbsp;wrapper for office applications. If you want to use you have to install ms-office in any version on target system.<br />you told me you use interop assemblies. netoffice has the same syntax, maybe the following sample is helpfull for you.</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>Excel.Application excelApplication = <span style=\"color: blue;\">new</span> Excel.Application();\r\nexcelApplication.DisplayAlerts = <span style=\"color: blue;\">false</span>;\r\nExcel.Workbook workBook = excelApplication.Workbooks.Open(<span style=\"color: #a31515;\">@\"C:\\myWorkbook.xlsx\"</span>);\r\n<span style=\"color: green;\">// do something here</span>\r\nworkBook.SaveAs((<span style=\"color: #a31515;\">@\"C:\\myWorkbook.xlsx\"</span>, Type.Missing, Type.Missing, Type.Missing,Type.Missing,Type.Missing, XlSaveAsAccessMode.xlExclusive);\r\nexcelApplication.Quit();\r\nexcelApplication.Dispose();\r\n<span style=\"color: green;\">// excel is removed from process list now</span>\r\n</pre>\r\n</div>",
    "PostedDate": "2011-07-06T03:55:17.81-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638189",
    "ThreadId": "263992",
    "Html": "<p>Sebastian,</p>\r\n<p>Thanks for the reply.&nbsp; I have this working perfect on my DEV machine (local), but the SaveAs will not complete on the server when it's published.<img src=\"data:image/png;base64,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\" alt=\"\" /></p>\r\n<p>The image shows that it's trying to create a .xls file (why it's named 9CC45D10, I have no idea), but it never completes, and will hang forever.&nbsp; I have to get our DBA to kill the process.&nbsp; I can't believe that someone else hasn't had this as a requirement, and found a way to get it to work.</p>\r\n<p>(We have installed MS Excel on the server).</p>\r\n<p>Here is the code I'm using:</p>\r\n<pre style=\"font-family: Consolas; font-size: 13; color: black; background: #e3d5c1;\">LateBindingApi<span style=\"color: #2e53d1;\">.</span>Core<span style=\"color: #2e53d1;\">.</span><span style=\"color: #305fb6;\">Factory</span><span style=\"color: #2e53d1;\">.</span>Initialize();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #400080;\">var</span>&nbsp;fileName&nbsp;<span style=\"color: #2e53d1;\">=</span>&nbsp;<span style=\"color: #305fb6;\">Path</span><span style=\"color: #2e53d1;\">.</span>GetFileName(filepath);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #400080;\">var</span>&nbsp;filePathName&nbsp;<span style=\"color: #2e53d1;\">=</span>&nbsp;Server<span style=\"color: #2e53d1;\">.</span>MapPath(<span style=\"color: #259241;\">\"~/temp\"</span>)&nbsp;<span style=\"color: #2e53d1;\">+</span>&nbsp;<span style=\"color: #259241;\">\"\\\\\"</span>;\r\n \r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style=\"color: #400080;\">var</span>&nbsp;workBook&nbsp;<span style=\"color: #2e53d1;\">=</span>&nbsp;excelApplication<span style=\"color: #2e53d1;\">.</span>Workbooks<span style=\"color: #2e53d1;\">.</span>Open(@filepath);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileName&nbsp;<span style=\"color: #2e53d1;\">=</span>&nbsp;<span style=\"color: #305fb6;\">Path</span><span style=\"color: #2e53d1;\">.</span>GetFileNameWithoutExtension(filepath)&nbsp;<span style=\"color: #2e53d1;\">+</span>&nbsp;<span style=\"color: #259241;\">\".xls\"</span>;\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;workBook<span style=\"color: #2e53d1;\">.</span>SaveAs(@filePathName&nbsp;<span style=\"color: #2e53d1;\">+</span>&nbsp;fileName,&nbsp;<span style=\"color: #305fb6;\">Type</span><span style=\"color: #2e53d1;\">.</span>Missing,&nbsp;<span style=\"color: #305fb6;\">Type</span><span style=\"color: #2e53d1;\">.</span>Missing,&nbsp;<span style=\"color: #305fb6;\">Type</span><span style=\"color: #2e53d1;\">.</span>Missing,&nbsp;<span style=\"color: #305fb6;\">Type</span><span style=\"color: #2e53d1;\">.</span>Missing,&nbsp;<span style=\"color: #305fb6;\">Type</span><span style=\"color: #2e53d1;\">.</span>Missing,&nbsp;<span style=\"color: #2b91af;\">XlSaveAsAccessMode</span><span style=\"color: #2e53d1;\">.</span>xlExclusive);\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excelApplication<span style=\"color: #2e53d1;\">.</span>Quit();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;excelApplication<span style=\"color: #2e53d1;\">.</span>Dispose();\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Response<span style=\"color: #2e53d1;\">.</span>Redirect(<span style=\"color: #259241;\">\"~/temp/\"</span>&nbsp;<span style=\"color: #2e53d1;\">+</span>&nbsp;fileName);</pre>",
    "PostedDate": "2011-07-06T08:18:53.293-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638202",
    "ThreadId": "263992",
    "Html": "<p>Sebastian,</p>\r\n<p>&nbsp;</p>\r\n<p>Other than MS Office/Excel, is there any other requirements that need to be installed on our server to make this work, such as the PIA?&nbsp; We have Microsoft.Office.Interop.Excel referenced in the project.</p>",
    "PostedDate": "2011-07-06T08:27:58.463-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638228",
    "ThreadId": "263992",
    "Html": "<p>Hello again,<br />first: <a href=\"http://netoffice.codeplex.com/wikipage?title=FAQ\" target=\"_self\">What do I have to do to deliver my application with NetOffice?</a><br />netoffice supports 'xcopy deplyoment', copy the assemblies to your target system and thats all.<br />the other one: i can't&nbsp;see the image. your&nbsp;code looks good. is another excel version installed on the server?<br />btw:&nbsp;if you have excel 2007 or higher&nbsp;and want save a .xlsx workbook to&nbsp;old format .xls its not helpfull&nbsp;to rename the extension. its still a&nbsp;.xlsx.<br />you have to change&nbsp;more&nbsp;SaveAs parameter&nbsp;to convert the file.<br />are you&nbsp;make sure is not a problem with the filepath or folder, invalid xml&nbsp;or something like that?<br />i do a convert&nbsp;test immediately.</p>",
    "PostedDate": "2011-07-06T09:14:08.817-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638254",
    "ThreadId": "263992",
    "Html": "<p>There is only one version (Office 2010) installed on out server, and that was not advised by our DBA.&nbsp; The 2nd param should be the FileFormat, but I do not see a proper enumeration;&nbsp; what should it be to properly SaveAs 2003 .xls?</p>\r\n<p>In any case, I have used a few different API from CodePlex, and most seem to hang.&nbsp; Another I tried told me that my object instance was not set, even though I captured various properties from it, so I know it was instantiated.</p>\r\n<p>There must be a better way.</p>",
    "PostedDate": "2011-07-06T10:16:42.637-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638275",
    "ThreadId": "263992",
    "Html": "<p>the following convert code with XlFileFormat enum as 2.param in SaveAs works fine in my test. <br />please try to run this code as normal winform application on your server, after them try to put the code on your ASP.Net application.<br /><br />ï»¿</p>\r\n<div style=\"color: black; background-color: white;\">\r\n<pre>           <span style=\"color: green;\">// Initialize Api COMObject Support</span>\r\n            LateBindingApi.Core.Factory.Initialize();\r\n\r\n            <span style=\"color: green;\">// start excel and turn off msg boxes</span>\r\n            Excel.Application excelApplication = <span style=\"color: blue;\">new</span> Excel.Application();\r\n            excelApplication.DisplayAlerts = <span style=\"color: blue;\">false</span>;\r\n\r\n            <span style=\"color: green;\">// add a new workbook</span>\r\n            <span style=\"color: blue;\">string</span> oldFileName = <span style=\"color: #a31515;\">@\"c:\\book1.xlsx\"</span>;\r\n            Excel.Workbook workBook = excelApplication.Workbooks.Open(oldFileName);\r\n            \r\n            <span style=\"color: green;\">// save the book to xls</span>\r\n            <span style=\"color: blue;\">string</span> newFileName = <span style=\"color: #a31515;\">@\"c:\\book1.xls\"</span>;\r\n            workBook.SaveAs(<span style=\"color: #a31515;\">@\"c:\\book1.xls\"</span>, XlFileFormat.xlWorkbookNormal, Missing.Value, Missing.Value, Missing.Value, Missing.Value,\r\n                                                            NetOffice.ExcelApi.Enums.XlSaveAsAccessMode.xlExclusive);\r\n            \r\n            <span style=\"color: green;\">// close excel and dispose reference</span>\r\n            excelApplication.Quit();\r\n            excelApplication.Dispose();\r\n\r\n            FinishDialog fDialog = <span style=\"color: blue;\">new</span> FinishDialog(<span style=\"color: #a31515;\">\"Workbook saved.\"</span>, newFileName);\r\n            fDialog.ShowDialog(<span style=\"color: blue;\">this</span>);\r\n</pre>\r\n</div>",
    "PostedDate": "2011-07-06T10:55:44.11-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638294",
    "ThreadId": "263992",
    "Html": "<p>Thanks for your help.&nbsp; I have this working for 2007-2010, using a response to HTTP to output the stream.&nbsp; Your code above work perfect if I run it on my local machine. It hangs forever on the server.&nbsp; I just don't see the difference.&nbsp; Did you test the above code on a server?&nbsp; How would you modify it to get the correct path to save to, if the destination is ~/temp folder just beneath the root?&nbsp; I'm only asking that because I want to verify if I have the syntax right.&nbsp; I believe I do, but would like another opinion.</p>\r\n<p>If I could save 2003 to HTTP response, I think this would work fine.</p>\r\n<p>Thanks</p>",
    "PostedDate": "2011-07-06T11:37:59.65-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638295",
    "ThreadId": "263992",
    "Html": "<p>have you try to run the code as a test with hardcoded filenames&nbsp;as simple winforms application on your server?<br />have you try to open the xlsx file by hand and re save as xls and see excel signals an error?</p>",
    "PostedDate": "2011-07-06T11:43:35.363-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638336",
    "ThreadId": "263992",
    "Html": "<p>I have not run it as a WinForms App; I generally don't have rights to do that (separation of concerns is policy).&nbsp; The 2007-2010 version saves fine, so the pathing is OK.&nbsp; This also opens, and allows me to Save As 2003 .xls using Excel, so it is the code that is failing, not the installation of office.</p>\r\n<p>I am going to try saving with simple names as you suggest, although the names are exactly the same except for the extension, I have sometimes seen invalid characters or other errors on servers that do not have the same issues on local drives</p>",
    "PostedDate": "2011-07-06T12:37:21.703-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638340",
    "ThreadId": "263992",
    "Html": "<p>what happens exactly? SaveAs freeze your app completly or needs a long time?<br />your local test is also a asp.net application? you know the thread type from your asp.net app is calling SaveAs?</p>",
    "PostedDate": "2011-07-06T12:43:52.99-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638373",
    "ThreadId": "263992",
    "Html": "<p>Yes, the app freezes.&nbsp; Both local and server are ASP.Net 4.0 Web Apps, which use the AspNetworker thread.</p>\r\n<p>I've tried the following Excel.XlFileFormat, with results shown:</p>\r\n<p><br />xlWorkbookNormal - fail, hangs,locks .xlsx<br />xlExcel7 = 39, fail, hangs,locks&nbsp; .xlsx<br />xlExcel5 = 39, fail, hangs,locks .xlsx<br />xlExcel9795 = 43, fail, hangs,locks .xlsx<br />xlXMLSpreadsheet = 46, fails, page not found, no file created<br />xlExcel12 = 50,fail, hangs<br />xlOpenXMLWorkbook = 51,fail, hangs<br />xlWorkbookDefault = 51, - fail, hangs<br />xlExcel8 = 56, fail, hangs</p>\r\n<p>Here is my save command:</p>\r\n<pre style=\"font-family: Consolas; font-size: 13; color: black; background: #e3d5c1;\">oWB<span style=\"color: #2e53d1;\">.</span>SaveAs(newFileName,&nbsp;Excel<span style=\"color: #2e53d1;\">.</span><span style=\"color: #2b91af;\">XlFileFormat</span><span style=\"color: #2e53d1;\">.</span>xlOpenXMLWorkbook,&nbsp;<span style=\"color: #400080;\">null</span>,&nbsp;<span style=\"color: #400080;\">null</span>,&nbsp;<span style=\"color: #400080;\">false</span>,&nbsp;<span style=\"color: #400080;\">false</span>,\r\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Excel<span style=\"color: #2e53d1;\">.</span><span style=\"color: #2b91af;\">XlSaveAsAccessMode</span><span style=\"color: #2e53d1;\">.</span>xlShared,&nbsp;<span style=\"color: #400080;\">false</span>,&nbsp;<span style=\"color: #400080;\">false</span>,&nbsp;<span style=\"color: #400080;\">null</span>,&nbsp;<span style=\"color: #400080;\">null</span>,&nbsp;<span style=\"color: #400080;\">null</span>);</pre>",
    "PostedDate": "2011-07-06T13:53:52.93-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638386",
    "ThreadId": "263992",
    "Html": "<p>detailed exception info in case of fail are helpfull.<br /><br />hmm..just any other ideas to test.... can you tell me more about the server- is different to your local op-system?<br />maybe you have&nbsp;32bit and the server is 64 with&nbsp;64bit office or something like that?&nbsp;<br />maybe i can create a better test scenario to reproduce these error.</p>",
    "PostedDate": "2011-07-06T14:12:59.503-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "638423",
    "ThreadId": "263992",
    "Html": "<p>Sebastian,</p>\r\n<p>&nbsp;</p>\r\n<p>Thanks for your patience.&nbsp; I finally found out what the problem is, and it is not my code.&nbsp; For  some reason, there is an extra layer of permissions when you want to  Save As.&nbsp; That is why the Save worked, but the Save As did not, at least  via the AspNet worker thread.&nbsp; This has been strictly a permissions issue all along.&nbsp; My DBA changed one little thing, and it works perfectly.&nbsp; Cheers.</p>\r\n<p>&nbsp;</p>\r\n<p>Steve</p>",
    "PostedDate": "2011-07-06T14:57:51.473-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]