[
  {
    "Id": "1069023",
    "ThreadId": "450197",
    "Html": "Hallo guys,\r<br />\n<br />\nI wrote an AddIn, which take the NewMailExEvent to get informed about new emails.\r<br />\n<br />\nThen the AddIn saves the attachments as files and <strong>should</strong> replace the original attachment with just a link to the saved one.\r<br />\n<br />\nI am deleting the old attachments and adding just a string (the path to the saved one). But it seems that outlook not just takes the path but also the whole data and put it into the email.\r<br />\n<br />\nI checked the size of the &quot;sniffed&quot; email and its the exact size of the &quot;not sniffed&quot; email.<br />\n<pre><code>\n            var newMail = (Outlook.MailItem)outlookApp.Session.GetItemFromID(EntryIDCollection, Missing.Value);\n\n            List&lt;string&gt; paths = new List&lt;string&gt;();\n\n            for(int i = newMail.Attachments.Count; i &gt;= 1; i--) {\n                string _base = @&quot;basepath...\\&quot;;\n                string name = newMail.ReceivedByName.Replace(',', '_').Replace(&quot; &quot;, &quot;&quot;);\n                string subname = newMail.SenderName.Replace(',', '_').Replace(&quot; &quot;, &quot;&quot;);\n\n                if(!Directory.Exists(_base + &quot;files&quot;)) {\n                    Directory.CreateDirectory(_base + &quot;files&quot;);\n                }\n\n                if(!Directory.Exists(_base + &quot;files\\\\&quot; + name)) {\n                    Directory.CreateDirectory(_base + &quot;files\\\\&quot; + name);\n                }\n\n                if(!Directory.Exists(_base + &quot;files\\\\&quot; + name + &quot;\\\\&quot; + subname)) {\n                    Directory.CreateDirectory(_base + &quot;files\\\\&quot; + name + &quot;\\\\&quot; + subname);\n                }\n                \n                string path = _base + &quot;files\\\\&quot; + name + &quot;\\\\&quot; + subname + &quot;\\\\&quot; + newMail.Attachments[i].FileName;\n\n                Outlook.Attachment oldAtt = newMail.Attachments[i];\n\n                paths.Add(path);\n\n                oldAtt.SaveAsFile(path);\n                oldAtt.Delete();\n            }\n\n            for(int i = 0; i &lt; paths.Count; i++) {\n                newMail.Attachments.Add(paths[i]);\n            }</code></pre>\n\nIs it even possible to just insert a path?\r<br />\n<br />\ngreetings<br />\n",
    "PostedDate": "2013-07-16T07:33:03.553-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]