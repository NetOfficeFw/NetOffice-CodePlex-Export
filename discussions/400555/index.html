

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="" prefix="og: http://ogp.me/ns# profile: http://ogp.me/ns/profile#">
    
    
    
    

    
    <head>
        <meta id="CompatabilityMode" http-equiv="X-UA-Compatible" content="IE=edge" />
	    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="http://download-codeplex.sec.s-msft.com/css/v21066/i1970439/StyleSheet.ashx" id="MasterCss" rel="stylesheet" type="text/css" />
        <link rel="SHORTCUT ICON" href="http://www.codeplex.com/favicon.ico" />
        <title>NetOffice - MS Office in .NET - Outlook 2000 stays in memory</title>
        
       
                    <script src="https://uhf.microsoft.com/mscc/statics/mscc-0.3.7.min.js"></script>
        
                    <link rel="stylesheet" type="text/css" href="https://uhf.microsoft.com/mscc/statics/mscc-0.3.7.min.css" />
        
            <script type="text/javascript">
                var msccHadCookieBannerAtPageStart = true;
            </script>
        

        <!--
        Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code,
        not by Microsoft.  See ASP.NET Ajax CDN Terms of Use â€“ http://www.asp.net/ajaxlibrary/CDN.ashx.
        -->
        <script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.4.4.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery === 'undefined') {
                document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        <script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.6/jquery-ui.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery.ui === 'undefined') {
                document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        
    <style type="text/css">.SideBar, .SideBarPadding{display:none;}.MainContent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style id="ProjectStyles" type="text/css">
        .SiteHeader, .SiteHeaderLeft {
            height:45px !important;
            overflow:hidden;
        }
        .SiteContent 
        {
            padding: 0 0 1em 0;
            margin-top:0;
            min-height:225px;
            border-right: 1px solid lightgrey;
            border-left: 1px solid lightgrey;
            border-bottom: 1px solid lightgrey;
        }
        .IE table.MinWidthContent
        {
	        table-layout: auto !important;	
        }
    </style>
    
    
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">

    
    
    <meta id="WTProjectName" name="WT.pi" content="netoffice"/>
    

    <link rel="EditURI" type="application/rsd+xml" title="RSD" href='http://netoffice.codeplex.com/rsd' />
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href='/wlwmanifest.xml' />
    
    
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET" url="http://netoffice.codeplex.com/project/feeds/rss"/>
    
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Discussions" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2fnetoffice"/>
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Issues" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2fnetoffice"/>
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Downloads" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2fnetoffice"/>
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Reviews" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2fnetoffice"/>
        
    
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Source&#32;code" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2fnetoffice"/>
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Wiki" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2fnetoffice"/>
    
        
    
        <meta content="summary" name="twitter:card" /><meta content="@CodePlex" name="twitter:site" /><meta content="http://netoffice.codeplex.com/discussions/400555?ProjectName=netoffice" name="twitter:url" /><meta content="NetOffice - MS Office in .NET" name="twitter:title" /><meta content=".NET wrapper assemblies for version independent using Microsoft Office, Excel, Word, Outlook, PowerPoint, Access, Project, Visio, Publisher" name="twitter:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" name="twitter:image" /><meta content="CodePlex" property="og:site_name" /><meta content="http://netoffice.codeplex.com/discussions/400555?ProjectName=netoffice" property="og:url" /><meta content="object" property="og:type" /><meta content="NetOffice - MS Office in .NET" property="og:title" /><meta content=".NET wrapper assemblies for version independent using Microsoft Office, Excel, Word, Outlook, PowerPoint, Access, Project, Visio, Publisher" property="og:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" property="og:image" />
        

    </head>
    
    <body>
         
            <div><div id='msccBanner' dir='ltr' data-site-name='CodePlex' data-mscc-version='0.3.6' data-nver='aspnet-2.0.5' data-sver='0.1.2' class='cc-banner' role='alert'><div class='cc-container'><svg class='cc-icon cc-v-center' x='0px' y='0px' viewBox='0 0 44 44' height='30px' fill='none' stroke='currentColor'><circle cx='22' cy='22' r='20' stroke-width='2'></circle><line x1='22' x2='22' y1='18' y2='33' stroke-width='3'></line><line x1='22' x2='22' y1='12' y2='15' stroke-width='3'></line></svg> <span class='cc-v-center cc-text'>This site uses cookies for analytics, personalized content and ads. By continuing to browse this site, you agree to this use.</span> <a href='https://go.microsoft.com/fwlink/?linkid=845480' aria-label='Learn more about Microsoft&#39;s Cookie Policy' id='msccLearnMore' class='cc-link cc-v-center cc-float-right' data-mscc-ic='false'>Learn more</a></div></div></div>
        <script src="http://download-codeplex.sec.s-msft.com/scripts/v21066/i5/ScriptLoader.ashx" type="text/javascript"></script>
        <form id="aspnetForm" autocomplete="off" method="POST" enctype="multipart/form-data">
            <input name="__RequestVerificationToken" type="hidden" value="vWvKD5zfeMfRQaFs3DBavhjAol5cAdm5016LJp1gH1Ugb4OZYFEsUvd7FVcoY7MzSVGYDWAvzpiuz1VtzcwtLVkLkZS9QaArVJneFx6DXg3CRgoKUGzz6vTjuwGHV_y1NWwZKg2" /><input name="__RequestVerificationToken2" type="hidden" value="__RequestVerificationToken20ad5a2c4-de6c-448f-a5e3-4356e1ef3dc4" />
            
            <div id="UpdateProgressPanel" class="loading_animation" style="display:none;">
                <div class="row">
                    <h2 class="anim_h2">
                        <span id="UpdateProgressText">Updating...</span>
                        <span id="animatedLoadingIconContainer">
                            <img id="animatedLoadingIcon" src="http://download-codeplex.sec.s-msft.com/Images/v21066/loading_animation.gif" class="anim_img"/>
                        </span>
                    </h2>
                </div>
            </div>
            
            <div style="display:none;">
                
                <img id="BlankImage" style="width:0;height:0;" src="http://download-codeplex.sec.s-msft.com/Images/v21066/blank.png" onload="self.logoImageLoaded=true;"/>

                <script language="javascript" type="text/javascript">
                    var date = new Date();
                    var timezoneOffset = date.getTimezoneOffset() / 60 * -1;
                    var timezoneOffsetCookie = getCookie("TimezoneOffset");
                    var firstTimeSetTimezoneCookie = false;

                    if (timezoneOffsetCookie == null || timezoneOffsetCookie != timezoneOffset) {
                        firstTimeSetTimezoneCookie = true;
                        document.cookie = "TimezoneOffset=" + timezoneOffset + '; domain=.codeplex.com;expires=Thu, 3 Jan 2019 10:52:10 UTC';
                    }
                </script>
            </div>
            
            
            <div id="banner">
                <div id="message">
                    <strong>CodePlex is going read-only starting November 27th.  </strong><a href="https://aka.ms/codeplex-readonly">Learn more and find next steps.</a>
                </div>
            </div>
            

            <div id="header">
                <div id="header_wrap" class="row">
                    <p id="logo"><a href="http://www.codeplex.com">Code<span class="semi">Plex</span></a><span id="tagline">Project Hosting for Open Source Software</span></p>
                    

<ul id="nav">

    <li><a href="/site/register/new" id="registerLink" class="ZoomFix">Register</a></li>
    <li ><a class="SignInLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2fnetoffice.codeplex.com%2fdiscussions%2f400555" id="signInLink">Sign In</a></li>
  
    <li class="last"><a class="rss_site_icon" href="http://www.codeplex.com/site/feeds/rss" type="application/rss+xml" rel="Alternate" title="CodePlex Site Activity"></a></li>
</ul>
                    <input id="searchsite" name="searchsite" maxlength="500" type="text" value="" /><span id="search_mag"><a id="submitSearch" name="submitSearch" class="magnify" title="Search" href="#"></a></span>
                    <script>
	$(document).ready(function() {
    var searchButton = $('#submitSearch'),
        searchBar = $('#searchsite');

    // Register our own handler for the search event while we wait for the SearchBox script to load.
    searchButton.bind('click.backupSearchBox', doProjectSearch);
    searchBar.bind('keypress.backupSearchBox', function(e) { if ($keyCode(e) === 13) { doProjectSearch(); return false; } });

    function cleanupSearchEvents() {
        // If the SearchBox was loaded, unregister our handlers.
        if (epx_loaded) {
            searchButton.unbind('.backupSearchBox');
            searchBar.unbind('.backupSearchBox');
        }
    }

    $loadScript('http://i4.services.social.microsoft.com/search/Widgets/SearchBox.jss?appid=1000&scopeid=1&boxId=searchsite&btnId=submitSearch&watermark=Search%20all%20projects&overrideWatermark=true&searchLocation=%2fsite%2fsearch&allowEmptySearch=true&focusOnInit=False&minimumTermLength=3', cleanupSearchEvents);
})
function doProjectSearch() {
    
    var url = '/site/search';

    //If search term is not same as watermark
    if($('#searchsite').val() != 'Search all projects')    
    {        
        url = url + '?query=' + encodeURIComponent($('#searchsite').val());
    }

    
    var callback = '';
    if (callback.length > 0 && eval('typeof ' + callback) != 'undefined')
        url += eval(callback + '()');

    window.location.href = url;
    return false;
}
</script>
                </div>
            </div>
            
            <div id="wrap">
                
    <div id="sub_heading" class="row">
        
        <div id="ProjectHeader">
            <div id="project_title_row" class="row">
                <div id="project_logo">
                    
    
    <div id="project_logo_and_text">
        <div class="logo_left">
            <a href="http://netoffice.codeplex.com/"><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=netoffice&DownloadId=236782&Build=21066" alt="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET" /></a>
        </div>
        <h1 class="text_right"><div><a href="http://netoffice.codeplex.com/" id="ProjectTitle4">NetOffice - MS Office in .NET</a></div></h1>
    </div>

                </div>
            </div>
        </div>
        
        <div id="ProjectDetailsDiv">
            
        </div>
		<div class="clear"></div>
        
                <div id="ProjectMigrationBanner" class="ProjectRedOnly""><strong>This project has moved and is read-only.  For the latest updates, please </strong><a href="https&#58;&#47;&#47;osdn.net&#47;projects&#47;netoffice">go here</a>.</div>
            

<ul id="page_box_links">
	<li id="homeTabCell" style="width: 63px;"><a id="homeTab" href="http://netoffice.codeplex.com/" class="box_home">home</a><div></div></li>
    
	<li id="sourceTabCell" style="width:113px;"><a id="sourceTab" href="http://netoffice.codeplex.com/SourceControl/latest" class="box_source">source code</a><div></div></li>
    
	<li id="releasesTabCell" style="width:105px;"><a id="releasesTab" href="http://netoffice.codeplex.com/releases" class="box_downloads">downloads</a><div></div></li>
    
    <li id="documentationTabCell" style="width:143px;"><a id="documentationTab" href="http://netoffice.codeplex.com/documentation" class="box_documentation">documentation</a><div></div></li>
    
	<li id="discussionTabCell" style="width:112px;"><a id="discussionTab" href="http://netoffice.codeplex.com/discussions" class="discussions_active">discussions</a><div></div></li>
    
	<li id="workItemsTabCell" style="width:70px;"><a id="workItemsTab" href="http://netoffice.codeplex.com/workitem/list/basic" class="box_issue">issues</a><div></div></li>
    
	<li id="peopleTabCell" style="width:70px;"><a id="peopleTab" href="http://netoffice.codeplex.com/team/view" class="box_people">people</a><div></div></li>
	<li id="licenseTabCell" style="width:70px;"><a id="licenseTab" href="http://netoffice.codeplex.com/license" class="box_license">license</a><div></div></li>
    
    <span class="stretch"></span>
</ul>

<script type="text/javascript">
    $(document).ready(function () {
        $('#page_box_links').applyLastClassToList();
    });
</script>
		    <div class="clear"></div>
            
     <td>
       

<div>
    
    <div id="actionBar" class="action_bar">
        <ul id="actionBar_ul" class="actionBar_sublinks subtab_right" style="vertical-align: middle;">

            

                <li id="li_actionbar_subscribe" data-action-id="actionbar_subscribe" data-action-type="PopUp" class="actionBar_sublinks" data-options-id="874f118e-bb0e-4232-bc59-ec1ebba84ede">
                
                    <script class="options" defer="defer" id="874f118e-bb0e-4232-bc59-ec1ebba84ede" type="application/json">{}</script> 
                    
                    <div class="actionBar_custom_content">

<div id="rssHoverDiv" class="HoverPanel LeftHoverWidth" style="display: none">
        <ul id="3_FeedsPanel" class="RssFeedsPanel">
            <li>
                <a id="ProjectRssLink" href="http://netoffice.codeplex.com/project/feeds/rss" class="ArrowSmall NoUnderline">All Project Updates</a>
            </li>
            
            <li>
                <a id="DiscussionRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2fnetoffice" class="ArrowSmall NoUnderline">Discussions</a>
            </li>
            
            <li>
                <a id="IssueTrackerRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2fnetoffice" class="ArrowSmall NoUnderline">Issue Tracker</a>
            </li>
            
            <li>
                <a id="ReleasesRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2fnetoffice" class="ArrowSmall NoUnderline">Downloads</a>
            </li>
            <li>
                <a id="ReviewsRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2fnetoffice" class="ArrowSmall NoUnderline">Reviews</a>
            </li>
            
            <li>
                <a id="SourceControlRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2fnetoffice" class="ArrowSmall NoUnderline">Source Code</a>
            </li>
            <li>
                <a id="WikiRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2fnetoffice" class="ArrowSmall NoUnderline">Wiki &amp; Documentation</a>
            </li>
        </ul>
</div></div>

                    <a href="#" id="actionbar_subscribe" title="Subscribe to project updates in RSS feeds." class="action_bar_item_link">
                        <img id="img_actionbar_subscribe" class="action_bar_item_image" src="http://download-codeplex.sec.s-msft.com/Images/v21066/actionbar_subscribe.png" style="vertical-align: middle" />
                        Subscribe
                    </a>

                </li>

            
        </ul>
    </div>
</div>
     </td>

        

    </div>
    
    
<div class="Threads">
    <div class="ViewThread">
        
        
        
            <h1 class="page_title WordWrapBreakWord">
                Outlook 2000 stays in memory
            </h1>

            <!-- Private Discussion header -->
            

            <!-- Posts List Header: Topics and Wiki Link -->
            <table class="PostsListHeader">
                <tr>
                    <td>
                     
                    </td>
                    <td>
                        <div class="WikiLink">
                            <span title="Paste this into a wiki page to link to this discussion">
                                Wiki Link: [discussion:400555]
                            </span>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- The list of posts -->
            

<div id="discussionsPostList" data-options-id="88ed0534-2242-4db5-880d-5ac00ff842c8">
    <script class="options" defer="defer" id="88ed0534-2242-4db5-880d-5ac00ff842c8" type="application/json">{"threadUrl":"http://netoffice.codeplex.com/discussions/400555","showEditor":false,"checkImageUrl":"http://download-codeplex.sec.s-msft.com/Images/v21066/check_answer.png"}</script>

    <div class="Posts" style="margin-top: 10px;">
    

<table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 0px; table-layout:fixed">
    

<tr id="PostPanel" class="Post" d:forid="931441">
    <td id="PostDetailsCell_931441" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post931441"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/OliverChrisTrapp">OliverChrisTrapp</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/24/2012 5:33:52 AM" LocalTimeTicks="1351082032">Oct 24, 2012 at 5:33 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_931441" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Hi&#32;SebastianDotNet.&#32;First&#32;of,&#32;I&#32;think&#32;you&#32;did&#32;a&#32;great&#32;job&#32;with&#32;Netoffice&#33;&#32;Here&#39;s&#32;my&#32;problem&#58;&#32;I&#32;want&#32;to&#32;develop&#32;a&#32;com&#32;addin&#32;to&#32;work&#32;with&#32;Outlook&#32;2000&#32;-&#32;Outlook&#32;2010.&#32;Using&#32;your&#32;example&#32;-&#32;namely&#32;&#38;quot&#59;COMAddinClassicExample&#38;quot&#59;&#32;-&#32;I&#32;compiled,&#32;and&#32;registered&#32;the&#32;sample&#32;with&#32;&#38;quot&#59;regasm&#38;quot&#59;.&#32;Outlook&#32;starts&#32;fine,&#32;and&#32;the&#32;sample&#32;works&#32;displaying&#32;a&#32;message&#32;box&#32;on&#32;click.&#32;But,&#32;when&#32;I&#32;close&#32;Outlook&#32;it&#32;just&#32;stays&#32;in&#32;memory.&#32;To&#32;find&#32;out&#32;what&#39;s&#32;going&#32;on,&#32;I&#32;added&#32;message&#32;boxes&#32;to&#32;the&#32;events&#32;&#38;quot&#59;OnDisconnection&#38;quot&#59;&#32;and&#32;&#38;quot&#59;OnBeginShutdown&#38;quot&#59;&#32;in&#32;file&#32;&#38;quot&#59;ExampleClassicAddin.cs&#38;quot&#59;.&#32;Code&#32;snippets&#58;&#32;...&#32;&#32;&#32;&#32;void&#32;IDTExtensibility2.OnDisconnection&#40;ext_DisconnectMode&#32;RemoveMode,&#32;ref&#32;Array&#32;custom&#41;&#32;&#123;&#32;MessageBox.Show&#40;&#38;quot&#59;OnDisconnection&#38;quot&#59;,&#32;&#38;quot&#59;Testing&#38;quot&#59;,&#32;MessageBoxButtons.OK,&#32;MessageBoxIcon.Information&#41;&#59;&#32;try&#32;&#32;&#32;&#38;nbsp&#59;...&#32;&#32;and&#32;...&#32;&#32;&#32;void&#32;IDTExtensibility2.OnBeginShutdown&#40;ref&#32;Array&#32;custom&#41;&#32;&#123;&#32;MessageBox.Show&#40;&#38;quot&#59;OnBeginShutdown&#38;quot&#59;,&#32;&#38;quot&#59;Testing&#38;quot&#59;,&#32;MessageBoxButtons.OK,&#32;MessageBoxIcon.Information&#41;&#59;&#32;&#32;&#32;...&#32;&#32;The&#32;rest&#32;of&#32;your&#32;sample&#32;code&#32;was&#32;left&#32;untouched.&#32;I&#32;then&#32;recompiled,&#32;unregistered&#32;the&#32;first&#32;try,&#32;and&#32;registered&#32;the&#32;second&#32;one.&#32;Neither&#32;message&#32;box&#32;is&#32;displayed,&#32;and&#32;Outlook&#32;just&#32;stays&#32;in&#32;memory...&#32;I&#32;then&#32;took&#32;the&#32;com&#32;addin,&#32;and&#32;registered&#32;it&#32;on&#32;a&#32;machine&#32;having&#32;Outlook&#32;2003&#32;installed.&#32;There&#32;the&#32;two&#32;message&#32;boxes&#32;do&#32;get&#32;displayed&#32;upon&#32;closing&#32;Outlook,&#32;and&#32;it&#32;gracefully&#32;disappears&#32;from&#32;memory.&#32;&#38;nbsp&#59;&#32;Any&#32;ideas&#32;would&#32;be&#32;highly&#32;appreciated&#33;&#32;Thanks&#32;in&#32;advance&#33;&#32;With&#32;best&#32;regards&#32;OliverChrisTrapp&#32;">
        
<p>Hi <a href="http://www.codeplex.com/site/users/view/SebastianDotNet" rel="nofollow">SebastianDotNet</a>.</p>
<p>First of, I think you did a great job with Netoffice!</p>
<p>Here's my problem:</p>
<p>I want to develop a com addin to work with Outlook 2000 - Outlook 2010.</p>
<p>Using your example - namely &quot;COMAddinClassicExample&quot; - I compiled, and registered the sample with &quot;regasm&quot;.</p>
<p>Outlook starts fine, and the sample works displaying a message box on click.</p>
<p>But, when I close Outlook it just stays in memory.</p>
<p>To find out what's going on, I added message boxes to the events &quot;OnDisconnection&quot; and &quot;OnBeginShutdown&quot; in file &quot;ExampleClassicAddin.cs&quot;.</p>
<p>Code snippets:</p>
<p>...</p>
<p></p>
<div style="color:black; background-color:white">
<pre> <span style="color:blue">void</span> IDTExtensibility2.OnDisconnection(ext_DisconnectMode RemoveMode, <span style="color:blue">ref</span> Array custom)
        {
            MessageBox.Show(<span style="color:#a31515">&quot;OnDisconnection&quot;</span>, <span style="color:#a31515">&quot;Testing&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Information);
            <span style="color:blue">try</span>
</pre>
</div>
&nbsp;...
<p></p>
<p>and</p>
<p>...</p>
<p></p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">void</span> IDTExtensibility2.OnBeginShutdown(<span style="color:blue">ref</span> Array custom)
        {
            MessageBox.Show(<span style="color:#a31515">&quot;OnBeginShutdown&quot;</span>, <span style="color:#a31515">&quot;Testing&quot;</span>, MessageBoxButtons.OK, MessageBoxIcon.Information);
</pre>
</div>
...
<p></p>
<p>The rest of your sample code was left untouched.</p>
<p>I then recompiled, unregistered the first try, and registered the second one.</p>
<p>Neither message box is displayed, and Outlook just stays in memory...</p>
<p>I then took the com addin, and registered it on a machine having Outlook 2003 installed.</p>
<p>There the two message boxes do get displayed upon closing Outlook, and it gracefully disappears from memory.</p>
<p>&nbsp;</p>
<p>Any ideas would be highly appreciated!</p>
<p>Thanks in advance!</p>
<p>With best regards</p>
<p>OliverChrisTrapp</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_931441" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="932267">
    <td id="PostDetailsCell_932267" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post932267"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/25/2012 10:43:00 AM" LocalTimeTicks="1351186980">Oct 25, 2012 at 10:43 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_932267" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="did&#32;you&#32;use&#32;any&#32;events&#32;or&#32;its&#32;basicly&#32;the&#32;1&#58;1&#32;example&#32;code&#63;for&#32;troubleshooting&#58;&#32;-&#32;remove&#32;or&#32;disable&#32;any&#32;other&#32;addins-&#32;go&#32;to&#32;the&#32;application&#32;properties&#47;debugging&#32;and&#32;use&#32;the&#32;option&#32;&#34;start&#32;external&#32;program&#34;.&#32;insert&#32;the&#32;outlook.exe&#32;path.now&#32;go&#32;the&#32;toolbar&#32;menu&#32;debugging&#47;exceptions&#32;and&#32;hit&#32;the&#32;&#34;checkbox&#32;Common&#32;Language&#32;Runtime&#32;Exceptions&#34;.&#32;now&#32;start&#32;debugging.the&#32;debugger&#32;breaks&#32;if&#32;an&#32;exception&#32;is&#32;thrown.-&#32;i&#32;can&#32;do&#32;a&#32;test&#32;but&#32;i&#32;need&#32;the&#32;information&#32;for&#32;your&#32;operating&#32;system&#32;and&#32;32&#47;64bit.Sebastian">
        
<p>did you use any events or its basicly the 1:1 example code?<br>
<br>
for troubleshooting: <br>
- remove or disable any other addins<br>
- go to the application properties/debugging and use the option &quot;start external program&quot;. insert the outlook.exe path.<br>
now go the toolbar menu debugging/exceptions and hit the &quot;checkbox Common Language Runtime Exceptions&quot;. now start debugging.<br>
the debugger breaks if an exception is thrown.<br>
- i can do a test but i need the information for your operating system and 32/64bit.<br>
<br>
Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_932267" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="932763">
    <td id="PostDetailsCell_932763" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post932763"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/OliverChrisTrapp">OliverChrisTrapp</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/26/2012 4:48:58 AM" LocalTimeTicks="1351252138">Oct 26, 2012 at 4:48 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_932763" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Hi&#32;Sebastian,&#32;thanks&#32;for&#32;your&#32;quick&#32;response.&#32;Yes,&#32;I&#39;m&#32;using&#32;exactly&#32;the&#32;sample&#32;code&#32;except&#32;the&#32;two&#32;message&#32;boxes&#32;mentioned&#32;before.&#32;I&#32;checked&#32;checkbox&#32;&#34;Common&#32;Language&#32;Runtime&#32;Exceptions&#34;&#32;as&#32;advised,&#32;and&#32;started&#32;the&#32;project&#32;with&#32;the&#32;option&#32;&#34;start&#32;external&#32;program&#34;.&#32;Outlook&#32;starts,&#32;and&#32;I&#32;can&#32;click&#32;the&#32;&#34;C&#35;&#32;_ToolbarButton&#34;&#32;receiving&#32;the&#32;corresponding&#32;message&#32;box.&#32;When&#32;I&#32;close&#32;Outlook,&#32;no&#32;exception&#32;is&#32;thrown,&#32;Outlook&#32;is&#32;still&#32;visible&#32;as&#32;a&#32;process&#32;in&#32;&#34;Task&#32;Manager&#34;,&#32;and&#32;the&#32;Visual&#32;Studio&#32;is&#32;still&#32;in&#32;Debugging&#32;mode.&#32;I&#32;added&#32;variable&#32;&#34;_outlookApplication&#34;&#32;as&#32;a&#32;watch,&#32;and&#32;this&#32;is&#32;then&#32;simply&#32;grayed&#32;out.&#32;Output&#32;from&#32;Debug&#32;is&#58;&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;WINDOWS&#92;assembly&#92;GAC_32&#92;mscorlib&#92;2.0.0.0__b77a5c561934e089&#92;mscorlib.dll&#39;,&#32;Skipped&#32;loading&#32;symbols.&#32;Module&#32;is&#32;optimized&#32;and&#32;the&#32;debugger&#32;option&#32;&#39;Just&#32;My&#32;Code&#39;&#32;is&#32;enabled.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;Downloads&#92;NetOffice&#32;Release&#32;1.4.1&#92;NetOffice&#32;Release&#32;1.4.1&#92;Net2.0&#92;Examples&#92;Outlook&#92;C&#35;&#92;COMAddinClassicExample&#92;bin&#92;Debug&#92;OutlookClassicAddinCSharp.dll&#39;,&#32;Symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;Downloads&#92;NetOffice&#32;Release&#32;1.4.1&#92;NetOffice&#32;Release&#32;1.4.1&#92;Net2.0&#92;Examples&#92;Outlook&#92;C&#35;&#92;COMAddinClassicExample&#92;bin&#92;Debug&#92;LateBindingApi.Core.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;Downloads&#92;NetOffice&#32;Release&#32;1.4.1&#92;NetOffice&#32;Release&#32;1.4.1&#92;Net2.0&#92;Examples&#92;Outlook&#92;C&#35;&#92;COMAddinClassicExample&#92;bin&#92;Debug&#92;OutlookApi.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;Downloads&#92;NetOffice&#32;Release&#32;1.4.1&#92;NetOffice&#32;Release&#32;1.4.1&#92;Net2.0&#92;Examples&#92;Outlook&#92;C&#35;&#92;COMAddinClassicExample&#92;bin&#92;Debug&#92;OfficeApi.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;WINDOWS&#92;assembly&#92;GAC_MSIL&#92;System.Windows.Forms&#92;2.0.0.0__b77a5c561934e089&#92;System.Windows.Forms.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;Downloads&#92;NetOffice&#32;Release&#32;1.4.1&#92;NetOffice&#32;Release&#32;1.4.1&#92;Net2.0&#92;Examples&#92;Outlook&#92;C&#35;&#92;COMAddinRibbonExample&#92;bin&#92;Debug&#92;OutlookRibbonAddinCSharp.dll&#39;,&#32;Symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;Downloads&#92;NetOffice&#32;Release&#32;1.4.1&#92;NetOffice&#32;Release&#32;1.4.1&#92;Net2.0&#92;Examples&#92;Outlook&#92;C&#35;&#92;COMAddinRibbonExample&#92;bin&#92;Debug&#92;OfficeApi.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;WINDOWS&#92;assembly&#92;GAC_MSIL&#92;System&#92;2.0.0.0__b77a5c561934e089&#92;System.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;WINDOWS&#92;assembly&#92;GAC_MSIL&#92;System.Configuration&#92;2.0.0.0__b03f5f7f11d50a3a&#92;System.Configuration.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;WINDOWS&#92;assembly&#92;GAC_MSIL&#92;System.Xml&#92;2.0.0.0__b77a5c561934e089&#92;System.Xml.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;&#39;OUTLOOK.EXE&#39;&#32;&#40;Managed&#41;&#58;&#32;Loaded&#32;&#39;C&#58;&#92;WINDOWS&#92;assembly&#92;GAC_MSIL&#92;System.Drawing&#92;2.0.0.0__b03f5f7f11d50a3a&#92;System.Drawing.dll&#39;,&#32;No&#32;symbols&#32;loaded.&#32;When&#32;I&#32;then&#32;end&#32;debugging,&#32;Outlook&#32;disappears&#32;from&#32;memory.&#32;OS&#32;is&#32;Windows&#32;XP&#32;Service&#32;Pack&#32;3&#32;32&#32;bit&#32;VS&#32;is&#32;Microsoft&#32;Visual&#32;Studio&#32;2005&#32;Version&#32;8.0.50727.42&#38;nbsp&#59;&#32;&#40;RTM.050727-4200&#41;&#32;with&#32;Microsoft&#32;.NET&#32;Framework&#32;Version&#32;2.0.50727&#32;SP2Installed&#32;Edition&#58;&#32;Professional&#32;&#38;nbsp&#59;&#32;Any&#32;ideas&#63;&#33;&#63;&#32;&#38;nbsp&#59;&#32;Cheers&#32;Oli&#32;&#59;-&#41;">
        
<p>Hi Sebastian,</p>
<p>thanks for your quick response.</p>
<p>Yes, I'm using exactly the sample code except the two message boxes mentioned before.</p>
<p>I checked checkbox &quot;Common Language Runtime Exceptions&quot; as advised, and started the project with the option &quot;start external program&quot;.</p>
<p>Outlook starts, and I can click the &quot;C# _ToolbarButton&quot; receiving the corresponding message box.</p>
<p>When I close Outlook, no exception is thrown, Outlook is still visible as a process in &quot;Task Manager&quot;, and the Visual Studio is still in Debugging mode.</p>
<p>I added variable &quot;_outlookApplication&quot; as a watch, and this is then simply grayed out.</p>
<p>Output from Debug is:</p>
<p>'OUTLOOK.EXE' (Managed): Loaded 'C:\WINDOWS\assembly\GAC_32\mscorlib\2.0.0.0__b77a5c561934e089\mscorlib.dll', Skipped loading symbols. Module is optimized and the debugger option 'Just My Code' is enabled.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\Downloads\NetOffice Release 1.4.1\NetOffice Release 1.4.1\Net2.0\Examples\Outlook\C#\COMAddinClassicExample\bin\Debug\OutlookClassicAddinCSharp.dll', Symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\Downloads\NetOffice Release 1.4.1\NetOffice Release 1.4.1\Net2.0\Examples\Outlook\C#\COMAddinClassicExample\bin\Debug\LateBindingApi.Core.dll', No symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\Downloads\NetOffice Release 1.4.1\NetOffice Release 1.4.1\Net2.0\Examples\Outlook\C#\COMAddinClassicExample\bin\Debug\OutlookApi.dll', No symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\Downloads\NetOffice Release 1.4.1\NetOffice Release 1.4.1\Net2.0\Examples\Outlook\C#\COMAddinClassicExample\bin\Debug\OfficeApi.dll', No symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\System.Windows.Forms\2.0.0.0__b77a5c561934e089\System.Windows.Forms.dll', No symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\Downloads\NetOffice Release 1.4.1\NetOffice Release 1.4.1\Net2.0\Examples\Outlook\C#\COMAddinRibbonExample\bin\Debug\OutlookRibbonAddinCSharp.dll', Symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\Downloads\NetOffice Release 1.4.1\NetOffice Release 1.4.1\Net2.0\Examples\Outlook\C#\COMAddinRibbonExample\bin\Debug\OfficeApi.dll', No symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\System\2.0.0.0__b77a5c561934e089\System.dll', No symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\System.Configuration\2.0.0.0__b03f5f7f11d50a3a\System.Configuration.dll', No symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\System.Xml\2.0.0.0__b77a5c561934e089\System.Xml.dll', No symbols loaded.<br>
'OUTLOOK.EXE' (Managed): Loaded 'C:\WINDOWS\assembly\GAC_MSIL\System.Drawing\2.0.0.0__b03f5f7f11d50a3a\System.Drawing.dll', No symbols loaded.</p>
<p>When I then end debugging, Outlook disappears from memory.</p>
<p>OS is Windows XP Service Pack 3 32 bit</p>
<p>VS is</p>
<p>Microsoft Visual Studio 2005 Version 8.0.50727.42&nbsp; (RTM.050727-4200)</p>
<p>with</p>
<p>Microsoft .NET Framework Version 2.0.50727 SP2<br>
<br>
Installed Edition: Professional</p>
<p>&nbsp;</p>
<p>Any ideas?!?</p>
<p>&nbsp;</p>
<p>Cheers</p>
<p>Oli ;-)</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_932763" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="932831">
    <td id="PostDetailsCell_932831" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post932831"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/26/2012 9:00:46 AM" LocalTimeTicks="1351267246">Oct 26, 2012 at 9:00 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_932831" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="i&#32;see&#32;you&#32;use&#32;an&#32;older&#32;version&#32;of&#32;NetOffice.&#32;can&#32;you&#32;do&#32;me&#32;a&#32;pleasure&#32;and&#32;update&#32;to&#32;1.5.1.2&#32;please&#63;&#32;its&#32;difficult&#32;for&#32;me&#32;to&#32;reproduce&#32;your&#32;scenario&#32;in&#32;a&#32;virtual&#32;machine&#32;with&#32;an&#32;old&#32;NetOffic&#32;version.do&#32;you&#32;remove&#47;disable&#32;other&#32;addins&#63;&#32;the&#32;NetOffice&#32;developer&#32;toolbox&#32;contains&#32;a&#32;component&#32;called&#32;&#34;Addin&#32;Guard&#34;&#32;you&#32;see&#32;all&#32;addins&#32;here&#32;and&#32;you&#32;can&#32;temporaily&#32;disable&#32;them&#32;in&#32;the&#32;developer&#32;toolbox&#32;registry&#32;editor.btw&#58;&#32;a&#32;30-60&#32;seconds&#32;shutdown&#32;delay&#32;is&#32;typical&#32;for&#32;outlook&#32;because&#32;the&#32;application&#32;performs&#32;some&#32;backup&#32;operations&#32;for&#32;.pst&#32;files&#32;and&#32;some&#32;other.i&#32;do&#32;a&#32;test&#32;now&#32;in&#32;a&#32;virtual&#32;machine.&#32;need&#32;1&#32;hour.Sebastian">
        
<p>i see you use an older version of NetOffice. can you do me a pleasure and update to 1.5.1.2 please? its difficult for me to reproduce your scenario in a virtual machine with an old NetOffic version.<br>
<br>
do you remove/disable other addins? the NetOffice developer toolbox contains a component called &quot;Addin Guard&quot; you see all addins here and you can temporaily disable them in the developer toolbox registry editor.<br>
<br>
btw: a 30-60 seconds shutdown delay is typical for outlook because the application performs some backup operations for .pst files and some other.<br>
i do a test now in a virtual machine. need 1 hour.<br>
<br>
Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_932831" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="932859">
    <td id="PostDetailsCell_932859" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post932859"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/26/2012 9:55:37 AM" LocalTimeTicks="1351270537">Oct 26, 2012 at 9:55 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_932859" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="update&#58;&#32;i&#32;can&#32;reproduce&#32;the&#32;problem&#32;with&#32;outlook&#32;200.&#32;the&#32;OnDisconnection&#47;OnBeginShutdown&#32;events&#32;was&#32;not&#32;fired.&#32;if&#32;i&#32;remove&#32;the&#32;SetupGui&#40;&#41;&#32;method&#32;then&#32;already&#32;was&#32;okay.&#32;i&#32;do&#32;some&#32;tests&#32;now&#32;with&#32;outlook&#32;2002&#47;2003&#32;to&#32;see&#32;its&#32;a&#32;generic&#32;problem.&#32;need&#32;also&#32;1&#32;hour.Sebastian">
        
<p>update: i can reproduce the problem with outlook 200. the OnDisconnection/OnBeginShutdown events was not fired. if i remove the SetupGui() method then already was okay. i do some tests now with outlook 2002/2003 to see its a generic problem. need also 1
 hour.<br>
<br>
Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_932859" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="932861">
    <td id="PostDetailsCell_932861" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post932861"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/26/2012 10:01:00 AM" LocalTimeTicks="1351270860">Oct 26, 2012 at 10:01 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_932861" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="update&#58;&#32;the&#32;problem&#32;occurs&#32;only&#32;in&#32;Outlook&#32;2000.&#32;i&#32;try&#32;to&#32;find&#32;a&#32;workarround&#32;now.Sebastian">
        
<p>update: the problem occurs only in Outlook 2000. i try to find a workarround now.<br>
<br>
Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_932861" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="932866">
    <td id="PostDetailsCell_932866" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post932866"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/26/2012 10:11:04 AM" LocalTimeTicks="1351271464">Oct 26, 2012 at 10:11 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_932866" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="i&#32;find&#32;a&#32;solution&#32;that&#32;works&#32;for&#32;me.&#32;change&#32;the&#32;SetupGui&#40;&#41;&#32;method&#32;as&#32;follows&#58;private&#32;void&#32;SetupGui&#40;&#41;&#123;&#38;nbsp&#59;&#38;nbsp&#59;&#32;Outlook._Explorer&#32;activeExplorer&#32;&#61;&#32;_outlookApplication.ActiveExplorer&#40;&#41;&#59;&#38;nbsp&#59;&#32;&#47;&#42;&#32;create&#32;commandbar&#32;&#42;&#47;&#38;nbsp&#59;&#32;Outlook._Explorer&#32;activeExplorer&#32;&#61;&#32;_outlookApplication.ActiveExplorer&#40;&#41;&#59;&#38;nbsp&#59;&#32;Office.CommandBar&#32;commandBar&#32;&#61;&#32;activeExplorer.CommandBars.Add&#40;_toolbarName,&#32;MsoBarPosition.msoBarTop,&#32;System.Type.Missing,&#32;true&#41;&#59;&#38;nbsp&#59;&#32;&#47;&#47;&#47;&#32;....&#38;nbsp&#59;&#32;&#38;nbsp&#59;&#38;nbsp&#59;&#32;&#47;&#42;&#32;create&#32;menu&#32;&#42;&#47;&#38;nbsp&#59;&#32;commandBar&#32;&#61;&#32;activeExplorer.CommandBars&#91;&#34;Menu&#32;Bar&#34;&#93;&#59;&#38;nbsp&#59;&#38;nbsp&#59;&#32;&#47;&#47;&#47;&#32;...&#38;nbsp&#59;&#38;nbsp&#59;&#32;activeExplorer.Dispose&#40;&#41;&#59;&#125;&#32;you&#32;see&#32;we&#32;save&#32;the&#32;Active&#32;Explorer&#32;proxy&#32;in&#32;a&#32;local&#32;variable&#32;and&#32;dispose&#32;them&#32;at&#32;the&#32;end.this&#32;is&#32;an&#32;outlook2000&#32;issue&#32;and&#32;not&#32;a&#32;NetOffice&#32;issue&#32;i&#32;think.&#32;Sebastian">
        
<p>i find a solution that works for me. change the SetupGui() method as follows:<br>
<br>
private void SetupGui()<br>
{<br>
&nbsp;<br>
&nbsp; Outlook._Explorer activeExplorer = _outlookApplication.ActiveExplorer();<br>
&nbsp; /* create commandbar */<br>
&nbsp; Outlook._Explorer activeExplorer = _outlookApplication.ActiveExplorer();<br>
&nbsp; Office.CommandBar commandBar = activeExplorer.CommandBars.Add(_toolbarName, MsoBarPosition.msoBarTop, System.Type.Missing, true);<br>
<br>
&nbsp; /// ....<br>
&nbsp; <br>
&nbsp;&nbsp; /* create menu */<br>
&nbsp; commandBar = activeExplorer.CommandBars[&quot;Menu Bar&quot;];<br>
<br>
&nbsp;&nbsp; /// ...<br>
<br>
&nbsp;&nbsp; activeExplorer.Dispose();<br>
} <br>
<br>
<br>
you see we save the Active Explorer proxy in a local variable and dispose them at the end.<br>
this is an outlook2000 issue and not a NetOffice issue i think. <br>
<br>
Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_932866" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="932936">
    <td id="PostDetailsCell_932936" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post932936"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/OliverChrisTrapp">OliverChrisTrapp</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/26/2012 12:51:11 PM" LocalTimeTicks="1351281071">Oct 26, 2012 at 12:51 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_932936" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Good&#32;man&#33;&#33;&#33;&#32;and&#32;it&#32;works&#32;for&#32;me&#32;&#58;-&#41;&#32;Thanks&#32;a&#32;lot&#33;&#32;Cheers&#32;Oli&#32;&#59;-&#41;&#32;&#38;nbsp&#59;&#32;&#38;nbsp&#59;">
        
<p>Good man!!!</p>
<p>and it works for me :-)</p>
<p><span style="color:#008000"><strong>Thanks a lot!</strong></span></p>
<p>Cheers Oli ;-)</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_932936" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="932952">
    <td id="PostDetailsCell_932952" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post932952"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/26/2012 1:30:36 PM" LocalTimeTicks="1351283436">Oct 26, 2012 at 1:30 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_932952" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="ooops&#32;no,&#32;it&#32;works&#32;not&#32;good&#32;because&#32;activeExplorer.Dispose&#40;&#41;&#59;&#32;release&#32;all&#32;childs&#40;buttons&#32;and&#32;so&#32;on&#41;&#32;and&#32;the&#32;events&#32;was&#32;not&#32;fired&#32;now.but&#32;its&#32;easy&#32;to&#32;handle&#33;&#32;please&#32;use&#32;activeExplorer.Dispose&#40;false&#41;&#59;&#32;&#47;&#47;&#32;false&#32;means&#32;dont&#32;destroy&#32;the&#32;event&#32;listenersSebastian">
        
<p>ooops no, it works not good because activeExplorer.Dispose(); release all childs(buttons and so on) and the events was not fired now.<br>
but its easy to handle! please use activeExplorer.Dispose(false); // false means dont destroy the event listeners<br>
<br>
Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_932952" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="933215">
    <td id="PostDetailsCell_933215" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post933215"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/OliverChrisTrapp">OliverChrisTrapp</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="10/27/2012 5:19:22 AM" LocalTimeTicks="1351340362">Oct 27, 2012 at 5:19 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_933215" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="You&#39;re&#32;correct&#32;there.&#32;Thanks&#32;a&#32;bunch&#33;&#32;Cheers&#32;Oli&#32;&#59;-&#41;">
        
<p>You're correct there. Thanks a bunch!</p>
<p>Cheers Oli ;-)</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_933215" class="Options" >
            
        </div>
        
    </td>
</tr>

</table>
    </div>

    


    <div id="PostEditorContainer">
        <a name="editor"></a>
        <div id="Editor" style="display: none;">
            

<div class="MarkdownEditor" data-options-id="0746da9d-feb5-4405-b5f2-5bec3678f190">
    <script class="options" defer="defer" id="0746da9d-feb5-4405-b5f2-5bec3678f190" type="application/json">{"maxLength":10000,"styleSheetLocation":""}</script>

    <div class="MarkdownEditorControls">
        <a href="#" tabindex="-1" class="control md_help" title="Markdown Syntax Guide"></a>
        <div class="control md_divider"></div>
        <a href="#" tabindex="-1" class="control md_header" title="Insert Header (CTRL + H)"></a>
        <a href="#" tabindex="-1" class="control md_code" title="Insert Code (CTRL + K)"></a>
        <a href="#" tabindex="-1" class="control md_quote" title="Insert Quote (CTRL + Q)"></a>
        <a href="#" tabindex="-1" class="control md_img" title="Insert Img (CTRL + G)"></a>
        <a href="#" tabindex="-1" class="control md_link" title="Insert Link (CTRL + L)"></a>
        <a href="#" tabindex="-1" class="control md_ulist" title="Unordered List (CTRL + U)"></a>
        <a href="#" tabindex="-1" class="control md_olist" title="Ordered List (CTRL + O)"></a>
        <a href="#" tabindex="-1" class="control md_italics" title="Italic Text (CTRL + I)"></a>
        <a href="#" tabindex="-1" class="control md_bold" title="Bold Text (CTRL + B)"></a>
    </div>

    

<div class="tab_control">
    <!-- Generate the basic HTML for the tabs. -->
    
        <div id="Compose"
              class="tab selected"
              data-custom-header-id=""
              data-tab-contents-id="compose_contents_ab80d408-9b74-41e5-b445-3d4e0b534501">
            Compose
        </div>
    
        <div id="Preview"
              class="tab "
              data-custom-header-id=""
              data-tab-contents-id="preview_contents_66d53ccb-3a0d-4676-93fa-0e008bd42aa2">
            Preview
        </div>
    
    <div class="clear"></div>
</div>


    <div id="compose_contents_ab80d408-9b74-41e5-b445-3d4e0b534501" class="compose_tab_content">
        <textarea class=" MarkdownEditorDimensions" cols="20" id="MarkdownEditor" name="content" rows="2">
</textarea>
        <div class="ClearBoth"></div>

        <div class="markdownGuide" style="display: none">
            <table>
                <tr>
                    <td class="markdownGuideColumn">
                        <h1>Text Formatting</h1>
                        <div># Header 1</div>
                        <div>## Header 2</div>
                        <br />
                        <div>*italics* (or _italics_)</div>
                        <div>**bold** (or __bold__)</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Lists</h1>
                        <div>* Unordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp * SubItem</div>
                        <br />
                        <div>1. Ordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 1. SubItem</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Quotes</h1>
                        <div>> Lorem ipsum</div>
                        <div>dolor sitamet </div>
                        <div>non. Lectus at</div>
                        <div>nam nunc...</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Code</h1>
                        <div>`Inline Code`</div>
                        <br />
                        <div>``` C#</div>
                        <div>if (foo==bar)</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbspbar++</div>
                        <div>```</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>References</h1>
                        <div>[Link Text](URL)</div>
                        <br />
                        <div>![Image](URL)</div>
                        <br />
                        <a class="Reference" target="_blank" href="http://codeplex.codeplex.com/wikipage?title=Markdown&referringTitle=Documentation">Markdown Reference</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="preview_contents_66d53ccb-3a0d-4676-93fa-0e008bd42aa2" class="preview_tab_content markDownOutput">
        
            <div></div>
        
    </div>
    <div class="clear"></div>
</div>

            
            <div class="row" id="recaptcha_row">
                
<script type="text/javascript">
    $(document).ready(function () {
        $('#recaptcha_reload').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_refresh.png');
        $('#recaptcha_switch_audio').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_audio.png');
        $('#recaptcha_switch_img').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_text.png');
        $('#recaptcha_whatsthis').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_help.png');
        $('#recaptcha_area tr:first').attr('height', '35');
    });
</script>

                <div class="clear"></div>
                <span id="ReCaptchaError"></span>
            </div>
            <div style="padding-top: 6px;">
                <input type="button" id="SaveButton" value="Save" class="ok" />
                <input type="button" id="CancelButton" value="Cancel" class="cancel" />
                <div class="clear"></div>
            </div>
        </div>
    </div>
</div>

<div id="DeletePostPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Post <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this post? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="ClosePostCancel" value="Cancel" class="cancel" />
            <input type="button" id="ClosePostOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>
        
            <!-- Email notification / Subscription details -->
            
    </div>
</div>
    
<div id="DeleteThreadPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Thread <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this thread? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="CloseThreadCancel" value="Cancel" class="cancel" />
            <input type="button" id="CloseThreadOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>

<script type="text/javascript" language="javascript">
    $(function () {

        $('#recaptcha_response_field')
            .bind('keypress', function (event) { return $submitKeyPressElement(this, event); });


        if ($('#DeleteThreadLink')) {
            $('#DeleteThreadLink').click(function () {
                OpenDialog('#DeleteThreadPanel', true, '41em');
            });
        }
        
        $('#DeleteThreadPanel #CloseThreadOk').click(function () {
            var url = 'http://netoffice.codeplex.com/discussions/400555';
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (x) {
                    location.href = x.RedirectUrl;
                }
            });
        });
    });

    workItemMention = new codeplex.ui.WorkItemMention();
    workItemMention.addLinks(".discussionPost");
</script>


        
        
                
                <div class="clear"></div>
                
                <div id="footer">
                    <div class="row">
                        <hr />
                        <ul>
                            <li>Â© 2006-2018 Microsoft</li>
                            <li><a href="http://www.codeplex.com/site/help">Get Help</a></li>
                            <li><a href="/site/legal/privacy">Privacy Statement</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/terms">Terms of Use</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/conduct">Code of Conduct</a></li>
                            <li><a href="http://developermedia.com/" target="_blank">Advertise With Us</a></li>
                            <li>Version 11.9.2017.21066</li>
                        </ul>
                    </div>
                </div>
            </div>
        </form>
    </body>

</html>