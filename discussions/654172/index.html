

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="" prefix="og: http://ogp.me/ns# profile: http://ogp.me/ns/profile#">
    
    
    
    

    
    <head>
        <meta id="CompatabilityMode" http-equiv="X-UA-Compatible" content="IE=edge" />
	    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="http://download-codeplex.sec.s-msft.com/css/v21066/i1970439/StyleSheet.ashx" id="MasterCss" rel="stylesheet" type="text/css" />
        <link rel="SHORTCUT ICON" href="http://www.codeplex.com/favicon.ico" />
        <title>NetOffice - MS Office in .NET - Excel&#58; Names.Add Method</title>
        
       
                    <script src="https://uhf.microsoft.com/mscc/statics/mscc-0.3.7.min.js"></script>
        
                    <link rel="stylesheet" type="text/css" href="https://uhf.microsoft.com/mscc/statics/mscc-0.3.7.min.css" />
        
            <script type="text/javascript">
                var msccHadCookieBannerAtPageStart = true;
            </script>
        

        <!--
        Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code,
        not by Microsoft.  See ASP.NET Ajax CDN Terms of Use â€“ http://www.asp.net/ajaxlibrary/CDN.ashx.
        -->
        <script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.4.4.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery === 'undefined') {
                document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        <script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.6/jquery-ui.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery.ui === 'undefined') {
                document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        
    <style type="text/css">.SideBar, .SideBarPadding{display:none;}.MainContent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style id="ProjectStyles" type="text/css">
        .SiteHeader, .SiteHeaderLeft {
            height:45px !important;
            overflow:hidden;
        }
        .SiteContent 
        {
            padding: 0 0 1em 0;
            margin-top:0;
            min-height:225px;
            border-right: 1px solid lightgrey;
            border-left: 1px solid lightgrey;
            border-bottom: 1px solid lightgrey;
        }
        .IE table.MinWidthContent
        {
	        table-layout: auto !important;	
        }
    </style>
    
    
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">

    
    
    <meta id="WTProjectName" name="WT.pi" content="netoffice"/>
    

    <link rel="EditURI" type="application/rsd+xml" title="RSD" href='http://netoffice.codeplex.com/rsd' />
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href='/wlwmanifest.xml' />
    
    
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET" url="http://netoffice.codeplex.com/project/feeds/rss"/>
    
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Discussions" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2fnetoffice"/>
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Issues" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2fnetoffice"/>
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Downloads" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2fnetoffice"/>
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Reviews" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2fnetoffice"/>
        
    
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Source&#32;code" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2fnetoffice"/>
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Wiki" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2fnetoffice"/>
    
        
    
        <meta content="summary" name="twitter:card" /><meta content="@CodePlex" name="twitter:site" /><meta content="http://netoffice.codeplex.com/discussions/654172?ProjectName=netoffice" name="twitter:url" /><meta content="NetOffice - MS Office in .NET" name="twitter:title" /><meta content=".NET wrapper assemblies for version independent using Microsoft Office, Excel, Word, Outlook, PowerPoint, Access, Project, Visio, Publisher" name="twitter:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" name="twitter:image" /><meta content="CodePlex" property="og:site_name" /><meta content="http://netoffice.codeplex.com/discussions/654172?ProjectName=netoffice" property="og:url" /><meta content="object" property="og:type" /><meta content="NetOffice - MS Office in .NET" property="og:title" /><meta content=".NET wrapper assemblies for version independent using Microsoft Office, Excel, Word, Outlook, PowerPoint, Access, Project, Visio, Publisher" property="og:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" property="og:image" />
        

    </head>
    
    <body>
         
            <div><div id='msccBanner' dir='ltr' data-site-name='CodePlex' data-mscc-version='0.3.6' data-nver='aspnet-2.0.5' data-sver='0.1.2' class='cc-banner' role='alert'><div class='cc-container'><svg class='cc-icon cc-v-center' x='0px' y='0px' viewBox='0 0 44 44' height='30px' fill='none' stroke='currentColor'><circle cx='22' cy='22' r='20' stroke-width='2'></circle><line x1='22' x2='22' y1='18' y2='33' stroke-width='3'></line><line x1='22' x2='22' y1='12' y2='15' stroke-width='3'></line></svg> <span class='cc-v-center cc-text'>This site uses cookies for analytics, personalized content and ads. By continuing to browse this site, you agree to this use.</span> <a href='https://go.microsoft.com/fwlink/?linkid=845480' aria-label='Learn more about Microsoft&#39;s Cookie Policy' id='msccLearnMore' class='cc-link cc-v-center cc-float-right' data-mscc-ic='false'>Learn more</a></div></div></div>
        <script src="http://download-codeplex.sec.s-msft.com/scripts/v21066/i5/ScriptLoader.ashx" type="text/javascript"></script>
        <form id="aspnetForm" autocomplete="off" method="POST" enctype="multipart/form-data">
            <input name="__RequestVerificationToken" type="hidden" value="khNvHYM_kYx8HHfVVTEKd2K-nLWRdJq_FKRLn0LA7O-VxX0E8VI2CiB67zf4BaqvnmIUm2KtwYR3_TL1EL-OAogktenq-kT6JgrP9_NL8gCRJ1tHZ22xe684_550nG_HWy1V5g2" /><input name="__RequestVerificationToken2" type="hidden" value="__RequestVerificationToken2380bfb04-0ec0-457d-9580-4be556ebb04f" />
            
            <div id="UpdateProgressPanel" class="loading_animation" style="display:none;">
                <div class="row">
                    <h2 class="anim_h2">
                        <span id="UpdateProgressText">Updating...</span>
                        <span id="animatedLoadingIconContainer">
                            <img id="animatedLoadingIcon" src="http://download-codeplex.sec.s-msft.com/Images/v21066/loading_animation.gif" class="anim_img"/>
                        </span>
                    </h2>
                </div>
            </div>
            
            <div style="display:none;">
                
                <img id="BlankImage" style="width:0;height:0;" src="http://download-codeplex.sec.s-msft.com/Images/v21066/blank.png" onload="self.logoImageLoaded=true;"/>

                <script language="javascript" type="text/javascript">
                    var date = new Date();
                    var timezoneOffset = date.getTimezoneOffset() / 60 * -1;
                    var timezoneOffsetCookie = getCookie("TimezoneOffset");
                    var firstTimeSetTimezoneCookie = false;

                    if (timezoneOffsetCookie == null || timezoneOffsetCookie != timezoneOffset) {
                        firstTimeSetTimezoneCookie = true;
                        document.cookie = "TimezoneOffset=" + timezoneOffset + '; domain=.codeplex.com;expires=Thu, 3 Jan 2019 10:50:20 UTC';
                    }
                </script>
            </div>
            
            
            <div id="banner">
                <div id="message">
                    <strong>CodePlex is going read-only starting November 27th.  </strong><a href="https://aka.ms/codeplex-readonly">Learn more and find next steps.</a>
                </div>
            </div>
            

            <div id="header">
                <div id="header_wrap" class="row">
                    <p id="logo"><a href="http://www.codeplex.com">Code<span class="semi">Plex</span></a><span id="tagline">Project Hosting for Open Source Software</span></p>
                    

<ul id="nav">

    <li><a href="/site/register/new" id="registerLink" class="ZoomFix">Register</a></li>
    <li ><a class="SignInLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2fnetoffice.codeplex.com%2fdiscussions%2f654172" id="signInLink">Sign In</a></li>
  
    <li class="last"><a class="rss_site_icon" href="http://www.codeplex.com/site/feeds/rss" type="application/rss+xml" rel="Alternate" title="CodePlex Site Activity"></a></li>
</ul>
                    <input id="searchsite" name="searchsite" maxlength="500" type="text" value="" /><span id="search_mag"><a id="submitSearch" name="submitSearch" class="magnify" title="Search" href="#"></a></span>
                    <script>
	$(document).ready(function() {
    var searchButton = $('#submitSearch'),
        searchBar = $('#searchsite');

    // Register our own handler for the search event while we wait for the SearchBox script to load.
    searchButton.bind('click.backupSearchBox', doProjectSearch);
    searchBar.bind('keypress.backupSearchBox', function(e) { if ($keyCode(e) === 13) { doProjectSearch(); return false; } });

    function cleanupSearchEvents() {
        // If the SearchBox was loaded, unregister our handlers.
        if (epx_loaded) {
            searchButton.unbind('.backupSearchBox');
            searchBar.unbind('.backupSearchBox');
        }
    }

    $loadScript('http://i4.services.social.microsoft.com/search/Widgets/SearchBox.jss?appid=1000&scopeid=1&boxId=searchsite&btnId=submitSearch&watermark=Search%20all%20projects&overrideWatermark=true&searchLocation=%2fsite%2fsearch&allowEmptySearch=true&focusOnInit=False&minimumTermLength=3', cleanupSearchEvents);
})
function doProjectSearch() {
    
    var url = '/site/search';

    //If search term is not same as watermark
    if($('#searchsite').val() != 'Search all projects')    
    {        
        url = url + '?query=' + encodeURIComponent($('#searchsite').val());
    }

    
    var callback = '';
    if (callback.length > 0 && eval('typeof ' + callback) != 'undefined')
        url += eval(callback + '()');

    window.location.href = url;
    return false;
}
</script>
                </div>
            </div>
            
            <div id="wrap">
                
    <div id="sub_heading" class="row">
        
        <div id="ProjectHeader">
            <div id="project_title_row" class="row">
                <div id="project_logo">
                    
    
    <div id="project_logo_and_text">
        <div class="logo_left">
            <a href="http://netoffice.codeplex.com/"><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=netoffice&DownloadId=236782&Build=21066" alt="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET" /></a>
        </div>
        <h1 class="text_right"><div><a href="http://netoffice.codeplex.com/" id="ProjectTitle4">NetOffice - MS Office in .NET</a></div></h1>
    </div>

                </div>
            </div>
        </div>
        
        <div id="ProjectDetailsDiv">
            
        </div>
		<div class="clear"></div>
        
                <div id="ProjectMigrationBanner" class="ProjectRedOnly""><strong>This project has moved and is read-only.  For the latest updates, please </strong><a href="https&#58;&#47;&#47;osdn.net&#47;projects&#47;netoffice">go here</a>.</div>
            

<ul id="page_box_links">
	<li id="homeTabCell" style="width: 63px;"><a id="homeTab" href="http://netoffice.codeplex.com/" class="box_home">home</a><div></div></li>
    
	<li id="sourceTabCell" style="width:113px;"><a id="sourceTab" href="http://netoffice.codeplex.com/SourceControl/latest" class="box_source">source code</a><div></div></li>
    
	<li id="releasesTabCell" style="width:105px;"><a id="releasesTab" href="http://netoffice.codeplex.com/releases" class="box_downloads">downloads</a><div></div></li>
    
    <li id="documentationTabCell" style="width:143px;"><a id="documentationTab" href="http://netoffice.codeplex.com/documentation" class="box_documentation">documentation</a><div></div></li>
    
	<li id="discussionTabCell" style="width:112px;"><a id="discussionTab" href="http://netoffice.codeplex.com/discussions" class="discussions_active">discussions</a><div></div></li>
    
	<li id="workItemsTabCell" style="width:70px;"><a id="workItemsTab" href="http://netoffice.codeplex.com/workitem/list/basic" class="box_issue">issues</a><div></div></li>
    
	<li id="peopleTabCell" style="width:70px;"><a id="peopleTab" href="http://netoffice.codeplex.com/team/view" class="box_people">people</a><div></div></li>
	<li id="licenseTabCell" style="width:70px;"><a id="licenseTab" href="http://netoffice.codeplex.com/license" class="box_license">license</a><div></div></li>
    
    <span class="stretch"></span>
</ul>

<script type="text/javascript">
    $(document).ready(function () {
        $('#page_box_links').applyLastClassToList();
    });
</script>
		    <div class="clear"></div>
            
     <td>
       

<div>
    
    <div id="actionBar" class="action_bar">
        <ul id="actionBar_ul" class="actionBar_sublinks subtab_right" style="vertical-align: middle;">

            

                <li id="li_actionbar_subscribe" data-action-id="actionbar_subscribe" data-action-type="PopUp" class="actionBar_sublinks" data-options-id="a5a5017a-3225-4a38-bdb5-1e42931ba0a9">
                
                    <script class="options" defer="defer" id="a5a5017a-3225-4a38-bdb5-1e42931ba0a9" type="application/json">{}</script> 
                    
                    <div class="actionBar_custom_content">

<div id="rssHoverDiv" class="HoverPanel LeftHoverWidth" style="display: none">
        <ul id="3_FeedsPanel" class="RssFeedsPanel">
            <li>
                <a id="ProjectRssLink" href="http://netoffice.codeplex.com/project/feeds/rss" class="ArrowSmall NoUnderline">All Project Updates</a>
            </li>
            
            <li>
                <a id="DiscussionRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2fnetoffice" class="ArrowSmall NoUnderline">Discussions</a>
            </li>
            
            <li>
                <a id="IssueTrackerRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2fnetoffice" class="ArrowSmall NoUnderline">Issue Tracker</a>
            </li>
            
            <li>
                <a id="ReleasesRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2fnetoffice" class="ArrowSmall NoUnderline">Downloads</a>
            </li>
            <li>
                <a id="ReviewsRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2fnetoffice" class="ArrowSmall NoUnderline">Reviews</a>
            </li>
            
            <li>
                <a id="SourceControlRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2fnetoffice" class="ArrowSmall NoUnderline">Source Code</a>
            </li>
            <li>
                <a id="WikiRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2fnetoffice" class="ArrowSmall NoUnderline">Wiki &amp; Documentation</a>
            </li>
        </ul>
</div></div>

                    <a href="#" id="actionbar_subscribe" title="Subscribe to project updates in RSS feeds." class="action_bar_item_link">
                        <img id="img_actionbar_subscribe" class="action_bar_item_image" src="http://download-codeplex.sec.s-msft.com/Images/v21066/actionbar_subscribe.png" style="vertical-align: middle" />
                        Subscribe
                    </a>

                </li>

            
        </ul>
    </div>
</div>
     </td>

        

    </div>
    
    
<div class="Threads">
    <div class="ViewThread">
        
        
        
            <h1 class="page_title WordWrapBreakWord">
                Excel&#58; Names.Add Method
            </h1>

            <!-- Private Discussion header -->
            

            <!-- Posts List Header: Topics and Wiki Link -->
            <table class="PostsListHeader">
                <tr>
                    <td>
                     
                    </td>
                    <td>
                        <div class="WikiLink">
                            <span title="Paste this into a wiki page to link to this discussion">
                                Wiki Link: [discussion:654172]
                            </span>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- The list of posts -->
            

<div id="discussionsPostList" data-options-id="19932fcb-0503-40fa-b9d0-8e5cf2318071">
    <script class="options" defer="defer" id="19932fcb-0503-40fa-b9d0-8e5cf2318071" type="application/json">{"threadUrl":"http://netoffice.codeplex.com/discussions/654172","showEditor":false,"checkImageUrl":"http://download-codeplex.sec.s-msft.com/Images/v21066/check_answer.png"}</script>

    <div class="Posts" style="margin-top: 10px;">
    

<table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 0px; table-layout:fixed">
    

<tr id="PostPanel" class="Post" d:forid="1471781">
    <td id="PostDetailsCell_1471781" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1471781"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/coheedld">coheedld</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="4/29/2016 3:38:14 PM" LocalTimeTicks="1461969494">Apr 29, 2016 at 3:38 PM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="4/29/2016 3:41:46 PM" LocalTimeTicks="1461969706">Apr 29, 2016 at 3:41 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1471781" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Hi&#32;Sebastian,&#10;&#10;as&#32;mentioned&#32;in&#32;the&#32;issue&#32;section&#32;some&#32;time&#32;ago&#32;there&#32;seems&#32;to&#32;be&#32;an&#32;issue&#32;with&#32;the&#32;&#34;names.add&#34;&#32;method&#32;in&#32;the&#32;international&#32;context.&#10;&#10;In&#32;VBA&#32;I&#32;can&#32;simply&#32;write&#10;&#10;&#96;&#96;&#96;&#10;Sub&#32;example&#40;&#41;&#10;&#32;&#32;&#32;&#32;ActiveWorkbook.Names.Add&#32;Name&#58;&#61;&#34;name1&#34;,&#32;RefersTo&#58;&#61;&#34;&#61;Offset&#40;&#36;A&#36;1,0,0,10,1&#41;&#34;&#10;End&#32;Sub&#10;&#96;&#96;&#96;&#10;&#10;In&#32;my&#32;german&#32;Office&#32;installation&#32;the&#32;formula&#32;is&#32;automatically&#32;converted&#32;into&#32;the&#32;german&#32;formule,&#32;i.e.&#32;adding&#32;a&#32;name&#32;&#34;name1&#34;&#32;with&#32;formula&#32;&#34;&#61;BEREICH.VERSCHIEBEN&#40;Tabelle2&#33;&#36;A&#36;1&#59;0&#59;0&#59;10&#59;1&#41;&#34;&#10;&#10;This&#32;does&#32;not&#32;work&#32;with&#32;NetOffice&#58;&#10;&#10;&#96;&#96;&#96;&#10;&#91;TestMethod&#93;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;public&#32;void&#32;AddNameEnglish&#40;&#41;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#123;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NetOffice.ExcelApi.Application&#32;app&#32;&#61;&#32;new&#32;NetOffice.ExcelApi.Application&#40;&#41;&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Visible&#32;&#61;&#32;true&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Workbooks.Add&#40;&#41;&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Activate&#40;&#41;&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Worksheets.Add&#40;&#41;&#59;&#10;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#40;&#40;Excel.Worksheet&#41;app.ActiveSheet&#41;.Names.Add&#40;&#34;name&#34;,&#32;&#34;&#61;Offset&#40;&#36;A&#36;1,0,0,10,1&#41;&#34;&#41;&#59;&#10;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Dispose&#40;&#41;&#59;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#125;&#10;&#96;&#96;&#96;&#10;&#10;This&#32;throws&#32;an&#32;exception&#58;&#10;level&#32;1&#58;&#32;InnerException&#9;&#123;&#34;Ein&#32;Aufrufziel&#32;hat&#32;einen&#32;Ausnahmefehler&#32;verursacht.&#34;&#125;&#9;System.Exception&#32;&#123;System.Reflection.TargetInvocationException&#125;&#10;level&#32;2&#58;&#32;&#34;Die&#32;eingegebene&#32;Formel&#32;enth&#228;lt&#32;einen&#32;Fehler.&#32;Versuchen&#32;Sie&#32;eines&#32;der&#32;folgenden&#32;Verfahren,&#32;um&#32;die&#32;Formel&#32;zu&#32;korrigieren&#58;&#10;&#8226;&#32;&#220;berpr&#252;fen&#32;Sie,&#32;ob&#32;alle&#32;Klammern&#32;und&#32;erforderlichen&#32;Argumente&#32;vorhanden&#32;sind.&#10;&#8226;&#32;Klicken&#32;Sie&#32;auf&#32;der&#32;Registerkarte&#32;&#39;Formeln&#39;&#32;auf&#32;&#39;Funktion&#32;einf&#252;gen&#39;&#32;&#40;in&#32;der&#32;Gruppe&#32;&#39;Funktionsbibliothek&#39;&#41;,&#32;um&#32;Hilfe&#32;beim&#32;Verwenden&#32;einer&#32;Funktion&#32;zu&#32;erhalten.&#10;&#8226;&#32;Sofern&#32;Sie&#32;Bezug&#32;auf&#32;eine&#32;andere&#32;Arbeitsmappe&#32;oder&#32;ein&#32;anderes&#32;Blatt&#32;nehmen,&#32;vergewissern&#32;Sie&#32;sich,&#32;dass&#32;die&#32;Angaben&#32;richtig&#32;sind.&#10;&#8226;&#32;Sofern&#32;Sie&#32;keine&#32;Formel&#32;eingeben,&#32;vermeiden&#32;Sie&#32;Minuszeichen&#32;&#40;-&#41;&#32;oder&#32;Gleichheitszeichen&#32;&#40;&#61;&#41;.&#32;Falls&#32;diese&#32;Zeichen&#32;erforderlich&#32;sind,&#32;f&#252;gen&#32;Sie&#32;vorher&#32;ein&#32;einzelnes&#32;Anf&#252;hrungszeichen&#32;&#40;&#39;&#41;&#32;ein.&#10;&#8226;&#32;Um&#32;weitere&#32;Information&#32;zu&#32;erhalten,&#32;klicken&#32;Sie&#32;auf&#32;&#39;Hilfe&#39;.&#34;&#10;&#10;So&#32;it&#32;looks&#32;like&#32;NetOffice&#32;has&#32;a&#32;problem&#32;in&#32;translating&#32;the&#32;formula&#32;properly.&#32;I&#32;tried&#32;the&#32;same&#32;with&#32;the&#32;german&#32;formula&#32;and&#32;this&#32;works&#32;fine&#58;&#10;&#10;&#96;&#96;&#96;&#10;&#91;TestMethod&#93;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;public&#32;void&#32;AddNameGerman&#40;&#41;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#123;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NetOffice.ExcelApi.Application&#32;app&#32;&#61;&#32;new&#32;NetOffice.ExcelApi.Application&#40;&#41;&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Visible&#32;&#61;&#32;true&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Workbooks.Add&#40;&#41;&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Activate&#40;&#41;&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Worksheets.Add&#40;&#41;&#59;&#10;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#40;&#40;Excel.Worksheet&#41;app.ActiveSheet&#41;.Names.Add&#40;&#34;name&#34;,&#32;&#34;&#61;BEREICH.VERSCHIEBEN&#40;&#36;A&#36;1&#59;&#32;0&#59;&#32;0&#59;&#32;10&#59;&#32;1&#41;&#34;&#41;&#59;&#10;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Dispose&#40;&#41;&#59;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#125;&#10;&#96;&#96;&#96;&#10;&#10;However,&#32;I&#32;want&#32;to&#32;use&#32;the&#32;&#34;auto&#32;translation&#34;&#32;of&#32;the&#32;formula&#32;as&#32;it&#32;is&#32;available&#32;in&#32;VBA.&#32;The&#32;documentation&#32;under&#32;https&#58;&#47;&#47;msdn.microsoft.com&#47;en-us&#47;library&#47;office&#47;ff835300.aspx&#32;says,&#32;that&#32;the&#32;&#34;RefersTo&#34;&#32;parameter&#32;should&#32;be&#32;provided&#32;in&#32;english&#32;&#40;&#34;Describes&#32;what&#32;the&#32;name&#32;refers&#32;to,&#32;in&#32;English,&#32;using&#32;A1-style&#32;notation,&#32;if&#32;the&#32;RefersToLocal,&#32;RefersToR1C1,&#32;and&#32;RefersToR1C1Local&#32;parameters&#32;are&#32;not&#32;specified.&#34;&#41;.&#10;&#10;So&#32;I&#32;would&#32;highly&#32;appreciate&#32;if&#32;you&#32;could&#32;look&#32;into&#32;this.&#32;Iam&#32;using&#32;NetOffice&#32;1.7.3.,&#32;Win&#32;10&#32;and&#32;Excel&#32;2013.&#10;&#10;Many&#32;thanks&#32;and&#32;have&#32;a&#32;nice&#32;weekend&#33;&#10;&#10;coheedld">
        <div class="markDownOutput ">Hi Sebastian,<br>
<br>
as mentioned in the issue section some time ago there seems to be an issue with the &quot;names.add&quot; method in the international context.<br>
<br>
In VBA I can simply write<br>
<pre><code>Sub example()
    ActiveWorkbook.Names.Add Name:=&quot;name1&quot;, RefersTo:=&quot;=Offset($A$1,0,0,10,1)&quot;
End Sub</code></pre>
In my german Office installation the formula is automatically converted into the german formule, i.e. adding a name &quot;name1&quot; with formula &quot;=BEREICH.VERSCHIEBEN(Tabelle2!$A$1;0;0;10;1)&quot;<br>
<br>
This does not work with NetOffice:<br>
<pre><code>[TestMethod]
        public void AddNameEnglish()
        {
            NetOffice.ExcelApi.Application app = new NetOffice.ExcelApi.Application();
            app.Visible = true;
            app.Workbooks.Add();
            app.ActiveWorkbook.Activate();
            app.ActiveWorkbook.Worksheets.Add();

            ((Excel.Worksheet)app.ActiveSheet).Names.Add(&quot;name&quot;, &quot;=Offset($A$1,0,0,10,1)&quot;);

            app.Dispose();            
        }</code></pre>
This throws an exception:<br>
level 1: InnerException {&quot;Ein Aufrufziel hat einen Ausnahmefehler verursacht.&quot;} System.Exception {System.Reflection.TargetInvocationException}<br>
level 2: &quot;Die eingegebene Formel enthÃ¤lt einen Fehler. Versuchen Sie eines der folgenden Verfahren, um die Formel zu korrigieren:<br>
â€¢ ÃœberprÃ¼fen Sie, ob alle Klammern und erforderlichen Argumente vorhanden sind.<br>
â€¢ Klicken Sie auf der Registerkarte 'Formeln' auf 'Funktion einfÃ¼gen' (in der Gruppe 'Funktionsbibliothek'), um Hilfe beim Verwenden einer Funktion zu erhalten.<br>
â€¢ Sofern Sie Bezug auf eine andere Arbeitsmappe oder ein anderes Blatt nehmen, vergewissern Sie sich, dass die Angaben richtig sind.<br>
â€¢ Sofern Sie keine Formel eingeben, vermeiden Sie Minuszeichen (-) oder Gleichheitszeichen (=). Falls diese Zeichen erforderlich sind, fÃ¼gen Sie vorher ein einzelnes AnfÃ¼hrungszeichen (') ein.<br>
â€¢ Um weitere Information zu erhalten, klicken Sie auf 'Hilfe'.&quot;<br>
<br>
So it looks like NetOffice has a problem in translating the formula properly. I tried the same with the german formula and this works fine:<br>
<pre><code>[TestMethod]
        public void AddNameGerman()
        {
            NetOffice.ExcelApi.Application app = new NetOffice.ExcelApi.Application();
            app.Visible = true;
            app.Workbooks.Add();
            app.ActiveWorkbook.Activate();
            app.ActiveWorkbook.Worksheets.Add();

            ((Excel.Worksheet)app.ActiveSheet).Names.Add(&quot;name&quot;, &quot;=BEREICH.VERSCHIEBEN($A$1; 0; 0; 10; 1)&quot;);

            app.Dispose();
        }</code></pre>
However, I want to use the &quot;auto translation&quot; of the formula as it is available in VBA. The documentation under
<a href="https://msdn.microsoft.com/en-us/library/office/ff835300.aspx"  rel="nofollow">
https://msdn.microsoft.com/en-us/library/office/ff835300.aspx</a> says, that the &quot;RefersTo&quot; parameter should be provided in english (&quot;Describes what the name refers to, in English, using A1-style notation, if the RefersToLocal, RefersToR1C1,
 and RefersToR1C1Local parameters are not specified.&quot;).<br>
<br>
So I would highly appreciate if you could look into this. Iam using NetOffice 1.7.3., Win 10 and Excel 2013.<br>
<br>
Many thanks and have a nice weekend!<br>
<br>
coheedld<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1471781" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1472091">
    <td id="PostDetailsCell_1472091" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1472091"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/1/2016 9:20:58 PM" LocalTimeTicks="1462162858">May 1, 2016 at 9:20 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1472091" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Das&#32;ist&#32;ja&#32;merkw&#252;rdig.&#32;Das&#32;heisst&#32;BEREICH.VERSCHIEBEN&#32;funktioniert&#32;und&#32;Offset&#32;nicht&#32;-&#32;richtig&#63;&#32;&#32;Office&#32;&#252;bergibt&#32;bei&#32;jedem&#32;Aufruf&#32;immer&#32;die&#32;ThreadCulture&#32;des&#32;Aufrufers&#32;und&#32;die&#32;ist&#32;per&#32;default&#32;1031-En-US&#40;&#228;nderbar&#32;unter&#32;Settings.ThreadCulture&#41;&#32;was&#32;auch&#32;in&#32;meinen&#32;eigenen&#32;Projekten&#32;bisher&#32;immer&#32;bestens&#32;funktioniert&#32;hat.&#32;&#32;Ich&#32;muss&#32;mal&#32;nachfragen&#32;bist&#32;du&#32;in&#32;einem&#32;IIS&#32;Szenario&#32;oder&#32;sonst&#32;irgendwie&#32;speziell&#63;&#32;&#40;F&#252;r&#32;mich&#32;hat&#32;das&#32;bisher&#32;immer&#32;bestens&#32;funktioniert&#32;bis&#32;auf&#32;Addins&#47;Exe&#39;s&#32;die&#32;Code&#32;aus&#32;extra&#32;erstellten&#32;Treads&#32;aufrufen,&#32;dann&#32;versagt&#32;die&#32;L&#228;nderkennung&#32;bisweilen&#41;&#13;&#10;&#13;&#10;&#40;NetOffice&#32;translated&#32;da&#32;garnichts,&#32;das&#32;macht&#32;Office&#32;von&#32;Hause&#32;aus.&#32;Office&#32;glaubt&#32;an&#32;dem&#32;Punkt&#32;es&#32;ist&#32;in&#32;deutsch,&#32;warum&#32;das&#32;so&#32;ist&#32;w&#252;rde&#32;ich&#32;auch&#32;gerne&#32;wissen&#32;weils&#32;eben&#32;auch&#32;eine&#32;wichtige&#32;infrastrukturelle&#32;Frage&#32;f&#252;r&#32;NetOffice&#32;ist.&#41;&#13;&#10;&#13;&#10;&#42;Sebastian&#13;&#10;&#40;Skype&#58;public.sebastian&#41;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;">
        <div class="markDownOutput ">Das ist ja merkwÃ¼rdig. Das heisst BEREICH.VERSCHIEBEN funktioniert und Offset nicht - richtig? Office Ã¼bergibt bei jedem Aufruf immer die ThreadCulture des Aufrufers und die ist per default 1031-En-US(Ã¤nderbar unter Settings.ThreadCulture) was auch in
 meinen eigenen Projekten bisher immer bestens funktioniert hat. Ich muss mal nachfragen bist du in einem IIS Szenario oder sonst irgendwie speziell? (FÃ¼r mich hat das bisher immer bestens funktioniert bis auf Addins/Exe's die Code aus extra erstellten Treads
 aufrufen, dann versagt die LÃ¤nderkennung bisweilen) <br>
<br>
(NetOffice translated da garnichts, das macht Office von Hause aus. Office glaubt an dem Punkt es ist in deutsch, warum das so ist wÃ¼rde ich auch gerne wissen weils eben auch eine wichtige infrastrukturelle Frage fÃ¼r NetOffice ist.)
<br>
<br>
*Sebastian <br>
(Skype:public.sebastian)<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1472091" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1472094">
    <td id="PostDetailsCell_1472094" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1472094"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/coheedld">coheedld</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/1/2016 9:46:03 PM" LocalTimeTicks="1462164363">May 1, 2016 at 9:46 PM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="5/1/2016 9:47:04 PM" LocalTimeTicks="1462164424">May 1, 2016 at 9:47 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1472094" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Korrekt,&#32;wenn&#32;ich&#32;die&#32;Formel&#32;mit&#32;&#34;BEREICH-VERSCHIEBEN&#34;&#32;eingebe&#32;wird&#32;der&#32;Name&#32;korrekt&#32;erzeugt.&#32;Mit&#32;&#34;OFFSET&#34;&#32;und&#32;der&#32;englischen&#32;Syntax&#32;&#40;&#34;,&#34;&#32;anstatt&#32;&#34;&#59;&#34;&#41;&#32;funktioniert&#32;das&#32;nicht.&#32;In&#32;VBA&#32;gebe&#32;ich&#32;die&#32;Formel&#32;immer&#32;in&#32;Englisch&#32;an&#32;und&#32;Office&#32;&#252;bersetzt&#32;diese&#32;dann&#32;selbstst&#228;ndig&#32;in&#32;die&#32;entsprechende&#32;Sprache&#32;der&#32;Installation.&#10;&#10;Wenn&#32;ich&#32;in&#32;der&#32;Methode,&#32;die&#32;den&#32;Namen&#32;setzt,&#32;die&#32;Location&#32;abrufe,&#32;bekomme&#32;ich&#32;1031&#32;geliefert&#10;&#10;&#96;&#96;&#96;&#10;xlsApp.LanguageSettings.LanguageID&#40;NetOffice.OfficeApi.Enums.MsoAppLanguageID.msoLanguageIDUI&#41;&#10;&#96;&#96;&#96;&#10;&#10;In&#32;einem&#32;&#34;speziellen&#32;Szenario&#34;&#32;bin&#32;ich&#32;meines&#32;Erachtens&#32;nicht.&#10;&#10;Kannst&#32;du&#32;dir&#32;das&#32;mal&#32;anschauen&#63;&#10;&#10;Vielen&#32;Dank&#32;und&#32;beste&#32;Gr&#252;&#223;e&#33;&#10;&#10;coheedld">
        <div class="markDownOutput ">Korrekt, wenn ich die Formel mit &quot;BEREICH-VERSCHIEBEN&quot; eingebe wird der Name korrekt erzeugt. Mit &quot;OFFSET&quot; und der englischen Syntax (&quot;,&quot; anstatt &quot;;&quot;) funktioniert das nicht. In VBA gebe ich die Formel immer in Englisch
 an und Office Ã¼bersetzt diese dann selbststÃ¤ndig in die entsprechende Sprache der Installation.<br>
<br>
Wenn ich in der Methode, die den Namen setzt, die Location abrufe, bekomme ich 1031 geliefert<br>
<pre><code>xlsApp.LanguageSettings.LanguageID(NetOffice.OfficeApi.Enums.MsoAppLanguageID.msoLanguageIDUI)</code></pre>
In einem &quot;speziellen Szenario&quot; bin ich meines Erachtens nicht.<br>
<br>
Kannst du dir das mal anschauen?<br>
<br>
Vielen Dank und beste GrÃ¼ÃŸe!<br>
<br>
coheedld<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1472094" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1472100">
    <td id="PostDetailsCell_1472100" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1472100"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/1/2016 10:29:31 PM" LocalTimeTicks="1462166971">May 1, 2016 at 10:29 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1472100" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Huch,&#32;kleines&#32;Typo&#32;Edit,&#32;nicht&#32;Office&#32;&#252;bergibt&#32;bei&#32;jedem&#32;Aufruf&#32;die&#32;ThreadCulture&#32;sondern&#32;nat&#252;rlich&#32;NetOffice&#32;&#252;bergibt&#32;die&#32;diese&#32;an&#32;Office.&#32;&#40;genauer&#32;gesagt&#32;&#252;bergibt&#32;Netoffice&#32;die&#32;Kontrolle&#32;an&#32;COM&#32;Interop&#32;und&#32;das&#32;simuliert&#32;dann&#32;gegen&#252;ber&#32;Office&#32;die&#32;gew&#252;nschte&#32;Lokale.&#13;&#10;&#13;&#10;Das&#32;liesse&#32;sich&#32;an&#32;deinem&#32;Beispiel&#32;wiefolgt&#32;&#228;ndern.&#13;&#10;&#13;&#10;NetOffice.ExcelApi.Application&#32;app&#32;&#61;&#32;new&#32;NetOffice.ExcelApi.Application&#40;&#41;&#59;&#13;&#10;app.Settings.ThreadCulture&#32;&#61;&#32;new&#32;System.Globalization.CultureInfo&#40;1031&#41;&#59;&#13;&#10;&#13;&#10;&#41;&#13;&#10;&#13;&#10;Ich&#32;muss&#32;dich&#32;das&#32;jetzt&#32;nochmal&#32;fragen&#32;bevor&#32;ich&#32;anfange&#32;das&#32;aufwendig&#32;nachzustellen.&#32;Hast&#32;du&#32;eine&#32;ganz&#32;normale&#32;Desktop&#32;Anwendung&#32;laufen&#32;in&#32;der&#32;du&#32;das&#32;testweise&#32;auziehst&#63;&#32;Kein&#32;Remote-Desktop,&#32;kein&#32;IIS,&#32;kein&#32;Quirks&#63;&#32;L&#228;uft&#32;dein&#32;Code&#32;in&#32;einem&#32;Office&#32;Addin&#32;oder&#32;normal&#32;als&#32;.exe&#63;&#32;Das&#32;ist&#32;wichtig&#32;weil&#32;sich&#32;COM&#32;Interop&#32;jeweils&#32;anders&#32;verh&#228;lt&#32;wenn&#32;der&#32;Origin&#32;Thread&#32;ein&#32;Single&#32;Thread&#32;oder&#32;vielleicht&#32;ein&#32;COM&#32;STA&#32;Thread&#32;ist&#40;was&#32;bei&#32;Addins&#32;der&#32;Fall&#32;ist&#41;,&#32;im&#32;letzteren&#32;Fall&#32;funktionieren&#32;bestimmte&#32;Features&#32;von&#32;.Net&#32;nicht.&#32;Lange&#32;Rede&#32;kurzer&#32;Sinn,&#32;je&#32;genauer&#32;du&#32;dein&#32;Szenario&#32;beschreiben&#32;kannst&#32;umso&#32;besser.&#32;Ich&#32;such&#32;mich&#32;sonst&#32;tot&#32;nach&#32;Sachen&#32;von&#32;denen&#32;du&#32;wahrscheinlich&#32;noch&#32;nie&#32;was&#32;geh&#246;rt&#32;hast.&#32;Das&#32;hilft&#32;dir&#32;nicht&#32;und&#32;das&#32;hilft&#32;mir&#32;nicht.&#32;&#40;Du&#32;hast&#32;das&#32;Problem&#32;gut&#32;beschrieben&#32;und&#32;dir&#32;da&#32;&#40;vergleichbar&#41;&#32;viel&#32;M&#252;he&#32;gemacht,&#32;sch&#246;n&#32;&#58;&#41;&#32;ich&#32;bin&#32;voll&#32;dabei&#32;aber&#32;jetzt&#32;brauch&#32;ich&#32;Fakten&#32;und&#32;das&#32;nicht&#32;im&#32;Support-Sprech-&#32;einige&#32;Fragen&#32;m&#246;gen&#32;dir&#32;nicht&#32;einleuchten&#32;aber&#32;beachte&#32;und&#32;beantworte&#32;diese&#32;bitte&#32;trotzdem&#32;-&#32;ich&#32;denk&#32;mir&#32;schon&#32;was&#32;dabei&#41;&#13;&#10;&#13;&#10;&#13;&#10;WM_REGARDS&#32;&#13;&#10;&#40;OffTopic&#58;Wie&#32;ist&#32;eigentlich&#32;die&#32;Grosswetterlage&#32;gerade&#32;so&#32;in&#32;Deutschand&#63;&#41;&#13;&#10;&#13;&#10;&#32;&#13;&#10;&#13;&#10;&#13;&#10;&#32;&#13;&#10;">
        <div class="markDownOutput ">Huch, kleines Typo Edit, nicht Office Ã¼bergibt bei jedem Aufruf die ThreadCulture sondern natÃ¼rlich NetOffice Ã¼bergibt die diese an Office. (genauer gesagt Ã¼bergibt Netoffice die Kontrolle an COM Interop und das simuliert dann gegenÃ¼ber Office die gewÃ¼nschte
 Lokale. <br>
<br>
Das liesse sich an deinem Beispiel wiefolgt Ã¤ndern. <br>
<br>
NetOffice.ExcelApi.Application app = new NetOffice.ExcelApi.Application(); <br>
app.Settings.ThreadCulture = new System.Globalization.CultureInfo(1031); <br>
<br>
) <br>
<br>
Ich muss dich das jetzt nochmal fragen bevor ich anfange das aufwendig nachzustellen. Hast du eine ganz normale Desktop Anwendung laufen in der du das testweise auziehst? Kein Remote-Desktop, kein IIS, kein Quirks? LÃ¤uft dein Code in einem Office Addin oder
 normal als .exe? Das ist wichtig weil sich COM Interop jeweils anders verhÃ¤lt wenn der Origin Thread ein Single Thread oder vielleicht ein COM STA Thread ist(was bei Addins der Fall ist), im letzteren Fall funktionieren bestimmte Features von .Net nicht. Lange
 Rede kurzer Sinn, je genauer du dein Szenario beschreiben kannst umso besser. Ich such mich sonst tot nach Sachen von denen du wahrscheinlich noch nie was gehÃ¶rt hast. Das hilft dir nicht und das hilft mir nicht. (Du hast das Problem gut beschrieben und dir
 da (vergleichbar) viel MÃ¼he gemacht, schÃ¶n :) ich bin voll dabei aber jetzt brauch ich Fakten und das nicht im Support-Sprech- einige Fragen mÃ¶gen dir nicht einleuchten aber beachte und beantworte diese bitte trotzdem - ich denk mir schon was dabei)
<br>
<br>
<br>
WM_REGARDS <br>
(OffTopic:Wie ist eigentlich die Grosswetterlage gerade so in Deutschand?)<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1472100" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1472142">
    <td id="PostDetailsCell_1472142" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1472142"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/coheedld">coheedld</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/2/2016 9:15:51 AM" LocalTimeTicks="1462205751">May 2, 2016 at 9:15 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1472142" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Hallo&#32;Seabstian,&#13;&#10;&#13;&#10;habe&#32;die&#32;Testmethode&#32;nochmal&#32;angpasst&#32;und&#32;die&#32;ThreadCulture&#32;explizit&#32;gesetzt,&#32;es&#32;wird&#32;aber&#32;die&#32;gleiche&#32;exception&#32;geschmissen.&#32;Ich&#32;habe&#32;auch&#32;im&#32;Programm&#32;w&#228;hrend&#32;der&#32;Laufzeit&#32;mal&#32;die&#32;ThreadCulture&#32;abgezogen,&#32;diese&#32;ist&#32;korrekterweise&#32;&#34;en-US&#34;.&#13;&#10;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#91;TestMethod&#93;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;public&#32;void&#32;AddNameEnglish&#40;&#41;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#123;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NetOffice.ExcelApi.Application&#32;app&#32;&#61;&#32;new&#32;NetOffice.ExcelApi.Application&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Settings.ThreadCulture&#32;&#61;&#32;new&#32;System.Globalization.CultureInfo&#40;1031&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Visible&#32;&#61;&#32;true&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Workbooks.Add&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Activate&#40;&#41;&#59;&#13;&#10;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#40;&#40;Excel.Worksheet&#41;app.ActiveSheet&#41;.Names.Add&#40;&#34;name&#34;,&#32;&#34;&#61;Offset&#40;Tabelle1&#33;&#36;A&#36;1,0,0,10,1&#41;&#34;&#41;&#59;&#13;&#10;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Dispose&#40;&#41;&#59;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#125;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#13;&#10;Zur&#32;Anwendung&#58;&#32;Es&#32;handelt&#32;sich&#32;eigentlich&#32;nur&#32;um&#32;eine&#32;Klassenbibliothek,&#32;die&#32;in&#32;Office&#32;als&#32;Addin&#32;registriert&#32;wird&#32;und&#32;ausschlie&#223;lich&#32;aus&#32;der&#32;Office&#32;Anwendung&#32;heraus&#32;&#252;ber&#32;das&#32;Ribbon&#32;angesteuert&#32;wird.&#32;Ich&#32;kompiliere&#32;einfach&#32;den&#32;Code,&#32;der&#32;registriert&#32;dann&#32;das&#32;Addin&#32;und&#32;dann&#32;&#246;ffne&#32;ich&#32;die&#32;entsprechende&#32;Office&#32;App&#32;und&#32;nutze&#32;die&#32;Funktionalit&#228;t.&#32;Kein&#32;remote&#32;zeugs,&#32;kein&#32;Kompatibilit&#228;tsmodus&#32;o.&#196;.&#32;Ist&#32;die&#32;Info&#32;hilfreich&#63;&#13;&#10;&#13;&#10;&#40;OffTopic&#58;&#32;Gro&#223;wetterlage&#32;nach&#32;ein&#32;paar&#32;kalten&#32;und&#32;teilweise&#32;verschneiten&#32;Tagen&#32;eigentlich&#32;ok&#58;&#32;Am&#32;Wochenende&#32;gabs&#32;Sonnenschein&#32;und&#32;es&#32;war&#32;schon&#32;ein&#32;bisschen&#32;warm.&#32;N&#228;chstes&#32;WE&#32;soll&#32;es&#32;&#228;hnlich&#32;werden&#41;.">
        <div class="markDownOutput ">Hallo Seabstian, <br>
<br>
habe die Testmethode nochmal angpasst und die ThreadCulture explizit gesetzt, es wird aber die gleiche exception geschmissen. Ich habe auch im Programm wÃ¤hrend der Laufzeit mal die ThreadCulture abgezogen, diese ist korrekterweise &quot;en-US&quot;.<br>
<pre><code>[TestMethod]
        public void AddNameEnglish()
        {
            NetOffice.ExcelApi.Application app = new NetOffice.ExcelApi.Application();
            app.Settings.ThreadCulture = new System.Globalization.CultureInfo(1031);
            app.Visible = true;
            app.Workbooks.Add();
            app.ActiveWorkbook.Activate();

            ((Excel.Worksheet)app.ActiveSheet).Names.Add(&quot;name&quot;, &quot;=Offset(Tabelle1!$A$1,0,0,10,1)&quot;);

            app.Dispose();            
        }</code></pre>
Zur Anwendung: Es handelt sich eigentlich nur um eine Klassenbibliothek, die in Office als Addin registriert wird und ausschlieÃŸlich aus der Office Anwendung heraus Ã¼ber das Ribbon angesteuert wird. Ich kompiliere einfach den Code, der registriert dann das
 Addin und dann Ã¶ffne ich die entsprechende Office App und nutze die FunktionalitÃ¤t. Kein remote zeugs, kein KompatibilitÃ¤tsmodus o.Ã„. Ist die Info hilfreich?
<br>
<br>
(OffTopic: GroÃŸwetterlage nach ein paar kalten und teilweise verschneiten Tagen eigentlich ok: Am Wochenende gabs Sonnenschein und es war schon ein bisschen warm. NÃ¤chstes WE soll es Ã¤hnlich werden).<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1472142" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1472148">
    <td id="PostDetailsCell_1472148" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1472148"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/coheedld">coheedld</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/2/2016 10:44:54 AM" LocalTimeTicks="1462211094">May 2, 2016 at 10:44 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1472148" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Update&#58;&#32;Mit&#32;den&#32;Interop&#32;Assemblies&#32;funktioniert&#32;das&#32;auch&#32;nicht&#32;wie&#32;in&#32;VBA&#32;&#40;scheint&#32;also&#32;kein&#32;NetOffice&#32;Problem&#32;zu&#32;sein&#41;.&#32;Folgender&#32;Code&#32;wirft&#32;die&#32;gleiche&#32;exception&#32;&#40;ung&#252;ltige&#32;Formel&#41;&#58;&#13;&#10;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#91;TestMethod&#93;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;public&#32;void&#32;AddNameEnglish3&#40;&#41;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#123;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Microsoft.Office.Interop.Excel.Application&#32;app&#32;&#61;&#32;new&#32;Microsoft.Office.Interop.Excel.Application&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Visible&#32;&#61;&#32;true&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Workbooks.Add&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Activate&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Names.Add&#40;&#34;tester&#34;,&#32;&#34;&#61;Offset&#40;&#39;Tabelle1&#39;&#33;&#36;A&#36;1,0,0,1,1&#41;&#34;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#125;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#13;&#10;interessant&#32;ist,&#32;dass&#32;der&#32;folgende&#32;code&#32;einen&#32;Namen&#32;anlegt&#32;&#40;&#34;&#59;&#34;&#32;anstatt&#32;&#34;,&#34;&#32;in&#32;der&#32;Formel&#41;&#58;&#13;&#10;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#91;TestMethod&#93;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;public&#32;void&#32;AddNameEnglish4&#40;&#41;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#123;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Microsoft.Office.Interop.Excel.Application&#32;app&#32;&#61;&#32;new&#32;Microsoft.Office.Interop.Excel.Application&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Visible&#32;&#61;&#32;true&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Workbooks.Add&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Activate&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Names.Add&#40;&#34;tester&#34;,&#32;&#34;&#61;Offset&#40;&#39;Tabelle1&#39;&#33;&#36;A&#36;1&#59;0&#59;0&#59;1&#59;1&#41;&#34;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#125;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#13;&#10;Die&#32;angelegte&#32;Formel&#32;wird&#32;allerdings&#32;1&#58;1&#32;&#252;bernommen,&#32;also&#32;als&#32;&#34;&#61;Offset&#40;Tabelle1&#33;&#36;A&#36;1&#59;0&#59;0&#59;1&#59;1&#41;&#34;&#32;hinterlegt.&#32;Aber&#32;meine&#32;deutsche&#32;Office&#32;Version&#32;kennt&#32;nat&#252;rlich&#32;kein&#32;&#34;Offset&#34;&#32;und&#32;daher&#32;ist&#32;das&#32;unbrauchbar.">
        <div class="markDownOutput ">Update: Mit den Interop Assemblies funktioniert das auch nicht wie in VBA (scheint also kein NetOffice Problem zu sein). Folgender Code wirft die gleiche exception (ungÃ¼ltige Formel):<br>
<pre><code>[TestMethod]
        public void AddNameEnglish3()
        {
            Microsoft.Office.Interop.Excel.Application app = new Microsoft.Office.Interop.Excel.Application();
            app.Visible = true;
            app.Workbooks.Add();
            app.ActiveWorkbook.Activate();
            app.ActiveWorkbook.Names.Add(&quot;tester&quot;, &quot;=Offset('Tabelle1'!$A$1,0,0,1,1)&quot;);
        }</code></pre>
interessant ist, dass der folgende code einen Namen anlegt (&quot;;&quot; anstatt &quot;,&quot; in der Formel):<br>
<pre><code>[TestMethod]
        public void AddNameEnglish4()
        {
            Microsoft.Office.Interop.Excel.Application app = new Microsoft.Office.Interop.Excel.Application();
            app.Visible = true;
            app.Workbooks.Add();
            app.ActiveWorkbook.Activate();
            app.ActiveWorkbook.Names.Add(&quot;tester&quot;, &quot;=Offset('Tabelle1'!$A$1;0;0;1;1)&quot;);
        }</code></pre>
Die angelegte Formel wird allerdings 1:1 Ã¼bernommen, also als &quot;=Offset(Tabelle1!$A$1;0;0;1;1)&quot; hinterlegt. Aber meine deutsche Office Version kennt natÃ¼rlich kein &quot;Offset&quot; und daher ist das unbrauchbar.<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1472148" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1472708">
    <td id="PostDetailsCell_1472708" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1472708"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/7/2016 1:24:18 PM" LocalTimeTicks="1462652658">May 7, 2016 at 1:24 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1472708" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Wenn&#32;du&#32;AddNameEnglish3&#40;&#41;&#32;als&#32;Netoffice&#32;Variante&#32;testen&#32;l&#228;sst,&#32;wird&#32;dann&#32;auch&#32;&#34;,&#34;&#32;in&#32;&#34;&#59;&#34;&#32;umgewandelt&#32;oder&#32;scheitert&#32;der&#32;Aufruf&#63;">
        <div class="markDownOutput ">Wenn du AddNameEnglish3() als Netoffice Variante testen lÃ¤sst, wird dann auch &quot;,&quot; in &quot;;&quot; umgewandelt oder scheitert der Aufruf?<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1472708" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1472712">
    <td id="PostDetailsCell_1472712" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1472712"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/coheedld">coheedld</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/7/2016 2:19:41 PM" LocalTimeTicks="1462655981">May 7, 2016 at 2:19 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1472712" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Der&#32;Aufruf&#32;scheitert&#58;&#13;&#10;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#91;TestMethod&#93;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;public&#32;void&#32;AddNameEnglish3NetOffice&#40;&#41;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#123;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NetOffice.ExcelApi.Application&#32;app&#32;&#61;&#32;new&#32;NetOffice.ExcelApi.Application&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Visible&#32;&#61;&#32;true&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Workbooks.Add&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Activate&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Names.Add&#40;&#34;tester&#34;,&#32;&#34;&#61;Offset&#40;&#39;Tabelle1&#39;&#33;&#36;A&#36;1,0,0,1,1&#41;&#34;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#125;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#13;&#10;Exception&#32;Message&#58;&#32;&#34;Die&#32;eingegebene&#32;Formel&#32;enth&#228;lt&#32;einen&#32;Fehler.&#32;Versuchen&#32;Sie&#32;eines&#32;der&#32;folgenden&#32;Verfahren,&#32;um&#32;die&#32;Formel&#32;zu&#32;korrigieren&#58;&#13;&#10;&#13;&#10;&#8226;&#32;&#220;berpr&#252;fen&#32;Sie,&#32;ob&#32;alle&#32;Klammern&#32;und&#32;erforderlichen&#32;Argumente&#32;vorhanden&#32;sind.&#13;&#10;&#8226;&#32;Klicken&#32;Sie&#32;auf&#32;der&#32;Registerkarte&#32;&#39;Formeln&#39;&#32;auf&#32;&#39;Funktion&#32;einf&#252;gen&#39;&#32;&#40;in&#32;der&#32;Gruppe&#32;&#39;Funktionsbibliothek&#39;&#41;,&#32;um&#32;Hilfe&#32;beim&#32;Verwenden&#32;einer&#32;Funktion&#32;zu&#32;erhalten.&#13;&#10;&#8226;&#32;Sofern&#32;Sie&#32;Bezug&#32;auf&#32;eine&#32;andere&#32;Arbeitsmappe&#32;oder&#32;ein&#32;anderes&#32;Blatt&#32;nehmen,&#32;vergewissern&#32;Sie&#32;sich,&#32;dass&#32;die&#32;Angaben&#32;richtig&#32;sind.&#13;&#10;&#8226;&#32;Sofern&#32;Sie&#32;keine&#32;Formel&#32;eingeben,&#32;vermeiden&#32;Sie&#32;Minuszeichen&#32;&#40;-&#41;&#32;oder&#32;Gleichheitszeichen&#32;&#40;&#61;&#41;.&#32;Falls&#32;diese&#32;Zeichen&#32;erforderlich&#32;sind,&#32;f&#252;gen&#32;Sie&#32;vorher&#32;ein&#32;einzelnes&#32;Anf&#252;hrungszeichen&#32;&#40;&#39;&#41;&#32;ein.&#13;&#10;&#8226;&#32;Um&#32;weitere&#32;Information&#32;zu&#32;erhalten,&#32;klicken&#32;Sie&#32;auf&#32;&#39;Hilfe&#39;.&#34;">
        <div class="markDownOutput ">Der Aufruf scheitert:<br>
<pre><code>[TestMethod]
        public void AddNameEnglish3NetOffice()
        {
            NetOffice.ExcelApi.Application app = new NetOffice.ExcelApi.Application();
            app.Visible = true;
            app.Workbooks.Add();
            app.ActiveWorkbook.Activate();
            app.ActiveWorkbook.Names.Add(&quot;tester&quot;, &quot;=Offset('Tabelle1'!$A$1,0,0,1,1)&quot;);
        }</code></pre>
Exception Message: &quot;Die eingegebene Formel enthÃ¤lt einen Fehler. Versuchen Sie eines der folgenden Verfahren, um die Formel zu korrigieren:
<br>
<br>
â€¢ ÃœberprÃ¼fen Sie, ob alle Klammern und erforderlichen Argumente vorhanden sind. <br>
â€¢ Klicken Sie auf der Registerkarte 'Formeln' auf 'Funktion einfÃ¼gen' (in der Gruppe 'Funktionsbibliothek'), um Hilfe beim Verwenden einer Funktion zu erhalten.
<br>
â€¢ Sofern Sie Bezug auf eine andere Arbeitsmappe oder ein anderes Blatt nehmen, vergewissern Sie sich, dass die Angaben richtig sind.
<br>
â€¢ Sofern Sie keine Formel eingeben, vermeiden Sie Minuszeichen (-) oder Gleichheitszeichen (=). Falls diese Zeichen erforderlich sind, fÃ¼gen Sie vorher ein einzelnes AnfÃ¼hrungszeichen (') ein.
<br>
â€¢ Um weitere Information zu erhalten, klicken Sie auf 'Hilfe'.&quot;<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1472712" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="1472764">
    <td id="PostDetailsCell_1472764" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post1472764"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/coheedld">coheedld</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="5/8/2016 8:26:24 AM" LocalTimeTicks="1462721184">May 8, 2016 at 8:26 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_1472764" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post markDownOutput" 
        data-markdown="Noch&#32;folgende&#32;interessante&#32;Beobachtung&#58;&#13;&#10;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#91;TestMethod&#93;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;public&#32;void&#32;AddNameEnglish3NetOffice&#40;&#41;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#123;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;NetOffice.ExcelApi.Application&#32;app&#32;&#61;&#32;new&#32;NetOffice.ExcelApi.Application&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Visible&#32;&#61;&#32;true&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.Workbooks.Add&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Activate&#40;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#40;&#40;Excel.Worksheet&#41;app.ActiveWorkbook.ActiveSheet&#41;.Cells&#91;1,&#32;1&#93;.Value&#32;&#61;&#32;&#34;&#61;TODAY&#40;&#41;&#34;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#47;&#47;app.ActiveWorkbook.Names.Add&#40;name&#58;&#32;&#34;tester&#34;,&#32;refersTo&#58;&#32;&#34;&#61;Offset&#40;&#39;Tabelle1&#39;&#33;&#36;A&#36;1,0,0,1,1&#41;&#34;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;app.ActiveWorkbook.Names.Add&#40;name&#58;&#32;&#34;tester&#34;,&#32;refersTo&#58;&#32;&#34;&#61;TODAY&#40;&#41;&#34;&#41;&#59;&#13;&#10;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#125;&#13;&#10;&#96;&#96;&#96;&#13;&#10;&#13;&#10;Hier&#32;wird&#32;in&#32;Zelle&#32;A1&#32;des&#32;aktuellen&#32;Sheets&#32;korrekterweise&#32;die&#32;Formel&#32;&#252;bersetzt&#32;und&#32;es&#32;wird&#32;&#34;&#61;HEUTE&#40;&#41;&#34;&#32;eingetragen.&#32;Im&#32;NameManager&#32;erhalte&#32;ich&#32;jedoch&#32;einen&#32;Namen&#32;&#34;tester&#34;,&#32;der&#32;auf&#32;&#34;&#61;TODAY&#40;&#41;&#34;&#32;verweist.&#32;Hier&#32;wird&#32;die&#32;Formel&#32;nicht&#32;&#252;bersetzt&#32;und&#32;daher&#32;funktioniert&#32;sie&#32;auch&#32;nicht.">
        <div class="markDownOutput ">Noch folgende interessante Beobachtung:<br>
<pre><code>[TestMethod]
        public void AddNameEnglish3NetOffice()
        {
            NetOffice.ExcelApi.Application app = new NetOffice.ExcelApi.Application();
            app.Visible = true;
            app.Workbooks.Add();
            app.ActiveWorkbook.Activate();
            ((Excel.Worksheet)app.ActiveWorkbook.ActiveSheet).Cells[1, 1].Value = &quot;=TODAY()&quot;;
            //app.ActiveWorkbook.Names.Add(name: &quot;tester&quot;, refersTo: &quot;=Offset('Tabelle1'!$A$1,0,0,1,1)&quot;);
            app.ActiveWorkbook.Names.Add(name: &quot;tester&quot;, refersTo: &quot;=TODAY()&quot;);
        }</code></pre>
Hier wird in Zelle A1 des aktuellen Sheets korrekterweise die Formel Ã¼bersetzt und es wird &quot;=HEUTE()&quot; eingetragen. Im NameManager erhalte ich jedoch einen Namen &quot;tester&quot;, der auf &quot;=TODAY()&quot; verweist. Hier wird die Formel nicht
 Ã¼bersetzt und daher funktioniert sie auch nicht.<br>
</div>
        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_1472764" class="Options" >
            
        </div>
        
    </td>
</tr>

</table>
    </div>

    


    <div id="PostEditorContainer">
        <a name="editor"></a>
        <div id="Editor" style="display: none;">
            

<div class="MarkdownEditor" data-options-id="4777daf8-54f1-4e7b-952c-df94b1f37842">
    <script class="options" defer="defer" id="4777daf8-54f1-4e7b-952c-df94b1f37842" type="application/json">{"maxLength":10000,"styleSheetLocation":""}</script>

    <div class="MarkdownEditorControls">
        <a href="#" tabindex="-1" class="control md_help" title="Markdown Syntax Guide"></a>
        <div class="control md_divider"></div>
        <a href="#" tabindex="-1" class="control md_header" title="Insert Header (CTRL + H)"></a>
        <a href="#" tabindex="-1" class="control md_code" title="Insert Code (CTRL + K)"></a>
        <a href="#" tabindex="-1" class="control md_quote" title="Insert Quote (CTRL + Q)"></a>
        <a href="#" tabindex="-1" class="control md_img" title="Insert Img (CTRL + G)"></a>
        <a href="#" tabindex="-1" class="control md_link" title="Insert Link (CTRL + L)"></a>
        <a href="#" tabindex="-1" class="control md_ulist" title="Unordered List (CTRL + U)"></a>
        <a href="#" tabindex="-1" class="control md_olist" title="Ordered List (CTRL + O)"></a>
        <a href="#" tabindex="-1" class="control md_italics" title="Italic Text (CTRL + I)"></a>
        <a href="#" tabindex="-1" class="control md_bold" title="Bold Text (CTRL + B)"></a>
    </div>

    

<div class="tab_control">
    <!-- Generate the basic HTML for the tabs. -->
    
        <div id="Compose"
              class="tab selected"
              data-custom-header-id=""
              data-tab-contents-id="compose_contents_d1382909-3dc2-459f-98cd-d93d849e0f28">
            Compose
        </div>
    
        <div id="Preview"
              class="tab "
              data-custom-header-id=""
              data-tab-contents-id="preview_contents_25da1b81-b319-45f8-a31c-6c2d75d12312">
            Preview
        </div>
    
    <div class="clear"></div>
</div>


    <div id="compose_contents_d1382909-3dc2-459f-98cd-d93d849e0f28" class="compose_tab_content">
        <textarea class=" MarkdownEditorDimensions" cols="20" id="MarkdownEditor" name="content" rows="2">
</textarea>
        <div class="ClearBoth"></div>

        <div class="markdownGuide" style="display: none">
            <table>
                <tr>
                    <td class="markdownGuideColumn">
                        <h1>Text Formatting</h1>
                        <div># Header 1</div>
                        <div>## Header 2</div>
                        <br />
                        <div>*italics* (or _italics_)</div>
                        <div>**bold** (or __bold__)</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Lists</h1>
                        <div>* Unordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp * SubItem</div>
                        <br />
                        <div>1. Ordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 1. SubItem</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Quotes</h1>
                        <div>> Lorem ipsum</div>
                        <div>dolor sitamet </div>
                        <div>non. Lectus at</div>
                        <div>nam nunc...</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Code</h1>
                        <div>`Inline Code`</div>
                        <br />
                        <div>``` C#</div>
                        <div>if (foo==bar)</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbspbar++</div>
                        <div>```</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>References</h1>
                        <div>[Link Text](URL)</div>
                        <br />
                        <div>![Image](URL)</div>
                        <br />
                        <a class="Reference" target="_blank" href="http://codeplex.codeplex.com/wikipage?title=Markdown&referringTitle=Documentation">Markdown Reference</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="preview_contents_25da1b81-b319-45f8-a31c-6c2d75d12312" class="preview_tab_content markDownOutput">
        
            <div></div>
        
    </div>
    <div class="clear"></div>
</div>

            
            <div class="row" id="recaptcha_row">
                
<script type="text/javascript">
    $(document).ready(function () {
        $('#recaptcha_reload').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_refresh.png');
        $('#recaptcha_switch_audio').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_audio.png');
        $('#recaptcha_switch_img').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_text.png');
        $('#recaptcha_whatsthis').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_help.png');
        $('#recaptcha_area tr:first').attr('height', '35');
    });
</script>

                <div class="clear"></div>
                <span id="ReCaptchaError"></span>
            </div>
            <div style="padding-top: 6px;">
                <input type="button" id="SaveButton" value="Save" class="ok" />
                <input type="button" id="CancelButton" value="Cancel" class="cancel" />
                <div class="clear"></div>
            </div>
        </div>
    </div>
</div>

<div id="DeletePostPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Post <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this post? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="ClosePostCancel" value="Cancel" class="cancel" />
            <input type="button" id="ClosePostOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>
        
            <!-- Email notification / Subscription details -->
            
    </div>
</div>
    
<div id="DeleteThreadPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Thread <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this thread? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="CloseThreadCancel" value="Cancel" class="cancel" />
            <input type="button" id="CloseThreadOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>

<script type="text/javascript" language="javascript">
    $(function () {

        $('#recaptcha_response_field')
            .bind('keypress', function (event) { return $submitKeyPressElement(this, event); });


        if ($('#DeleteThreadLink')) {
            $('#DeleteThreadLink').click(function () {
                OpenDialog('#DeleteThreadPanel', true, '41em');
            });
        }
        
        $('#DeleteThreadPanel #CloseThreadOk').click(function () {
            var url = 'http://netoffice.codeplex.com/discussions/654172';
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (x) {
                    location.href = x.RedirectUrl;
                }
            });
        });
    });

    workItemMention = new codeplex.ui.WorkItemMention();
    workItemMention.addLinks(".discussionPost");
</script>


        
        
                
                <div class="clear"></div>
                
                <div id="footer">
                    <div class="row">
                        <hr />
                        <ul>
                            <li>Â© 2006-2018 Microsoft</li>
                            <li><a href="http://www.codeplex.com/site/help">Get Help</a></li>
                            <li><a href="/site/legal/privacy">Privacy Statement</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/terms">Terms of Use</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/conduct">Code of Conduct</a></li>
                            <li><a href="http://developermedia.com/" target="_blank">Advertise With Us</a></li>
                            <li>Version 11.9.2017.21066</li>
                        </ul>
                    </div>
                </div>
            </div>
        </form>
    </body>

</html>