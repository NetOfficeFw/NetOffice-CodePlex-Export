[
  {
    "Id": "1068331",
    "ThreadId": "450015",
    "Html": "Hallo zusammen,\r<br />\n<br />\nich will nochmal auf den Fehler mit der Eventregistrierung kommen.\r<br />\nMein Projekt läuft prinzipiell unter Benutzung von NetOffice echt gut, aber die Eventregistrierung scheint in Verbindung mit Word2000 überhaupt nicht zu gehen.\r<br />\nIch habe mir heute auch die Version 1.6.0 gezogen (Danke an Sebastian!) aber das Problem ist das Gleiche wie schon mit der 1.5.2.\r<br />\n<br />\nIch kann es schon mit dem mitgelieferten Demoprogramm aus dem Paket (NetOffice 1.6.0\\NET 2.0\\Examples\\Word\\C#\\Examples) nachvollziehbar machen:\r<br />\nNach der problemlosen Übersetzung rufe ich das kompilierte Programm <strong>WordExamplesCS2.exe</strong> aus und wähle die Demo &quot;<strong>Using Events</strong>&quot;.<br />\n<ul>\n<li>Word2000 bleibt komplett einfach stehen, die Demo auch.</li>\n<li>Nach einem Timeout kann ich Word schliessen, bekomme die übliche und unnötige &quot;Willst das Problem an M$ melden&quot;-Meldung und dann wird die Exception &quot;<strong>COMException (0x80004005): Specified instance doesnt implement the target event interface.</strong>&quot; angezeigt (unten der volle Trace)</li>\n<li>Die anderen Demos laufen, Die Word-Kommunikation ist also sonst problemlos</li>\n<li>Das gleiche unter Word 2003, 2007, 2010 läuft wunderbar</li>\n<li>\nLeider habe ich kein Entwicklungssystem auf dem Word2000 Rechner aber eine schnell eingebaute Debugfunktion zeigt mor dass der Fehler immer am ersten Eventhandler liegt der aufgerufen wird, also beim &quot;wordApplication_NewDocumentEvent&quot;.<br />\n<pre><code>    // we register some events. note: the event trigger was called from word, means an other Thread\n    wordApplication.NewDocumentEvent += new NetOffice.WordApi.Application_NewDocumentEventHandler(wordApplication_NewDocumentEvent);\n    wordApplication.DocumentBeforeCloseEvent += new NetOffice.WordApi.Application_DocumentBeforeCloseEventHandler(wordApplication_DocumentBeforeCloseEvent);\n</code></pre>\n\n</li>\n</ul>\nEntferne ich diese Zeile, so tritt der Fehler in der nächsten Zeile auf &quot;wordApplication_DocumentBeforeCloseEvent&quot;.\r<br />\n<br />\nHabe nur ich das Problem oder steh ich irgendwie auf nem Schlauch ? Ist für mich ein ernstes Problem, da Word2000 noch zu knapp 30% der Leute im Einsatz ist und letztendlich auch der Grund für die Suche nach Netoffice war.\r<br />\n<br />\nIch kann meine Kiste hier gerne für weitere Test zur Verfügung stellen, Teamviewer ist auch schon da. Gerne zu jeder Tages- und Nachtzeit!\r<br />\n<br />\nHat jemand eine Idee ?\r<br />\n<br />\n<br />\nViele Grüße, Jochen\r<br />\n<br />\n<br />\nHier der Trace:\r<br />\nWord / C# / .Net 2.0\r<br />\n<br />\nSee the end of this message for details on invoking \r<br />\njust-in-time (JIT) debugging instead of this dialog box.\r<br />\n<br />\n************** Exception Text **************\r<br />\nSystem.Runtime.InteropServices.COMException (0x80004005): Specified instance doesnt implement the target event interface.\r<br />\n   at NetOffice.SinkHelper.GetConnectionPoint(COMObject comProxy, IConnectionPoint&amp; point, String[] sinkIds)\r<br />\n   at NetOffice.WordApi.Application.CreateEventBridge()\r<br />\n   at NetOffice.WordApi.Application.add_NewDocumentEvent(Application_NewDocumentEventHandler value)\r<br />\n   at WordExamplesCS2.Example06.buttonStartExample_Click(Object sender, EventArgs e) in C:\\Test\\NetOffice 1.6.0\\NET 2.0\\Examples\\Word\\C#\\Examples\\WordExamples\\Examples\\Example06.cs:line 69\r<br />\n   at System.Windows.Forms.Control.OnClick(EventArgs e)\r<br />\n   at System.Windows.Forms.Button.OnClick(EventArgs e)\r<br />\n   at System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)\r<br />\n   at System.Windows.Forms.Control.WmMouseUp(Message&amp; m, MouseButtons button, Int32 clicks)\r<br />\n   at System.Windows.Forms.Control.WndProc(Message&amp; m)\r<br />\n   at System.Windows.Forms.ButtonBase.WndProc(Message&amp; m)\r<br />\n   at System.Windows.Forms.Button.WndProc(Message&amp; m)\r<br />\n   at System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message&amp; m)\r<br />\n   at System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; m)\r<br />\n   at System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)\r<br />\n<br />\n<br />\n************** Loaded Assemblies **************\r<br />\nmscorlib<br />\n<pre><code>Assembly Version: 2.0.0.0\nWin32 Version: 2.0.50727.3643 (GDR.050727-3600)</code></pre>\n\n<h2>    CodeBase: file:///c:/WINDOWS/Microsoft.NET/Framework/v2.0.50727/mscorlib.dll</h2>\nWordExamplesCS2<br />\n<pre><code>Assembly Version: 1.0.0.0\nWin32 Version: 1.0.0.0</code></pre>\n\n<h2>    CodeBase: file://192.168.0.50/Test/NetOffice%201.6.0/NET%202.0/Examples/Word/C%23/Examples/WordExamples/bin/Debug/WordExamplesCS2.exe</h2>\nSystem.Windows.Forms<br />\n<pre><code>Assembly Version: 2.0.0.0\nWin32 Version: 2.0.50727.3645 (GDR.050727-3600)</code></pre>\n\n<h2>    CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Windows.Forms/2.0.0.0__b77a5c561934e089/System.Windows.Forms.dll</h2>\nSystem<br />\n<pre><code>Assembly Version: 2.0.0.0\nWin32 Version: 2.0.50727.3644 (GDR.050727-3600)</code></pre>\n\n<h2>    CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System/2.0.0.0__b77a5c561934e089/System.dll</h2>\nSystem.Drawing<br />\n<pre><code>Assembly Version: 2.0.0.0\nWin32 Version: 2.0.50727.3644 (GDR.050727-3600)</code></pre>\n\n<h2>    CodeBase: file:///C:/WINDOWS/assembly/GAC_MSIL/System.Drawing/2.0.0.0__b03f5f7f11d50a3a/System.Drawing.dll</h2>\nExampleBase<br />\n<pre><code>Assembly Version: 1.0.0.0\nWin32 Version: 1.0.0.0</code></pre>\n\n<h2>    CodeBase: file://192.168.0.50/Test/NetOffice%201.6.0/NET%202.0/Examples/Word/C%23/Examples/WordExamples/bin/Debug/ExampleBase.DLL</h2>\nWordApi<br />\n<pre><code>Assembly Version: 1.6.0.0\nWin32 Version: 1.6.0.0</code></pre>\n\n<h2>    CodeBase: file://192.168.0.50/Test/NetOffice%201.6.0/NET%202.0/Examples/Word/C%23/Examples/WordExamples/bin/Debug/WordApi.DLL</h2>\nNetOffice<br />\n<pre><code>Assembly Version: 1.6.0.0\nWin32 Version: 1.6.0.0</code></pre>\n\n<h2>    CodeBase: file://192.168.0.50/Test/NetOffice%201.6.0/NET%202.0/Examples/Word/C%23/Examples/WordExamples/bin/Debug/NetOffice.DLL</h2>\nOfficeApi<br />\n<pre><code>Assembly Version: 1.6.0.0\nWin32 Version: 1.6.0.0</code></pre>\n\n<h2>    CodeBase: file://192.168.0.50/Test/NetOffice%201.6.0/NET%202.0/Examples/Word/C%23/Examples/WordExamples/bin/Debug/OfficeApi.DLL</h2>\nVBIDEApi<br />\n<pre><code>Assembly Version: 1.6.0.0\nWin32 Version: 1.6.0.0</code></pre>\n\n<h2>    CodeBase: file://192.168.0.50/Test/NetOffice%201.6.0/NET%202.0/Examples/Word/C%23/Examples/WordExamples/bin/Debug/VBIDEApi.DLL</h2>\n************** JIT Debugging **************\r<br />\nTo enable just-in-time (JIT) debugging, the .config file for this\r<br />\napplication or computer (machine.config) must have the\r<br />\njitDebugging value set in the system.windows.forms section.\r<br />\nThe application must also be compiled with debugging\r<br />\nenabled.\r<br />\n<br />\nFor example:\r<br />\n<br />\n&lt;configuration&gt;<br />\n<pre><code>&lt;system.windows.forms jitDebugging=&quot;true&quot; /&gt;</code></pre>\n\n&lt;/configuration&gt;\r<br />\n<br />\nWhen JIT debugging is enabled, any unhandled exception\r<br />\nwill be sent to the JIT debugger registered on the computer\r<br />\nrather than be handled by this dialog box.<br />\n",
    "PostedDate": "2013-07-15T04:34:46.78-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1068336",
    "ThreadId": "450015",
    "Html": "schau ich mir heute abend sofort an und teste das durch.\r<br />\n<br />\nSebastian<br />\n",
    "PostedDate": "2013-07-15T04:50:10.283-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1068599",
    "ThreadId": "450015",
    "Html": "Es handelt sich hierbei um einen dokumentierten Bug in Word 2000 der mir auch schon mal über den Weg gelaufen ist.\r<br />\nKonkret reagiert Word auf die Methode FindConnectionPoint (in SinkHelper.cs =&gt; NetOffice Core) nicht bzw. bleibt dabei hängen wenn man einen Parameter(ID) übergibt den Word 2000 nicht kennt.(NetOffice versucht der Reihe nach von Version 15(2013) runter zu Version 9(2000) das höchstmögliche EventInterface zu bekommen) Es gibt 2 Wege den COM Event Container anzusprechen, der andere ist EnumConnectionPoint, den NetOffice auch beherrscht. Zuerst wird allerdings der Weg über FindConnectionPoint probiert da es leider andere Office Produkte gibt die in älteren Versionen wieder auf EnumConnectionPoint falsch reagieren. Ich kann nicht mehr tun als einen Schalter einzubauen der steuert welche Methode zuerst angewendet wird. (Mit EnumConnectionPoint hat Word2000 keine Probleme) Wenns ganz eilig ist kannst du das im Source selbst ändern in dem du im Source SinkHelper.cs in der Methode public static string GetConnectionPoint\r<br />\ndie Reihenfolge der Methoden umtauschst. Ich werde am Wochenende das bestehende Release updaten und so einen Schalter einbauen(NetOffice.Settings.UseEnumConnectionPointFirst = true)\r<br />\n<br />\nSebastian<br />\n",
    "PostedDate": "2013-07-15T11:44:59.173-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1068880",
    "ThreadId": "450015",
    "Html": "Hallo Sebastian,\r<br />\n<br />\nvielen Dank für die superschnelle und fundierte Antwort!\r<br />\nIch habe in der Sinkerklasse jetzt mal testweise die beiden Aufrufe vertauscht und alle Projekte umgestellt auf .Net 2.0.\r<br />\nDanach lief das Demoprogramm problemlos durch mit der Eventregistrierung unter Word2000 und Word2010, ich bin begeistert!\r<br />\n<br />\nIch weiss jetzt nicht, welche Office-System nun Probleme machen wenn der Aufruf umgedreht wird, daher wäre ich für den Schalter auf jeden Fall sehr dankbar.\r<br />\nPrima, ich bau das jetzt mal in mein Projekt ein und stelle gleich alles um auf 1.6.0\r<br />\n<br />\nDanke für die schnelle Hilfe, Jochen 'Nunz' Herz<br />\n",
    "PostedDate": "2013-07-16T01:26:25.247-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]