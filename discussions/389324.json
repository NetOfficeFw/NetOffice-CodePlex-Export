[
  {
    "Id": "892338",
    "ThreadId": "389324",
    "Html": "\r\n<p>I'm trying to create a UDF in C# that will pull in a range of cells and do something with the contents of those cells. &nbsp;I cannot seem to get the correct fype for the formula parameter though. &nbsp;I have other formulas that are successfully pulling\r\n in string parameters but I need to support a range of cell references too. &nbsp;Examples:</p>\r\n<p>WORKS:</p>\r\n<p>public string myFormula1(string myParameter)</p>\r\n<p>{</p>\r\n<p><span style=\"white-space:pre\"></span>return myParameter;</p>\r\n<p>}</p>\r\n<p>DOES NOT WORK:</p>\r\n<p>public string myFormula(NetOffice.ExcelApi.Range myRange)&nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>{ &nbsp;</p>\r\n<p><span style=\"white-space:pre\"></span>var rowCount = myRange.Rows.Count; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p><span style=\"white-space:pre\"></span>return rowCount.ToString();&nbsp; &nbsp; &nbsp; &nbsp;</p>\r\n<p>}</p>\r\n<p>&nbsp;</p>\r\n<p>What is the correct type for the range of cells argument?</p>\r\n",
    "PostedDate": "2012-07-27T09:29:14.847-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "892430",
    "ThreadId": "389324",
    "Html": "\r\n<p>just have a look: <a href=\"http://blogs.msdn.com/b/eric_carter/archive/2004/12/01/273127.aspx\">\r\nhttp://blogs.msdn.com/b/eric_carter/archive/2004/12/01/273127.aspx</a><br>\r\nyou can see:</p>\r\n<p><span style=\"font-family:Courier New\"><span style=\"color:#0000ff\"><span style=\"color:blue; font-size:10pt\">public</span></span><span style=\"font-size:x-small\">\r\n<span style=\"color:#0000ff\"><span style=\"color:blue\">double</span></span> CalculateArea(<span style=\"color:#0000ff\"><span style=\"color:blue\">object</span></span> Range)<br>\r\n</span></span><span style=\"font-family:Courier New\"><span style=\"color:#000000\"><span style=\"font-size:10pt\">{<br>\r\n</span></span><span style=\"color:#000000\"><span style=\"font-size:10pt\">&nbsp; Excel.</span></span><span style=\"font-size:x-small\"><span style=\"color:#008080\"><span style=\"color:teal\">Range</span></span> r = Range\r\n<span style=\"color:#0000ff\"><span style=\"color:blue\">as</span></span> Excel.<span style=\"color:#008080\"><span style=\"color:teal\">Range</span></span>;<br>\r\n<span style=\"color:#000000\"><span style=\"font-size:10pt\">&nbsp; </span></span><span style=\"color:#0000ff\"><span style=\"color:blue\">return</span></span>\r\n<span style=\"color:#008080\"><span style=\"color:teal\">Convert</span></span>.ToDouble(r.Width)&nbsp;*\r\n<span style=\"color:#008080\"><span style=\"color:teal\">Convert</span></span>.ToDouble(r.Height);<br>\r\n<span style=\"color:#000000\"><span style=\"font-size:10pt\">}<br>\r\n<br>\r\nin NetOffice you have to use:<br>\r\n<span style=\"font-family:Courier New\"><span style=\"color:#0000ff\"><span style=\"color:blue; font-size:10pt\"><br>\r\npublic</span></span><span style=\"font-size:x-small\"> <span style=\"color:#0000ff\">\r\n<span style=\"color:blue\">double</span></span> CalculateArea(<span style=\"color:#0000ff\"><span style=\"color:blue\">object</span></span> Range)<br>\r\n</span></span><span style=\"font-family:Courier New\"><span style=\"color:#000000\"><span style=\"font-size:10pt\">{<br>\r\n</span></span><span style=\"color:#000000\"><span style=\"font-size:10pt\">&nbsp; Excel.</span></span><span style=\"font-size:x-small\"><span style=\"color:#008080\"><span style=\"color:teal\">Range</span></span> r =\r\n<span style=\"color:#0000ff\"><span style=\"color:blue\">new </span></span>Excel.<span style=\"color:#008080\"><span style=\"color:teal\">Range(<span style=\"color:#0000ff\"><span style=\"color:blue\">null</span></span>, Range)</span></span>;<br>\r\n<span style=\"color:#000000\"><span style=\"font-size:10pt\">&nbsp; </span></span><span style=\"color:#0000ff\"><span style=\"color:blue\">int result =\r\n</span></span><span style=\"color:#008080\"><span style=\"color:teal\">Convert</span></span>.ToDouble(r.Width)&nbsp;*\r\n<span style=\"color:#008080\"><span style=\"color:teal\">Convert</span></span>.ToDouble(r.Height);<br>\r\n&nbsp;&nbsp; r.Dispose();<br>\r\n&nbsp;&nbsp; <span style=\"color:#0000ff\"><span style=\"color:blue\">return result;</span></span><br>\r\n<span style=\"color:#000000\"><span style=\"font-size:10pt\">}<br>\r\n</span></span></span></span><br>\r\n<br>\r\n</span></span></span></span></p>\r\n",
    "PostedDate": "2012-07-27T14:23:05.473-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]