[
  {
    "Id": "816796",
    "ThreadId": "350378",
    "Html": "\r\n<p>I copied in some source code from Example05 from SamplesVB and I ran into this compile time error:</p>\r\n<p>Interop type 'Application' cannot be embedded. Use the applicable interface instead.<span>\r\n</span></p>\r\n<p>Searched about this and I resolved this by changin the Embed Interop Types property from True to False.&nbsp;</p>\r\n<p>I wonder if that could be the reason why I get a runtime error trying to open a workbook stored at bin\\debug\\DataFiles\\Pipes.xlsx.&nbsp;</p>\r\n<p>Here is a bit of my code: </p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> LoadExcelData()\r\n            <span style=\"color:green\">' Initialize Api COMObject Support</span>\r\n            LateBindingApi.Core.Factory.Initialize()\r\n            <span style=\"color:green\">' start excel and turn off msg boxes</span>\r\n            excelApplication = <span style=\"color:blue\">New</span> Excel.Application()\r\n            excelApplication.DisplayAlerts = <span style=\"color:blue\">False</span>\r\n            excelApplication.Visible = <span style=\"color:blue\">False</span>\r\n            <span style=\"color:green\">' add a new workbook</span>\r\n            workBook = excelApplication.Workbooks.Open(<span style=\"color:#a31515\">&quot;\\\\DataFiles\\\\Pipes.xlsx&quot;</span>)\r\n            <span style=\"color:blue\">Dim</span> workSheet <span style=\"color:blue\">As</span> Excel.Worksheet = workBook.Worksheets(1)\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Here is the error:</p>\r\n<p></p>\r\n<pre>System.InvalidOperationException was unhandled\r\n  Message=An error occurred creating the form. See Exception.InnerException for details.  The error is: See inner exception for details.\r\n  Source=CBMI.InstrumentDemo\r\n  StackTrace:\r\n       at CBMI.InstrumentDemo.My.MyProject.MyForms.Create__Instance__[T](T Instance) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 190\r\n       at CBMI.InstrumentDemo.My.MyProject.MyForms.get_MainForm()\r\n       at CBMI.InstrumentDemo.My.MyApplication.OnCreateMainForm() in C:\\Users\\john\\Documents\\Visual Studio 2010\\Projects\\CBMI.PipeAnalyzer\\Instrument\\My Project\\Application.Designer.vb:line 35\r\n       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.OnRun()\r\n       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.DoApplicationModel()\r\n       at Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Run(String[] commandLine)\r\n       at CBMI.InstrumentDemo.My.MyApplication.Main(String[] Args) in 17d14f5c-a337-4978-8281-53493378c1071.vb:line 81\r\n       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)\r\n       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)\r\n       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()\r\n       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)\r\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)\r\n       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\r\n       at System.Threading.ThreadHelper.ThreadStart()\r\n  InnerException: System.Runtime.InteropServices.COMException\r\n       Message=See inner exception for details.\r\n       Source=LateBindingApi.Core\r\n       ErrorCode=-2147467259\r\n       StackTrace:\r\n            at LateBindingApi.Core.Invoker.MethodReturn(COMObject comObject, String name, Object[] paramsArray)\r\n            at NetOffice.ExcelApi.Workbooks.Open(String filename)\r\n            at CBMI.InstrumentDemo.InstrumentDemo.MainForm.LoadExcelData() in C:\\Users\\john\\Documents\\Visual Studio 2010\\Projects\\CBMI.PipeAnalyzer\\Instrument\\Mainform.vb:line 657\r\n            at CBMI.InstrumentDemo.InstrumentDemo.MainForm..ctor() in C:\\Users\\john\\Documents\\Visual Studio 2010\\Projects\\CBMI.PipeAnalyzer\\Instrument\\Mainform.vb:line 47\r\n       InnerException: System.Reflection.TargetInvocationException\r\n            Message=Exception has been thrown by the target of an invocation.\r\n            Source=mscorlib\r\n            StackTrace:\r\n                 at System.RuntimeType.InvokeDispMethod(String name, BindingFlags invokeAttr, Object target, Object[] args, Boolean[] byrefModifiers, Int32 culture, String[] namedParameters)\r\n                 at System.RuntimeType.InvokeMember(String name, BindingFlags bindingFlags, Binder binder, Object target, Object[] providedArgs, ParameterModifier[] modifiers, CultureInfo culture, String[] namedParams)\r\n                 at System.Type.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args, CultureInfo culture)\r\n                 at LateBindingApi.Core.Invoker.MethodReturn(COMObject comObject, String name, Object[] paramsArray)\r\n            InnerException: System.Runtime.InteropServices.COMException\r\n                 HelpLink=xlmain11.chm\r\n                 Message=Microsoft Excel cannot access the file '\\\\DataFiles\\pipes.xlsx'. There are several possible reasons:\r\n\r\n� The file name or path does not exist.\r\n� The file is being used by another program.\r\n� The workbook you are trying to save has the same name as a currently open workbook.\r\n                 Source=Microsoft Excel\r\n                 ErrorCode=-2146827284\r\n                 InnerException:</pre>\r\nI am on a development machine, Excel is no longer open at all let alone to that file.&nbsp;\r\n<p></p>\r\n",
    "PostedDate": "2012-03-28T13:26:49.58-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "816805",
    "ThreadId": "350378",
    "Html": "<p>hello john,</p>\r\n<p>the first one, yes set the embedd settings to false and it works. i'm still learning about the COM embedding feature, what i know so far is you cant embedd CoClasses, Excel.Application is a CoClass, just interfaces are supported for the embedding feature. The new NetOffice assemblies contains the PrimaryInteropAssembly attribute, thats the reason for the compiler option, but NetOffice assemblies are not really stupid interop assemblies of course.<br />the reason for the attribute in the NetOffice assemblies is easy. its make the IRibbon Interfaces usable, there also declarated in the NetOffice assemblies BUT as simple early bind declaration and not as a wrapper class. if you write an addin and implement IRibbonExtensibility the compiler try to register NetOffice for COM Interop and fails. the PrimaryInteropAssembly attribute make sure the compiler dont try to register Netoffice but a sideeffect is the IDE offers you the embedd feature with true by default. set always to false.</p>\r\n<p>the second one, the error occured in the last line ? no i think one line before. you always need the absolute path to the file as i know so far.<br />the xlmain11.chm in the exception trace indicates you use excel 2003 maybe, you have different versions installed?</p>\r\n<p>Sebastian</p>",
    "PostedDate": "2012-03-28T13:46:57.08-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "816832",
    "ThreadId": "350378",
    "Html": "<p>Hi Sebastian,</p>\n<p>The 1st error was just a guess of mine (wondering if affected 2nd error); anyway, thanks for the explanation.</p>\n<p>The 2nd error you also helped me on. Most examples I have seen show something in the root drive like:</p>\n<p>\n<pre>workBook = excelApplication.Workbooks.Open(\"c:\\\\Pipes.xlsx\")</pre>\n</p>\n<p>As soon as I disabled the User Access Control on my PC of which I am the only user and an administrator,&nbsp;I was able to create a little XLSX file in the root and then in turn my code works. But your observation that&nbsp;you always need the absolute path to the file is very interesting and helpful. I will explore that more because I &nbsp;am just getting started.&nbsp;I think your product is very, very cool (I worked on an Outlook Addin sometime ago and it WAS a hassle with different versions of&nbsp;Office.</p>",
    "PostedDate": "2012-03-28T15:05:18.013-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "816839",
    "ThreadId": "350378",
    "Html": "<p>hello john,</p>\r\n<p>looks like you convert some VBA stuff to a VB.NET application. its different maybe in a VBA environment and you dont need a full qualified path here.<br />since windows vista you dont have permission to write in a root directory like C: or D: you have also no permissions to write in your own application folder by default (unfortunately) a secure method is Environment.SpecialFolder.<br /><br /></p>\r\n<pre>Console.WriteLine(<span style=\"color: #a31515;\">\"GetFolderPath: {0}\"</span>, Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData));<br /><br />you have full access by default for this directory.<br /><br /><br /><br />Sebastian<br /></pre>",
    "PostedDate": "2012-03-28T15:22:52.873-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]