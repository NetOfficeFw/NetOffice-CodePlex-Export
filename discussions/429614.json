[
  {
    "Id": "986779",
    "ThreadId": "429614",
    "Html": "\r\n<p>I'm writing a PowerPoint COM addin and I want to alter the state of a toggleButton in runtime. For example, once I create a new presentation, I want to get the toggleButton and deactivate it if it's active. How can I get the custom controls I added to the\r\n Ribbon on runtime?</p>\r\n<p>Thanks in advance.</p>\r\n",
    "PostedDate": "2013-01-14T16:41:20.793-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "986826",
    "ThreadId": "429614",
    "Html": "\r\n<p>If &quot;active&quot; means &quot;enabled&quot; use <em>getEnabled</em> attribute to specify delegate which determines if toggleButton should be enabled.</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">togglebutton</span> <span style=\"color:red\">id</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">toggleButton1</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">getEnabled</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">getEnabledMethod</span><span style=\"color:black\">&quot;</span>  <span style=\"color:blue\">/&gt;</span>\r\n</pre>\r\n</div>\r\n<p>If &quot;active&quot; means &quot;pressed&quot; then use <em>getPressed</em> attribute&nbsp;to specify delegate which determines if toggleButton should be pressed.</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">toggleButton</span> <span style=\"color:red\">id</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">toggleButton1</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">getPressed</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">getPressedMethod</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\r\n</pre>\r\n</div>\r\n",
    "PostedDate": "2013-01-14T20:13:49.38-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "987340",
    "ThreadId": "429614",
    "Html": "\r\n<p>&quot;Active&quot; means &quot;pressed&quot; in this case. Sorry for not being clear enough.</p>\r\n<p>But what I actually want to do is:</p>\r\n<p></p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> _application_PresentationBeforeCloseEvent(<span style=\"color:blue\">ByVal</span> Pres <span style=\"color:blue\">As</span> NetOffice.PowerPointApi.Presentation, <span style=\"color:blue\">ByRef</span> Cancel <span style=\"color:blue\">As</span> <span style=\"color:blue\">Boolean</span>) <span style=\"color:blue\">Handles</span> _application.PresentationBeforeCloseEvent\r\n    <span style=\"color:blue\">Dim</span> ribbonbutton <span style=\"color:blue\">As</span> <span style=\"color:green\">' class that represents a toggleButton</span>\r\n    ribbonbutton = <span style=\"color:green\">' way to get actual toggleButton in Ribbon</span>\r\n    <span style=\"color:blue\">If</span> ribbonbutton.Pressed = <span style=\"color:blue\">True</span> <span style=\"color:blue\">Then</span>\r\n        ribbonbutton.Pressed = <span style=\"color:blue\">False</span>\r\n    <span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n</pre>\r\n</div>\r\n<p></p>\r\n<p>Is there a way to do this?</p>\r\n",
    "PostedDate": "2013-01-15T16:07:14.947-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "987721",
    "ThreadId": "429614",
    "Html": "\r\n<p>In your ribbon markup you specify</p>\r\n<ol>\r\n<li>method which gets ribbon reference. </li><li>method which returns <em>pressed</em> property value for the toggle button </li><li>method which called when toggle button is pressed </li></ol>\r\n<div style=\"color:black; background-color:white\">\r\n<pre><div style=\"color:black; background-color:white\"><pre><span style=\"color:blue\">&lt;?</span><span style=\"color:#a31515\">xml</span> <span style=\"color:red\">version</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">1.0</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">encoding</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">utf-8</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">?&gt;</span>\r\n<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">customUI</span> <span style=\"color:red\">xmlns</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">http://schemas.microsoft.com/office/2006/01/customui</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">onLoad</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">RibbonLoaded</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">ribbon</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tabs</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">tab</span> <span style=\"color:red\">id</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">PowerPointRibbon</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">label</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">PowerPointRibbon</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n        <span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">group</span> <span style=\"color:red\">id</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">group1</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">label</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Example</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">&gt;</span>\r\n        \t<span style=\"color:blue\">&lt;</span><span style=\"color:#a31515\">toggleButton</span> <span style=\"color:red\">id</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">toggleButton1</span><span style=\"color:black\">&quot;</span>  <span style=\"color:red\">label</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">Toggle Button</span><span style=\"color:black\">&quot;</span>  <span style=\"color:red\">size</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">large</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">onAction</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">OnAction</span><span style=\"color:black\">&quot;</span> <span style=\"color:red\">getPressed</span><span style=\"color:blue\">=</span><span style=\"color:black\">&quot;</span><span style=\"color:blue\">GetPressed</span><span style=\"color:black\">&quot;</span> <span style=\"color:blue\">/&gt;</span>\r\n        <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">group</span><span style=\"color:blue\">&gt;</span>\r\n      <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">tab</span><span style=\"color:blue\">&gt;</span>\r\n    <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">tabs</span><span style=\"color:blue\">&gt;</span>\r\n  <span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">ribbon</span><span style=\"color:blue\">&gt;</span>\r\n<span style=\"color:blue\">&lt;/</span><span style=\"color:#a31515\">customUI</span><span style=\"color:blue\">&gt;</span>\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n<p>In your addin&nbsp;write code for</p>\r\n<ol>\r\n<li>class member which holds toggle button state </li><li>class member which holds ribbon reference </li><li>method which gets ribbon reference </li><li>method which updates toggle button state </li><li>method which returns <em>pressed</em> property value for the toggle button </li><li>application event handler which sets toggle button state and invalidates the toggle button\r\n</li></ol>\r\n<div style=\"color:black; background-color:white\">\r\n<div style=\"color:black; background-color:white\">\r\n<pre><div style=\"color:black; background-color:white\"><pre><span style=\"color:blue\">Private</span> togglePressed <span style=\"color:blue\">As</span> <span style=\"color:blue\">Boolean</span>\r\n<span style=\"color:blue\">Dim</span> _ribbon <span style=\"color:blue\">As</span> Office.IRibbonUI\r\n\r\n<span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> RibbonLoaded(ribbon <span style=\"color:blue\">As</span> Office.IRibbonUI)\r\n\t_ribbon = ribbon\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n\r\n<span style=\"color:blue\">Public</span> <span style=\"color:blue\">Sub</span> OnAction(<span style=\"color:blue\">ByVal</span> control <span style=\"color:blue\">As</span> Office.IRibbonControl)\r\n            <span style=\"color:blue\">Select</span> <span style=\"color:blue\">Case</span> control.Id\r\n                 <span style=\"color:blue\">Case</span> <span style=\"color:#a31515\">&quot;toggleButton1&quot;</span>\r\n                    togglePressed = <span style=\"color:blue\">Not</span> togglePressed\r\n                <span style=\"color:blue\">Case</span> <span style=\"color:blue\">Else</span>\r\n                    MessageBox.Show(<span style=\"color:#a31515\">&quot;Unkown Control Id: &quot;</span> + control.Id)\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">Select</span>\r\n     <span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n    \r\n<span style=\"color:blue\">Public</span> <span style=\"color:blue\">Function</span> GetPressed(<span style=\"color:blue\">ByVal</span> control <span style=\"color:blue\">As</span> Office.IRibbonControl) <span style=\"color:blue\">As</span> <span style=\"color:blue\">Boolean</span>\r\n            <span style=\"color:blue\">Select</span> <span style=\"color:blue\">Case</span> control.Id\r\n                <span style=\"color:blue\">Case</span> <span style=\"color:#a31515\">&quot;toggleButton1&quot;</span>\r\n                \t<span style=\"color:blue\">return</span> togglePressed\r\n                <span style=\"color:blue\">Case</span> <span style=\"color:blue\">Else</span>\r\n                    MessageBox.Show(<span style=\"color:#a31515\">&quot;Unkown Control Id: &quot;</span> + control.Id)\r\n            <span style=\"color:blue\">End</span> <span style=\"color:blue\">Select</span>\r\n\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span>\r\n\r\n<span style=\"color:blue\">Private</span> <span style=\"color:blue\">Sub</span> _application_PresentationBeforeCloseEvent(<span style=\"color:blue\">ByVal</span> Pres <span style=\"color:blue\">As</span> PowerPoint.Presentation, _\r\n\t<span style=\"color:blue\">ByRef</span> Cancel <span style=\"color:blue\">As</span> <span style=\"color:blue\">Boolean</span>) <span style=\"color:blue\">Handles</span> _application.PresentationBeforeCloseEvent\r\n\t\r\n\t<span style=\"color:blue\">If</span> togglePressed <span style=\"color:blue\">Then</span>\r\n\t\ttogglePressed = <span style=\"color:blue\">Not</span> togglePressed\r\n\t<span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span>\r\n\t_ribbon.InvalidateControl(<span style=\"color:#a31515\">&quot;toggleButton1&quot;</span>)\r\n<span style=\"color:blue\">End</span> <span style=\"color:blue\">Sub</span>\r\n</pre>\r\n</div>\r\n</pre>\r\n</div>\r\n</div>\r\n",
    "PostedDate": "2013-01-16T11:00:33.623-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "987722",
    "ThreadId": "429614",
    "Html": "\r\n<p>And just for curiosity: what is your secret toggle button purpose?</p>\r\n",
    "PostedDate": "2013-01-16T11:03:48.07-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "988737",
    "ThreadId": "429614",
    "Html": "\r\n<p>To enable interaction with another device. No, really. With any luck, you'll see it in the wild in a couple months.</p>\r\n<p>Also, your suggestion worked like a charm, thank you.</p>\r\n",
    "PostedDate": "2013-01-18T07:11:42.317-08:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]