

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="" prefix="og: http://ogp.me/ns# profile: http://ogp.me/ns/profile#">
    
    
    
    

    
    <head>
        <meta id="CompatabilityMode" http-equiv="X-UA-Compatible" content="IE=edge" />
	    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="http://download-codeplex.sec.s-msft.com/css/v21066/i1970439/StyleSheet.ashx" id="MasterCss" rel="stylesheet" type="text/css" />
        <link rel="SHORTCUT ICON" href="http://www.codeplex.com/favicon.ico" />
        <title>NetOffice - MS Office in .NET - Excel VBA &#47; DAO object model compatibility </title>
        
       
                    <script src="https://uhf.microsoft.com/mscc/statics/mscc-0.3.7.min.js"></script>
        
                    <link rel="stylesheet" type="text/css" href="https://uhf.microsoft.com/mscc/statics/mscc-0.3.7.min.css" />
        
            <script type="text/javascript">
                var msccHadCookieBannerAtPageStart = true;
            </script>
        

        <!--
        Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code,
        not by Microsoft.  See ASP.NET Ajax CDN Terms of Use â€“ http://www.asp.net/ajaxlibrary/CDN.ashx.
        -->
        <script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.4.4.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery === 'undefined') {
                document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        <script src="http://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.6/jquery-ui.min.js" type="text/javascript"></script>
        
        <script type="text/javascript">
            if (typeof jQuery.ui === 'undefined') {
                document.write(unescape("%3Cscript src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
        </script>

        
    <style type="text/css">.SideBar, .SideBarPadding{display:none;}.MainContent{width:auto;}.SiteContentTable{width:100%;}</style>
    <style id="ProjectStyles" type="text/css">
        .SiteHeader, .SiteHeaderLeft {
            height:45px !important;
            overflow:hidden;
        }
        .SiteContent 
        {
            padding: 0 0 1em 0;
            margin-top:0;
            min-height:225px;
            border-right: 1px solid lightgrey;
            border-left: 1px solid lightgrey;
            border-bottom: 1px solid lightgrey;
        }
        .IE table.MinWidthContent
        {
	        table-layout: auto !important;	
        }
    </style>
    
    
    <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">

    
    
    <meta id="WTProjectName" name="WT.pi" content="netoffice"/>
    

    <link rel="EditURI" type="application/rsd+xml" title="RSD" href='http://netoffice.codeplex.com/rsd' />
    <link rel="wlwmanifest" type="application/wlwmanifest+xml" title="WLWManifest" href='/wlwmanifest.xml' />
    
    
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET" url="http://netoffice.codeplex.com/project/feeds/rss"/>
    
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Discussions" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2fnetoffice"/>
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Issues" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2fnetoffice"/>
        
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Downloads" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2fnetoffice"/>
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Reviews" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2fnetoffice"/>
        
    
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Source&#32;code" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2fnetoffice"/>
        <link rel="alternate" type="application/rss+xml" title="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET&#32;-&#32;Wiki" url="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2fnetoffice"/>
    
        
    
        <meta content="summary" name="twitter:card" /><meta content="@CodePlex" name="twitter:site" /><meta content="http://netoffice.codeplex.com/discussions/285400?ProjectName=netoffice" name="twitter:url" /><meta content="NetOffice - MS Office in .NET" name="twitter:title" /><meta content=".NET wrapper assemblies for version independent using Microsoft Office, Excel, Word, Outlook, PowerPoint, Access, Project, Visio, Publisher" name="twitter:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" name="twitter:image" /><meta content="CodePlex" property="og:site_name" /><meta content="http://netoffice.codeplex.com/discussions/285400?ProjectName=netoffice" property="og:url" /><meta content="object" property="og:type" /><meta content="NetOffice - MS Office in .NET" property="og:title" /><meta content=".NET wrapper assemblies for version independent using Microsoft Office, Excel, Word, Outlook, PowerPoint, Access, Project, Visio, Publisher" property="og:description" /><meta content="http://www.codeplex.com/Images/codeplex.png" property="og:image" />
        

    </head>
    
    <body>
         
            <div><div id='msccBanner' dir='ltr' data-site-name='CodePlex' data-mscc-version='0.3.6' data-nver='aspnet-2.0.5' data-sver='0.1.2' class='cc-banner' role='alert'><div class='cc-container'><svg class='cc-icon cc-v-center' x='0px' y='0px' viewBox='0 0 44 44' height='30px' fill='none' stroke='currentColor'><circle cx='22' cy='22' r='20' stroke-width='2'></circle><line x1='22' x2='22' y1='18' y2='33' stroke-width='3'></line><line x1='22' x2='22' y1='12' y2='15' stroke-width='3'></line></svg> <span class='cc-v-center cc-text'>This site uses cookies for analytics, personalized content and ads. By continuing to browse this site, you agree to this use.</span> <a href='https://go.microsoft.com/fwlink/?linkid=845480' aria-label='Learn more about Microsoft&#39;s Cookie Policy' id='msccLearnMore' class='cc-link cc-v-center cc-float-right' data-mscc-ic='false'>Learn more</a></div></div></div>
        <script src="http://download-codeplex.sec.s-msft.com/scripts/v21066/i5/ScriptLoader.ashx" type="text/javascript"></script>
        <form id="aspnetForm" autocomplete="off" method="POST" enctype="multipart/form-data">
            <input name="__RequestVerificationToken" type="hidden" value="gw2a5DS5SitOMt6OufgrId5XGyTPi2r5g8AIRFdltDbYb8T5sh-F9Kj1iveMTSfuwZ-N2pUbrKiYA8aRq0UGzIU9ItVnaQ6MI5uWdo-f1DA25_UhgK6gpfRD23tzPBCotwFHRg2" /><input name="__RequestVerificationToken2" type="hidden" value="__RequestVerificationToken2fa0d4661-950a-4576-8377-7b305aef1ee8" />
            
            <div id="UpdateProgressPanel" class="loading_animation" style="display:none;">
                <div class="row">
                    <h2 class="anim_h2">
                        <span id="UpdateProgressText">Updating...</span>
                        <span id="animatedLoadingIconContainer">
                            <img id="animatedLoadingIcon" src="http://download-codeplex.sec.s-msft.com/Images/v21066/loading_animation.gif" class="anim_img"/>
                        </span>
                    </h2>
                </div>
            </div>
            
            <div style="display:none;">
                
                <img id="BlankImage" style="width:0;height:0;" src="http://download-codeplex.sec.s-msft.com/Images/v21066/blank.png" onload="self.logoImageLoaded=true;"/>

                <script language="javascript" type="text/javascript">
                    var date = new Date();
                    var timezoneOffset = date.getTimezoneOffset() / 60 * -1;
                    var timezoneOffsetCookie = getCookie("TimezoneOffset");
                    var firstTimeSetTimezoneCookie = false;

                    if (timezoneOffsetCookie == null || timezoneOffsetCookie != timezoneOffset) {
                        firstTimeSetTimezoneCookie = true;
                        document.cookie = "TimezoneOffset=" + timezoneOffset + '; domain=.codeplex.com;expires=Thu, 3 Jan 2019 10:52:35 UTC';
                    }
                </script>
            </div>
            
            
            <div id="banner">
                <div id="message">
                    <strong>CodePlex is going read-only starting November 27th.  </strong><a href="https://aka.ms/codeplex-readonly">Learn more and find next steps.</a>
                </div>
            </div>
            

            <div id="header">
                <div id="header_wrap" class="row">
                    <p id="logo"><a href="http://www.codeplex.com">Code<span class="semi">Plex</span></a><span id="tagline">Project Hosting for Open Source Software</span></p>
                    

<ul id="nav">

    <li><a href="/site/register/new" id="registerLink" class="ZoomFix">Register</a></li>
    <li ><a class="SignInLink" href="https://www.codeplex.com/site/login?RedirectUrl=http%3a%2f%2fnetoffice.codeplex.com%2fdiscussions%2f285400" id="signInLink">Sign In</a></li>
  
    <li class="last"><a class="rss_site_icon" href="http://www.codeplex.com/site/feeds/rss" type="application/rss+xml" rel="Alternate" title="CodePlex Site Activity"></a></li>
</ul>
                    <input id="searchsite" name="searchsite" maxlength="500" type="text" value="" /><span id="search_mag"><a id="submitSearch" name="submitSearch" class="magnify" title="Search" href="#"></a></span>
                    <script>
	$(document).ready(function() {
    var searchButton = $('#submitSearch'),
        searchBar = $('#searchsite');

    // Register our own handler for the search event while we wait for the SearchBox script to load.
    searchButton.bind('click.backupSearchBox', doProjectSearch);
    searchBar.bind('keypress.backupSearchBox', function(e) { if ($keyCode(e) === 13) { doProjectSearch(); return false; } });

    function cleanupSearchEvents() {
        // If the SearchBox was loaded, unregister our handlers.
        if (epx_loaded) {
            searchButton.unbind('.backupSearchBox');
            searchBar.unbind('.backupSearchBox');
        }
    }

    $loadScript('http://i4.services.social.microsoft.com/search/Widgets/SearchBox.jss?appid=1000&scopeid=1&boxId=searchsite&btnId=submitSearch&watermark=Search%20all%20projects&overrideWatermark=true&searchLocation=%2fsite%2fsearch&allowEmptySearch=true&focusOnInit=False&minimumTermLength=3', cleanupSearchEvents);
})
function doProjectSearch() {
    
    var url = '/site/search';

    //If search term is not same as watermark
    if($('#searchsite').val() != 'Search all projects')    
    {        
        url = url + '?query=' + encodeURIComponent($('#searchsite').val());
    }

    
    var callback = '';
    if (callback.length > 0 && eval('typeof ' + callback) != 'undefined')
        url += eval(callback + '()');

    window.location.href = url;
    return false;
}
</script>
                </div>
            </div>
            
            <div id="wrap">
                
    <div id="sub_heading" class="row">
        
        <div id="ProjectHeader">
            <div id="project_title_row" class="row">
                <div id="project_logo">
                    
    
    <div id="project_logo_and_text">
        <div class="logo_left">
            <a href="http://netoffice.codeplex.com/"><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=netoffice&DownloadId=236782&Build=21066" alt="NetOffice&#32;-&#32;MS&#32;Office&#32;in&#32;.NET" /></a>
        </div>
        <h1 class="text_right"><div><a href="http://netoffice.codeplex.com/" id="ProjectTitle4">NetOffice - MS Office in .NET</a></div></h1>
    </div>

                </div>
            </div>
        </div>
        
        <div id="ProjectDetailsDiv">
            
        </div>
		<div class="clear"></div>
        
                <div id="ProjectMigrationBanner" class="ProjectRedOnly""><strong>This project has moved and is read-only.  For the latest updates, please </strong><a href="https&#58;&#47;&#47;osdn.net&#47;projects&#47;netoffice">go here</a>.</div>
            

<ul id="page_box_links">
	<li id="homeTabCell" style="width: 63px;"><a id="homeTab" href="http://netoffice.codeplex.com/" class="box_home">home</a><div></div></li>
    
	<li id="sourceTabCell" style="width:113px;"><a id="sourceTab" href="http://netoffice.codeplex.com/SourceControl/latest" class="box_source">source code</a><div></div></li>
    
	<li id="releasesTabCell" style="width:105px;"><a id="releasesTab" href="http://netoffice.codeplex.com/releases" class="box_downloads">downloads</a><div></div></li>
    
    <li id="documentationTabCell" style="width:143px;"><a id="documentationTab" href="http://netoffice.codeplex.com/documentation" class="box_documentation">documentation</a><div></div></li>
    
	<li id="discussionTabCell" style="width:112px;"><a id="discussionTab" href="http://netoffice.codeplex.com/discussions" class="discussions_active">discussions</a><div></div></li>
    
	<li id="workItemsTabCell" style="width:70px;"><a id="workItemsTab" href="http://netoffice.codeplex.com/workitem/list/basic" class="box_issue">issues</a><div></div></li>
    
	<li id="peopleTabCell" style="width:70px;"><a id="peopleTab" href="http://netoffice.codeplex.com/team/view" class="box_people">people</a><div></div></li>
	<li id="licenseTabCell" style="width:70px;"><a id="licenseTab" href="http://netoffice.codeplex.com/license" class="box_license">license</a><div></div></li>
    
    <span class="stretch"></span>
</ul>

<script type="text/javascript">
    $(document).ready(function () {
        $('#page_box_links').applyLastClassToList();
    });
</script>
		    <div class="clear"></div>
            
     <td>
       

<div>
    
    <div id="actionBar" class="action_bar">
        <ul id="actionBar_ul" class="actionBar_sublinks subtab_right" style="vertical-align: middle;">

            

                <li id="li_actionbar_subscribe" data-action-id="actionbar_subscribe" data-action-type="PopUp" class="actionBar_sublinks" data-options-id="940c7c29-91fb-4306-977f-bdf689315862">
                
                    <script class="options" defer="defer" id="940c7c29-91fb-4306-977f-bdf689315862" type="application/json">{}</script> 
                    
                    <div class="actionBar_custom_content">

<div id="rssHoverDiv" class="HoverPanel LeftHoverWidth" style="display: none">
        <ul id="3_FeedsPanel" class="RssFeedsPanel">
            <li>
                <a id="ProjectRssLink" href="http://netoffice.codeplex.com/project/feeds/rss" class="ArrowSmall NoUnderline">All Project Updates</a>
            </li>
            
            <li>
                <a id="DiscussionRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fforum%2fnetoffice" class="ArrowSmall NoUnderline">Discussions</a>
            </li>
            
            <li>
                <a id="IssueTrackerRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fworkitem%2fnetoffice" class="ArrowSmall NoUnderline">Issue Tracker</a>
            </li>
            
            <li>
                <a id="ReleasesRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2frelease%2fnetoffice" class="ArrowSmall NoUnderline">Downloads</a>
            </li>
            <li>
                <a id="ReviewsRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2freview%2fnetoffice" class="ArrowSmall NoUnderline">Reviews</a>
            </li>
            
            <li>
                <a id="SourceControlRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fsourcecontrol%2fnetoffice" class="ArrowSmall NoUnderline">Source Code</a>
            </li>
            <li>
                <a id="WikiRssLink" href="http://netoffice.codeplex.com/project/feeds/rss?ProjectRSSFeed=codeplex%3a%2f%2fwiki%2fnetoffice" class="ArrowSmall NoUnderline">Wiki &amp; Documentation</a>
            </li>
        </ul>
</div></div>

                    <a href="#" id="actionbar_subscribe" title="Subscribe to project updates in RSS feeds." class="action_bar_item_link">
                        <img id="img_actionbar_subscribe" class="action_bar_item_image" src="http://download-codeplex.sec.s-msft.com/Images/v21066/actionbar_subscribe.png" style="vertical-align: middle" />
                        Subscribe
                    </a>

                </li>

            
        </ul>
    </div>
</div>
     </td>

        

    </div>
    
    
<div class="Threads">
    <div class="ViewThread">
        
        
        
            <h1 class="page_title WordWrapBreakWord">
                Excel VBA &#47; DAO object model compatibility 
            </h1>

            <!-- Private Discussion header -->
            

            <!-- Posts List Header: Topics and Wiki Link -->
            <table class="PostsListHeader">
                <tr>
                    <td>
                     
                    </td>
                    <td>
                        <div class="WikiLink">
                            <span title="Paste this into a wiki page to link to this discussion">
                                Wiki Link: [discussion:285400]
                            </span>
                        </div>
                    </td>
                </tr>
            </table>

            <!-- The list of posts -->
            

<div id="discussionsPostList" data-options-id="bc1cfb8b-8c9a-4b2a-b246-fb2b211606bb">
    <script class="options" defer="defer" id="bc1cfb8b-8c9a-4b2a-b246-fb2b211606bb" type="application/json">{"threadUrl":"http://netoffice.codeplex.com/discussions/285400","showEditor":false,"checkImageUrl":"http://download-codeplex.sec.s-msft.com/Images/v21066/check_answer.png"}</script>

    <div class="Posts" style="margin-top: 10px;">
    

<table cellpadding="0" cellspacing="0" style="width: 100%; margin-bottom: 0px; table-layout:fixed">
    

<tr id="PostPanel" class="Post" d:forid="722197">
    <td id="PostDetailsCell_722197" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post722197"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/govert">govert</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="1/8/2012 11:46:57 PM" LocalTimeTicks="1326095217">Jan 8, 2012 at 11:46 PM</span></div>
            
        </div>
    </td>
    <td id="PostContent_722197" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="&#32;Hi&#32;Sebastian,&#32;We&#32;had&#32;a&#32;go&#32;last&#32;on&#32;Friday&#32;at&#32;porting&#32;a&#32;small&#32;VBA&#32;add-in&#32;that&#32;also&#32;uses&#32;DAO&#32;for&#32;data&#32;access&#32;to&#32;VB.NET&#32;with&#32;Excel-DNA&#32;and&#32;the&#32;NetOffice&#32;assemblies.&#32;It&#32;went&#32;pretty&#32;well,&#32;with&#32;no&#32;nasty&#32;surprises.&#32;We&#32;have&#32;some&#32;questions&#32;&#40;we&#32;were&#32;using&#32;NetOffice&#32;version&#32;1.3,&#32;not&#32;the&#32;latest&#32;sources&#41;&#58;&#32;&#42;&#32;The&#32;Recordset.Update&#32;method&#32;in&#32;DAO&#32;takes&#32;two&#32;optional&#32;parameters.&#32;In&#32;the&#32;corresponding&#32;NetOffice&#32;method&#32;the&#32;parameters&#32;are&#32;required.&#32;&#40;http&#58;&#47;&#47;msdn.microsoft.com&#47;en-us&#47;library&#47;bb221108&#40;v&#61;office.12&#41;.aspx&#41;.&#32;&#42;&#32;In&#32;Excel,&#32;the&#32;Worksheet.Range&#32;property&#32;is&#32;an&#32;indexed&#32;property&#32;which&#32;NetOffice&#32;exposes&#32;only&#32;as&#32;Worksheet.get_Range.&#32;I&#32;know&#32;that&#32;C&#35;&#32;had&#32;issues&#32;with&#32;indexed&#32;properties&#32;before&#32;C&#35;&#32;4,&#32;but&#32;there&#32;should&#32;be&#32;no&#32;issue&#32;from&#32;VB.NET.&#32;For&#32;example&#32;Range.Value&#32;seems&#32;to&#32;work&#32;right.&#32;&#42;&#32;In&#32;VBA&#32;the&#32;DAO&#32;library&#32;brings&#32;a&#32;bunch&#32;of&#32;methods&#32;and&#32;constants&#32;into&#32;the&#32;global&#32;namespace,&#32;for&#32;example&#32;an&#32;OpenDatabase&#32;method.&#32;You&#32;can&#32;see&#32;these&#32;from&#32;the&#32;VBA&#32;Object&#32;Browser&#32;when&#32;selecting&#32;the&#32;DAO&#32;library&#32;and&#32;looking&#32;at&#32;&#38;lt&#59;globals&#38;gt&#59;.&#32;This&#32;allows&#32;one&#32;to&#32;call&#32;OpenDatabase&#32;directly&#32;from&#32;the&#32;VBA&#32;code,&#32;without&#32;having&#32;an&#32;object&#32;reference.&#32;In&#32;VB.NET&#32;you&#32;can&#32;do&#32;the&#32;same&#32;with&#32;static&#32;methods&#32;-&#32;by&#32;&#39;Importing&#39;&#32;a&#32;.NET&#32;type&#32;&#40;instead&#32;of&#32;a&#32;namespace&#41;,&#32;the&#32;static&#32;methods&#32;of&#32;that&#32;type&#32;become&#32;accessible&#32;in&#32;VB.NET&#32;without&#32;needing&#32;the&#32;type&#32;qualifier.&#32;So&#32;a&#32;static&#32;method&#32;&#39;OpenRecordset&#39;&#32;on&#32;some&#32;DAO.Globals&#32;class&#32;would&#32;be&#32;directly&#32;available&#32;as&#32;from&#32;VBA.&#32;Do&#32;you&#32;think&#32;it&#32;would&#32;be&#32;possible&#32;to&#32;make&#32;these&#32;&#38;lt&#59;globals&#38;gt&#59;&#32;exported&#32;from&#32;a&#32;NetOffice&#32;type&#32;which&#32;could&#32;bring&#32;them&#32;in&#32;directly&#32;into&#32;VB.NET&#63;&#32;I&#39;m&#32;not&#32;sure&#32;how&#32;the&#32;COM&#32;coclass&#32;&#47;&#32;interface&#32;story&#32;works&#32;in&#32;the&#32;back.&#38;nbsp&#59;The&#32;Excel&#32;API&#32;has&#32;the&#32;same&#32;story,&#32;with&#32;a&#32;&#38;lt&#59;globals&#38;gt&#59;&#32;section&#32;containing&#32;ActiveSheet,&#32;ActiveCell&#32;etc.&#32;&#42;&#32;One&#32;trick&#32;was&#32;that&#32;to&#32;instantiate&#32;the&#32;DAO&#32;DBEngine&#32;object,&#32;we&#32;couldn&#39;t&#32;just&#32;use&#32;&#39;New&#32;DBEngine&#40;&#41;&#39;&#32;but&#32;actually&#32;had&#32;to&#32;add&#32;the&#32;ProgId&#58;&#32;&#39;New&#32;DBEngine&#40;&#38;quot&#59;DAO.DBEngine.36&#38;quot&#59;&#41;&#39;.&#32;I&#32;think&#32;this&#32;has&#32;to&#32;do&#32;with&#32;DAO&#32;not&#32;registering&#32;a&#32;version-independent&#32;ProgId.&#32;&#42;&#32;I&#32;know&#32;.NET&#32;does&#32;not&#32;support&#32;&#39;default&#32;properties&#39;,&#32;but&#32;in&#32;some&#32;cases&#32;it&#32;might&#32;make&#32;for&#32;very&#32;nice&#32;compatibility&#32;with&#32;VBA&#32;if&#32;one&#32;can&#32;simulate&#32;the&#32;default&#32;collections&#32;and&#32;their&#32;indexers.&#32;For&#32;example,&#32;on&#32;a&#32;DAO&#32;recordset&#32;one&#32;can&#32;say&#58;&#32;myRs&#33;MyField&#32;&#61;&#32;&#38;quot&#59;New&#32;Value&#38;quot&#59;.&#32;which&#32;actually&#32;means&#32;myRS.Fields&#33;MyField.Value&#32;&#61;&#32;&#38;quot&#59;New&#32;Value&#38;quot&#59;&#32;-&#32;or&#32;equivalently&#32;&#38;nbsp&#59;myRs.Fields&#40;&#38;quot&#59;MyField&#38;quot&#59;&#41;.Value&#32;&#61;&#32;&#38;quot&#59;New&#32;Value&#38;quot&#59;&#32;Note&#32;that&#32;VB.NET&#32;still&#32;supports&#32;the&#32;&#38;quot&#59;&#33;&#38;quot&#59;&#32;indexed&#32;property&#32;dereferencing.&#32;I&#32;was&#32;wondering&#32;if&#32;it&#32;would&#32;make&#32;sense&#32;to&#32;generate&#32;an&#32;indexed&#32;property&#32;for&#32;the&#32;Recordset&#32;which&#32;shortcuts&#32;to&#32;the&#32;default&#32;collection&#39;s&#32;indexed&#32;property.&#32;Then&#32;one&#32;could&#32;at&#32;least&#32;write&#58;&#32;myRS&#33;MyField.Value&#32;&#61;&#32;&#38;quot&#59;New&#32;Value&#38;quot&#59;.&#32;&#40;This&#32;is&#32;not&#32;a&#32;suggestion&#32;yet&#32;-&#32;just&#32;a&#32;thought&#32;on&#32;what&#32;might&#32;be&#32;possible.&#32;I&#32;think&#32;rewriting&#32;the&#32;VBA&#32;&#47;&#32;VB.NET&#32;to&#32;add&#32;the&#32;default&#32;properties&#32;explicitly&#32;is&#32;fine,&#32;and&#32;is&#32;cool&#32;since&#32;it&#32;is&#32;compatible&#32;with&#32;with&#32;both&#32;VBA&#32;and&#32;VB.NET.&#32;&#41;&#32;&#38;nbsp&#59;&#32;We&#32;packed&#32;the&#32;Excel-DNA&#32;&#47;&#32;NetOffice&#32;add-in&#32;with&#32;the&#32;new&#32;VB.NET&#32;assembly&#32;into&#32;a&#32;single-file&#32;.xll&#32;using&#32;ExcelDnaPack.exe.&#32;With&#32;the&#32;various&#32;NetOffice&#32;assemblies&#32;for&#32;Excel&#32;and&#32;the&#32;DaoApi.dll,&#32;the&#32;resulting&#32;packed&#32;.xll&#32;was&#32;about&#32;750&#32;KB.&#32;&#38;nbsp&#59;&#32;As&#32;a&#32;general&#32;thought,&#32;I&#32;was&#32;thinking&#32;that&#32;the&#32;initial&#32;goal&#32;for&#32;NetOffice&#32;was&#32;probably&#32;compatibility&#32;with&#32;the&#32;Primary&#32;Interop&#32;Assemblies.&#32;But&#32;from&#32;my&#32;point&#32;of&#32;view,&#32;having&#32;NetOffice&#32;make&#32;the&#32;VBA&#32;-&#38;gt&#59;&#32;VB.NET&#32;porting&#32;experience&#32;better&#32;is&#32;even&#32;more&#32;valuable.&#32;And&#32;these&#32;are&#32;not&#32;necessarily&#32;the&#32;same&#32;goals.&#32;&#38;nbsp&#59;&#32;Thanks&#32;again&#32;for&#32;the&#32;great&#32;project&#33;&#32;-Govert&#38;nbsp&#59;&#32;">
        
<p>Hi Sebastian,</p>
<p>We had a go last on Friday at porting a small VBA add-in that also uses DAO for data access to VB.NET with Excel-DNA and the NetOffice assemblies. It went pretty well, with no nasty surprises.</p>
<p>We have some questions (we were using NetOffice version 1.3, not the latest sources):</p>
<p>* The Recordset.Update method in DAO takes two optional parameters. In the corresponding NetOffice method the parameters are required. (<a href="http://msdn.microsoft.com/en-us/library/bb221108(v=office.12).aspx" rel="nofollow">http://msdn.microsoft.com/en-us/library/bb221108(v=office.12).aspx</a>).</p>
<p>* In Excel, the Worksheet.Range property is an indexed property which NetOffice exposes only as Worksheet.get_Range. I know that C# had issues with indexed properties before C# 4, but there should be no issue from VB.NET. For example Range.Value seems to
 work right.</p>
<p>* In VBA the DAO library brings a bunch of methods and constants into the global namespace, for example an OpenDatabase method. You can see these from the VBA Object Browser when selecting the DAO library and looking at &lt;globals&gt;. This allows one to
 call OpenDatabase directly from the VBA code, without having an object reference. In VB.NET you can do the same with static methods - by 'Importing' a .NET type (instead of a namespace), the static methods of that type become accessible in VB.NET without needing
 the type qualifier. So a static method 'OpenRecordset' on some DAO.Globals class would be directly available as from VBA.</p>
<p>Do you think it would be possible to make these &lt;globals&gt; exported from a NetOffice type which could bring them in directly into VB.NET? I'm not sure how the COM coclass / interface story works in the back.&nbsp;The Excel API has the same story, with
 a &lt;globals&gt; section containing ActiveSheet, ActiveCell etc.</p>
<p>* One trick was that to instantiate the DAO DBEngine object, we couldn't just use 'New DBEngine()' but actually had to add the ProgId: 'New DBEngine(&quot;DAO.DBEngine.36&quot;)'. I think this has to do with DAO not registering a version-independent ProgId.</p>
<p>* I know .NET does not support 'default properties', but in some cases it might make for very nice compatibility with VBA if one can simulate the default collections and their indexers. For example, on a DAO recordset one can say:</p>
<p>myRs!MyField = &quot;New Value&quot;.</p>
<p>which actually means</p>
<p>myRS.Fields!MyField.Value = &quot;New Value&quot; - or equivalently &nbsp;myRs.Fields(&quot;MyField&quot;).Value = &quot;New Value&quot;</p>
<p>Note that VB.NET still supports the &quot;!&quot; indexed property dereferencing.</p>
<p>I was wondering if it would make sense to generate an indexed property for the Recordset which shortcuts to the default collection's indexed property. Then one could at least write:</p>
<p>myRS!MyField.Value = &quot;New Value&quot;.</p>
<p>(This is not a suggestion yet - just a thought on what might be possible. I think rewriting the VBA / VB.NET to add the default properties explicitly is fine, and is cool since it is compatible with with both VBA and VB.NET. )</p>
<p>&nbsp;</p>
<p>We packed the Excel-DNA / NetOffice add-in with the new VB.NET assembly into a single-file .xll using ExcelDnaPack.exe. With the various NetOffice assemblies for Excel and the DaoApi.dll, the resulting packed .xll was about 750 KB.</p>
<p>&nbsp;</p>
<p>As a general thought, I was thinking that the initial goal for NetOffice was probably compatibility with the Primary Interop Assemblies. But from my point of view, having NetOffice make the VBA -&gt; VB.NET porting experience better is even more valuable.
 And these are not necessarily the same goals.</p>
<p>&nbsp;</p>
<p>Thanks again for the great project!</p>
<p>-Govert&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_722197" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="722206">
    <td id="PostDetailsCell_722206" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post722206"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="1/9/2012 12:50:41 AM" LocalTimeTicks="1326099041">Jan 9, 2012 at 12:50 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_722206" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Hello&#32;Govert,&#32;Yes&#32;i&#32;see&#32;these&#32;2&#32;parameters&#32;are&#32;optional,&#32;i&#32;have&#32;no&#32;idea&#32;at&#32;the&#32;moment&#32;why&#32;its&#32;not&#32;optional&#32;in&#32;NetOffice.i&#32;need&#32;a&#32;day&#32;to&#32;see&#32;what&#32;happens.&#32;worksheet&#32;has&#32;no&#32;enumerator,&#32;and&#32;thats&#32;the&#32;reason&#32;for&#32;my&#32;codegenerator&#32;creates&#32;no&#32;default&#32;property&#32;here.i&#32;change&#32;them&#32;and&#32;make&#32;it&#32;better.static&#32;methods&#32;...&#32;shame&#32;on&#32;me,&#32;i&#32;never&#32;think&#32;about&#32;that,&#32;NetOffice&#32;supports&#32;code&#32;moduls&#32;as&#32;static&#32;classes&#32;but&#32;no&#32;other&#32;static&#32;methods.i&#32;need&#32;some&#32;days&#32;to&#32;checkout&#32;the&#32;COM&#32;Type&#32;Libraries&#32;for&#32;that&#32;info&#32;und&#32;how&#32;i&#32;can&#32;perform&#32;a&#32;latebinding&#32;call&#32;without&#32;a&#32;specific&#32;instance.thanks&#32;for&#32;your&#32;very&#32;good&#32;sugestions&#32;goverti&#32;give&#32;you&#32;an&#32;update&#32;when&#32;its&#32;done.&#42;Sebastian&#32;&#38;nbsp&#59;&#32;&#38;nbsp&#59;&#32;&#38;nbsp&#59;&#32;&#38;nbsp&#59;">
        
<p>Hello Govert,</p>
<p>Yes i see these 2 parameters are optional, i have no idea at the moment why its not optional in NetOffice.<br>
i need a day to see what happens.</p>
<p>worksheet has no enumerator, and thats the reason for my codegenerator creates no default property here.<br>
i change them and make it better.<br>
<br>
static methods ... shame on me, i never think about that, NetOffice supports code moduls as static classes but no other static methods.<br>
i need some days to checkout the COM Type Libraries for that info und how i can perform a latebinding call without a specific instance.<br>
<br>
thanks for your very good sugestions govert<br>
i give you an update when its done.<br>
<br>
*Sebastian</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_722206" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="722208">
    <td id="PostDetailsCell_722208" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post722208"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="1/9/2012 1:08:10 AM" LocalTimeTicks="1326100090">Jan 9, 2012 at 1:08 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_722208" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="first&#32;update&#58;&#32;the&#32;DAO&#32;COM&#32;Type&#32;Library&#32;tolds&#32;me&#32;these&#32;parameters&#32;are&#32;not&#32;optional&#32;but&#32;i&#32;see&#32;also&#32;now&#32;these&#32;parameters&#32;has&#32;default&#32;values&#40;1&#32;and&#32;false&#41;&#38;nbsp&#59;and&#32;i&#32;think&#32;thats&#32;the&#32;reason&#32;you&#32;can&#32;use&#32;these&#32;parameters&#32;in&#32;VBA&#32;as&#32;optional.&#32;my&#32;codegenerator&#32;checks&#32;only&#32;for&#32;the&#32;optional&#32;flag&#32;currently&#32;and&#38;nbsp&#59;i&#32;have&#32;to&#32;change&#32;that.&#42;Sebastian">
        
<p>first update:</p>
<p>the DAO COM Type Library tolds me these parameters are not optional but i see also now these parameters has default values(1 and false)&nbsp;and i think thats the reason you can use these parameters in VBA as optional. my codegenerator checks only for the
 optional flag currently and&nbsp;i have to change that.<br>
<br>
*Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_722208" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="722215">
    <td id="PostDetailsCell_722215" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post722215"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="1/9/2012 1:47:47 AM" LocalTimeTicks="1326102467">Jan 9, 2012 at 1:47 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_722215" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="second&#32;update&#58;&#32;&#38;gt&#59;&#38;gt&#59;&#32;In&#32;Excel,&#32;the&#32;Worksheet.Range&#32;property&#32;is&#32;an&#32;indexed&#32;propertyWorksheet&#32;has&#32;no&#32;default&#32;property.&#38;nbsp&#59;&#32;you&#32;can&#32;use&#32;the&#32;ITypeLib&#32;Viewer&#32;also&#32;know&#32;as&#32;OLE&#47;COM&#32;Object&#32;Viewer&#32;and&#32;see&#32;Worksheet&#32;has&#32;no&#32;_Default&#32;member.i&#32;change&#32;that&#32;at&#32;hand&#32;in&#32;my&#32;xml&#32;source&#32;file&#32;in&#32;this&#32;case&#38;nbsp&#59;and&#32;make&#32;Range&#32;to&#32;an&#32;indexer,&#32;as&#32;far&#32;known&#32;the&#32;interop&#32;assemblies&#32;has&#32;a&#32;special&#32;COM&#32;attribute&#47;annotation&#32;for&#32;default&#32;members.&#32;tomorrow&#32;i&#32;take&#32;a&#32;look&#32;with&#32;the&#32;.NET&#32;Reflector&#32;and&#32;when&#32;its&#32;true,&#32;i&#32;put&#32;these&#32;attribute&#32;also&#32;to&#32;the&#32;default&#32;members&#32;in&#32;NetOffice.&#32;&#42;Sebastian">
        
<p>second update: <br>
<br>
&gt;&gt; In Excel, the Worksheet.Range property is an indexed property<br>
<br>
Worksheet has no default property.&nbsp; you can use the ITypeLib Viewer also know as OLE/COM Object Viewer and see Worksheet has no _Default member.<br>
i change that at hand in my xml source file in this case&nbsp;and make Range to an indexer, as far known the interop assemblies has a special COM attribute/annotation for default members. tomorrow i take a look with the .NET Reflector and when its true, i put
 these attribute also to the default members in NetOffice.</p>
<p>*Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_722215" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="722278">
    <td id="PostDetailsCell_722278" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post722278"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/govert">govert</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="1/9/2012 7:08:12 AM" LocalTimeTicks="1326121692">Jan 9, 2012 at 7:08 AM</span></div>
            
            <div style="white-space: normal" class="SubText" id="UpdatedDiv">Edited <span class="smartDate" title="1/9/2012 7:46:57 AM" LocalTimeTicks="1326124017">Jan 9, 2012 at 7:46 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_722278" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="I&#32;don&#39;t&#32;mean&#32;that&#32;Worksheet.Range&#32;should&#32;become&#32;an&#32;indexer&#32;or&#32;default&#32;property&#32;on&#32;Worksheet.&#32;It&#32;isn&#39;t&#32;that&#32;way&#32;in&#32;VBA.&#32;Currently&#32;NetOffice&#32;Worksheet.Range&#32;is&#32;not&#32;exposed&#32;as&#32;a&#32;.NET&#32;property,&#32;only&#32;via&#32;&#34;get_Range&#34;.&#32;I&#32;want&#32;this&#32;code&#32;to&#32;work&#32;in&#32;VB.NET&#58;&#32;&#32;Sub&#32;Test&#40;&#41;&#32;Dim&#32;ws&#32;As&#32;Worksheet&#32;Dim&#32;r&#32;As&#32;Range&#32;Set&#32;ws&#32;&#61;&#32;Application.ActiveSheet&#32;Set&#32;r&#32;&#61;&#32;ws.Range&#40;&#34;A1&#34;&#41;&#32;r.Value&#32;&#61;&#32;&#34;XXX&#34;&#32;End&#32;Sub&#32;&#32;&#32;And&#32;then&#32;with&#32;the&#32;&#34;Globals&#34;&#32;we&#32;can&#32;possibly&#32;figure&#32;out&#32;how&#32;to&#32;make&#32;this&#32;work&#58;&#32;&#32;Imports&#32;NetOffice.ExcelApi.Global&#32;Sub&#32;Test&#40;&#41;&#32;Dim&#32;ws&#32;As&#32;Worksheet&#32;Dim&#32;r&#32;As&#32;Range&#32;Set&#32;ws&#32;&#61;&#32;ActiveSheet&#32;Set&#32;r&#32;&#61;&#32;ws.Range&#40;&#34;A1&#34;&#41;&#32;r.Value&#32;&#61;&#32;&#34;XXX&#34;&#32;End&#32;Sub&#32;&#32;&#32;-Govert">
        
<p>I don't mean that Worksheet.Range should become an indexer or default property on Worksheet. It isn't that way in VBA.</p>
<p>Currently NetOffice Worksheet.Range is not exposed as a .NET property, only via &quot;get_Range&quot;. I want this code to work in VB.NET:</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">Sub</span> Test()
    <span style="color:blue">Dim</span> ws <span style="color:blue">As</span> Worksheet
    <span style="color:blue">Dim</span> r <span style="color:blue">As</span> Range
    <span style="color:blue">Set</span> ws = Application.ActiveSheet
    <span style="color:blue">Set</span> r = ws.Range(<span style="color:#a31515">&quot;A1&quot;</span>)
    r.Value = <span style="color:#a31515">&quot;XXX&quot;</span>
<span style="color:blue">End</span> <span style="color:blue">Sub</span>
</pre>
</div>
<p>And then with the &quot;Globals&quot; we can possibly figure out how to make this work:</p>
<div style="color:black; background-color:white">
<pre><span style="color:blue">Imports</span> NetOffice.ExcelApi.Global

<span style="color:blue">Sub</span> Test()
    <span style="color:blue">Dim</span> ws <span style="color:blue">As</span> Worksheet
    <span style="color:blue">Dim</span> r <span style="color:blue">As</span> Range
    <span style="color:blue">Set</span> ws = ActiveSheet
    <span style="color:blue">Set</span> r = ws.Range(<span style="color:#a31515">&quot;A1&quot;</span>)
    r.Value = <span style="color:#a31515">&quot;XXX&quot;</span>
<span style="color:blue">End</span> <span style="color:blue">Sub</span>
</pre>
</div>
<p>-Govert</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_722278" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="722835">
    <td id="PostDetailsCell_722835" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post722835"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/SebastianDotNet">SebastianDotNet</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="1/10/2012 12:46:37 AM" LocalTimeTicks="1326185197">Jan 10, 2012 at 12:46 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_722835" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="hey&#32;govert&#33;i&#32;create&#32;2&#32;issues&#32;for&#32;Recordset.Update&#32;and&#32;avoid&#32;the&#32;&#34;get_&#34;&#32;prefix.a&#32;release&#32;preview&#32;&#40;release&#32;1.4&#41;&#32;with&#32;fixed&#32;issues&#32;is&#32;available&#32;in&#32;the&#32;download&#32;section.please&#32;take&#32;a&#32;look&#32;an&#32;give&#32;me&#32;a&#32;response,&#32;its&#32;okay&#32;for&#32;the&#32;vba&#32;community.as&#32;next&#32;step&#32;i&#32;will&#32;see&#32;what&#32;can&#32;i&#32;do&#32;with&#32;the&#32;static&#32;methods.&#32;i&#32;see&#32;the&#32;interop&#32;assemblies&#32;doesnt&#32;support&#32;them&#32;and&#32;the&#32;OLE&#32;Viewer&#32;dont&#32;show&#32;me&#32;a&#32;&#38;lt&#59;global&#38;gt&#59;&#32;namespace.&#32;i&#39;m&#32;very&#32;confused...&#32;&#42;Sebastian">
        
<p>hey govert!<br>
<br>
i create 2 issues for Recordset.Update and avoid the &quot;get_&quot; prefix.<br>
a release preview (release 1.4) with fixed issues is available in the download section.<br>
please take a look an give me a response, its okay for the vba community.<br>
<br>
as next step i will see what can i do with the static methods. i see the interop assemblies doesnt support them and the OLE Viewer dont show me a &lt;global&gt; namespace. i'm very confused...</p>
<p>*Sebastian</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_722835" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="722894">
    <td id="PostDetailsCell_722894" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post722894"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/govert">govert</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="1/10/2012 7:13:08 AM" LocalTimeTicks="1326208388">Jan 10, 2012 at 7:13 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_722894" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Thanks&#32;Sebastian.&#32;I&#32;appended&#32;some&#32;comments&#32;to&#32;those&#32;issues,&#32;and&#32;will&#32;look&#32;out&#32;for&#32;the&#32;next&#32;version.&#32;It&#32;is&#32;certainly&#32;not&#32;urgent.&#32;About&#32;&#38;lt&#59;global&#38;gt&#59;&#58;&#32;I&#32;see&#32;in&#32;the&#32;COM&#32;type&#32;library&#32;&#40;e.g.&#32;for&#32;Excel&#41;&#32;that&#32;the&#32;coclass&#32;Global&#32;is&#32;marked&#32;with&#32;an&#32;&#34;appobject&#34;&#32;attribute.&#32;Maybe&#32;that&#32;is&#32;what&#32;tells&#32;VBA&#32;to&#32;hook&#32;up&#32;a&#32;Global&#32;object&#32;&#40;with&#32;interface&#32;_Global&#41;&#32;to&#32;the&#32;application&#32;object,&#32;and&#32;since&#32;it&#32;is&#32;in&#32;the&#32;same&#32;COM&#32;library,&#32;it&#32;knows&#32;what&#32;kind&#32;of&#32;Application&#32;object&#32;to&#32;hook&#32;up.&#32;But&#32;the&#32;&#34;appobject&#34;&#32;attribute&#32;seems&#32;to&#32;be&#32;the&#32;key.&#32;So&#32;one&#32;possible&#32;approach&#32;is&#32;to&#32;have&#32;the&#32;a&#32;class&#32;with&#32;static&#32;members&#32;for&#32;everything&#32;in&#32;_Global&#32;and&#32;then&#32;have&#32;some&#32;static&#32;method&#32;to&#32;tell&#32;it&#32;the&#32;underlying&#32;&#34;Application&#34;&#32;object&#32;to&#32;work&#32;against.&#32;I&#32;think&#32;all&#32;the&#32;_Global&#32;methods&#32;just&#32;delegate&#32;the&#32;call&#32;to&#32;the&#32;Application&#32;object.&#32;_Global&#32;is&#32;also&#32;hidden&#32;&#40;you&#32;could&#32;mark&#32;with&#32;EditorBrowsable&#40;Never&#41;&#41;.&#32;&#38;nbsp&#59;&#32;&#38;nbsp&#59;&#32;For&#32;the&#32;constants&#32;exposed&#32;to&#32;VBA&#32;through&#32;&#38;lt&#59;global&#38;gt&#59;,&#32;we&#39;d&#32;just&#32;need&#32;a&#32;class&#32;&#40;possible&#32;sealed&#32;and&#32;marked&#32;with&#32;&#91;StandardModule&#93;&#32;with&#32;all&#32;the&#32;enum&#32;values&#32;exported&#32;as&#32;static&#32;constants.&#32;I&#39;m&#32;just&#32;worried&#32;it&#32;bloats&#32;the&#32;assemblies&#32;a&#32;lot&#32;if&#32;you&#32;do&#32;this.&#32;If&#32;that&#39;s&#32;a&#32;problem,&#32;what&#32;about&#32;having&#32;it&#32;in&#32;a&#32;separate&#32;helper&#32;assembly&#63;">
        
<p>Thanks Sebastian. I appended some comments to those issues, and will look out for the next version. It is certainly not urgent.</p>
<p>About &lt;global&gt;: I see in the COM type library (e.g. for Excel) that the coclass Global is marked with an &quot;appobject&quot; attribute. Maybe that is what tells VBA to hook up a Global object (with interface _Global) to the application object, and since it
 is in the same COM library, it knows what kind of Application object to hook up. But the &quot;appobject&quot; attribute seems to be the key.</p>
<p>So one possible approach is to have the a class with static members for everything in _Global and then have some static method to tell it the underlying &quot;Application&quot; object to work against. I think all the _Global methods just delegate the call to the Application
 object. _Global is also hidden (you could mark with EditorBrowsable(Never)). &nbsp;</p>
<p>&nbsp;</p>
<p>For the constants exposed to VBA through &lt;global&gt;, we'd just need a class (possible sealed and marked with [StandardModule] with all the enum values exported as static constants. I'm just worried it bloats the assemblies a lot if you do this. If that's
 a problem, what about having it in a separate helper assembly?</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_722894" class="Options" >
            
        </div>
        
    </td>
</tr>

        <tr><td colspan="3"><div class="PostSeparator"></div></td></tr>
        

<tr id="PostPanel" class="Post" d:forid="722946">
    <td id="PostDetailsCell_722946" style="vertical-align: top; border: solid #BBB 1px; border-bottom: none; border-left: none; border-top: none; width: 114px" class="Post">
        <div class="Details">
            <a name="post722946"></a>
            <div class="UserName" style="white-space: pre-wrap; word-wrap: break-word;"><a class="UserProfileLink" href="http://www.codeplex.com/site/users/view/govert">govert</a></div>
            <div class="UserRole"></div>
            <div style="white-space: normal" class="SubText"><span class="smartDate" title="1/10/2012 9:15:08 AM" LocalTimeTicks="1326215708">Jan 10, 2012 at 9:15 AM</span></div>
            
        </div>
    </td>
    <td id="PostContent_722946" style="width: 100%; vertical-align: top;" 
        class=" discussionPost discussionListContent WordWrapBreakWord Post " 
        data-markdown="Hi&#32;Sebastian,&#32;OK,&#32;I&#39;ve&#32;looked&#32;at&#32;the&#32;preview&#32;version&#32;1.4.&#38;nbsp&#59;&#32;&#38;nbsp&#59;&#32;The&#32;fixes&#32;you&#32;make&#32;for&#32;Recordset.Update&#32;and&#32;Worksheet.Range&#40;&#34;A1&#34;&#41;&#32;work&#32;perfectly,&#32;thank&#32;you.&#32;I&#32;noticed&#32;an&#32;issue&#32;with&#32;the&#32;IEnumerable&#38;lt&#59;T&#38;gt&#59;&#32;change,&#32;which&#32;I&#32;posted&#32;as&#32;a&#32;new&#32;discussion.&#32;-Govert&#32;&#38;nbsp&#59;&#32;&#40;It&#39;s&#32;a&#32;bit&#32;confusing&#32;on&#32;Codeplex&#32;if&#32;you&#32;use&#32;the&#32;same&#32;&#39;Download&#39;&#32;entry&#32;for&#32;different&#32;versions.&#32;Maybe&#32;you&#32;can&#32;make&#32;a&#32;new&#32;&#39;Download&#39;&#32;entry&#32;for&#32;the&#32;next&#32;version&#32;instead&#32;of&#32;re-using&#32;and&#32;renaming&#32;the&#32;current&#32;release&#63;&#41;">
        
<p>Hi Sebastian,</p>
<p>OK, I've looked at the preview version 1.4.&nbsp;</p>
<p>&nbsp;</p>
<p>The fixes you make for Recordset.Update and Worksheet.Range(&quot;A1&quot;) work perfectly, thank you.</p>
<p>I noticed an issue with the IEnumerable&lt;T&gt; change, which I posted as a new discussion.</p>
<p>-Govert</p>
<p>&nbsp;</p>
<p>(It's a bit confusing on Codeplex if you use the same 'Download' entry for different versions. Maybe you can make a new 'Download' entry for the next version instead of re-using and renaming the current release?)</p>

        
    </td>
    <td style="vertical-align: top; width: 134px;" class="Post ">
        
        <div id="Options_722946" class="Options" >
            
        </div>
        
    </td>
</tr>

</table>
    </div>

    


    <div id="PostEditorContainer">
        <a name="editor"></a>
        <div id="Editor" style="display: none;">
            

<div class="MarkdownEditor" data-options-id="87c6f700-6c53-4838-a581-0d5834c77faf">
    <script class="options" defer="defer" id="87c6f700-6c53-4838-a581-0d5834c77faf" type="application/json">{"maxLength":10000,"styleSheetLocation":""}</script>

    <div class="MarkdownEditorControls">
        <a href="#" tabindex="-1" class="control md_help" title="Markdown Syntax Guide"></a>
        <div class="control md_divider"></div>
        <a href="#" tabindex="-1" class="control md_header" title="Insert Header (CTRL + H)"></a>
        <a href="#" tabindex="-1" class="control md_code" title="Insert Code (CTRL + K)"></a>
        <a href="#" tabindex="-1" class="control md_quote" title="Insert Quote (CTRL + Q)"></a>
        <a href="#" tabindex="-1" class="control md_img" title="Insert Img (CTRL + G)"></a>
        <a href="#" tabindex="-1" class="control md_link" title="Insert Link (CTRL + L)"></a>
        <a href="#" tabindex="-1" class="control md_ulist" title="Unordered List (CTRL + U)"></a>
        <a href="#" tabindex="-1" class="control md_olist" title="Ordered List (CTRL + O)"></a>
        <a href="#" tabindex="-1" class="control md_italics" title="Italic Text (CTRL + I)"></a>
        <a href="#" tabindex="-1" class="control md_bold" title="Bold Text (CTRL + B)"></a>
    </div>

    

<div class="tab_control">
    <!-- Generate the basic HTML for the tabs. -->
    
        <div id="Compose"
              class="tab selected"
              data-custom-header-id=""
              data-tab-contents-id="compose_contents_1a8e4fcd-bb45-448e-9368-2d04e4f6485e">
            Compose
        </div>
    
        <div id="Preview"
              class="tab "
              data-custom-header-id=""
              data-tab-contents-id="preview_contents_fb1c63f1-4c08-4c23-97d5-bdf6d130d862">
            Preview
        </div>
    
    <div class="clear"></div>
</div>


    <div id="compose_contents_1a8e4fcd-bb45-448e-9368-2d04e4f6485e" class="compose_tab_content">
        <textarea class=" MarkdownEditorDimensions" cols="20" id="MarkdownEditor" name="content" rows="2">
</textarea>
        <div class="ClearBoth"></div>

        <div class="markdownGuide" style="display: none">
            <table>
                <tr>
                    <td class="markdownGuideColumn">
                        <h1>Text Formatting</h1>
                        <div># Header 1</div>
                        <div>## Header 2</div>
                        <br />
                        <div>*italics* (or _italics_)</div>
                        <div>**bold** (or __bold__)</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Lists</h1>
                        <div>* Unordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp * SubItem</div>
                        <br />
                        <div>1. Ordered List</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp 1. SubItem</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Quotes</h1>
                        <div>> Lorem ipsum</div>
                        <div>dolor sitamet </div>
                        <div>non. Lectus at</div>
                        <div>nam nunc...</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>Code</h1>
                        <div>`Inline Code`</div>
                        <br />
                        <div>``` C#</div>
                        <div>if (foo==bar)</div>
                        <div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbspbar++</div>
                        <div>```</div>
                    </td>
                    <td class="markdownGuideColumn">
                        <h1>References</h1>
                        <div>[Link Text](URL)</div>
                        <br />
                        <div>![Image](URL)</div>
                        <br />
                        <a class="Reference" target="_blank" href="http://codeplex.codeplex.com/wikipage?title=Markdown&referringTitle=Documentation">Markdown Reference</a>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="preview_contents_fb1c63f1-4c08-4c23-97d5-bdf6d130d862" class="preview_tab_content markDownOutput">
        
            <div></div>
        
    </div>
    <div class="clear"></div>
</div>

            
            <div class="row" id="recaptcha_row">
                
<script type="text/javascript">
    $(document).ready(function () {
        $('#recaptcha_reload').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_refresh.png');
        $('#recaptcha_switch_audio').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_audio.png');
        $('#recaptcha_switch_img').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_text.png');
        $('#recaptcha_whatsthis').attr('src', 'http://download-codeplex.sec.s-msft.com/Images/v21066/recaptcha_help.png');
        $('#recaptcha_area tr:first').attr('height', '35');
    });
</script>

                <div class="clear"></div>
                <span id="ReCaptchaError"></span>
            </div>
            <div style="padding-top: 6px;">
                <input type="button" id="SaveButton" value="Save" class="ok" />
                <input type="button" id="CancelButton" value="Cancel" class="cancel" />
                <div class="clear"></div>
            </div>
        </div>
    </div>
</div>

<div id="DeletePostPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Post <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this post? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="ClosePostCancel" value="Cancel" class="cancel" />
            <input type="button" id="ClosePostOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>
        
            <!-- Email notification / Subscription details -->
            
    </div>
</div>
    
<div id="DeleteThreadPanel" class="modal" style="display:none">
    <div class="row">
        <h2>Delete Thread <a href="javascript:return false;" class="close">X</a></h2>
    </div>
    <div class="modal_info">
        <p>Are you sure you want to delete this thread? You will not be able to recover it later.</p>
        <p class="modal_buttons">
            <input type="button" id="CloseThreadCancel" value="Cancel" class="cancel" />
            <input type="button" id="CloseThreadOk" value="Delete" class="ok" />
        </p>
        <div class="ClearBoth"></div>
    </div>
</div>

<script type="text/javascript" language="javascript">
    $(function () {

        $('#recaptcha_response_field')
            .bind('keypress', function (event) { return $submitKeyPressElement(this, event); });


        if ($('#DeleteThreadLink')) {
            $('#DeleteThreadLink').click(function () {
                OpenDialog('#DeleteThreadPanel', true, '41em');
            });
        }
        
        $('#DeleteThreadPanel #CloseThreadOk').click(function () {
            var url = 'http://netoffice.codeplex.com/discussions/285400';
            $.ajax({
                url: url,
                type: 'DELETE',
                success: function (x) {
                    location.href = x.RedirectUrl;
                }
            });
        });
    });

    workItemMention = new codeplex.ui.WorkItemMention();
    workItemMention.addLinks(".discussionPost");
</script>


        
        
                
                <div class="clear"></div>
                
                <div id="footer">
                    <div class="row">
                        <hr />
                        <ul>
                            <li>Â© 2006-2018 Microsoft</li>
                            <li><a href="http://www.codeplex.com/site/help">Get Help</a></li>
                            <li><a href="/site/legal/privacy">Privacy Statement</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/terms">Terms of Use</a></li>
                            <li><a href="http://www.codeplex.com/site/legal/conduct">Code of Conduct</a></li>
                            <li><a href="http://developermedia.com/" target="_blank">Advertise With Us</a></li>
                            <li>Version 11.9.2017.21066</li>
                        </ul>
                    </div>
                </div>
            </div>
        </form>
    </body>

</html>